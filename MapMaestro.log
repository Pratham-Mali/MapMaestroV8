2026-01-07 11:39:07,059 INFO     root: ================================================================================
2026-01-07 11:39:07,059 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV7\MapMaestro.log
2026-01-07 11:39:08,313 INFO     __main__: Connected to database.
2026-01-07 11:39:08,428 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-07 11:39:08,856 INFO     __main__: Connected to database.
2026-01-07 11:39:08,860 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-07 11:39:49,748 INFO     __main__: No custom rules provided, using system rules only
2026-01-07 11:39:49,748 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-07 11:39:49,748 INFO     pii_detector: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-07 11:39:49,762 INFO     pii_detector: - Rule-based detector: Ready
2026-01-07 11:39:49,762 INFO     pii_detector: - AI detector batch size: 12
2026-01-07 11:39:49,764 INFO     pii_detector: ================================================================================
2026-01-07 11:39:49,764 INFO     pii_detector: MULTI-SHEET PII DETECTION PROCESS
2026-01-07 11:39:49,767 INFO     pii_detector: ================================================================================
2026-01-07 11:39:49,767 INFO     pii_detector: File: External Bank Account HDL.xlsx
2026-01-07 11:39:49,767 INFO     pii_detector: Reading Excel file for PII detection: 'External Bank Account HDL.xlsx'
2026-01-07 11:39:49,843 INFO     pii_detector: Excel file has 2 sheet(s)
2026-01-07 11:39:49,857 INFO     pii_detector: Inspecting sheet 'External Bank Account HDL' (8 rows, 2 columns)
2026-01-07 11:39:49,857 INFO     pii_detector: Sheet 'External Bank Account HDL' accepted for PII detection.
2026-01-07 11:39:49,857 INFO     pii_detector: Inspecting sheet 'Assignments HDL' (7 rows, 2 columns)
2026-01-07 11:39:49,862 INFO     pii_detector: Sheet 'Assignments HDL' accepted for PII detection.
2026-01-07 11:39:49,862 INFO     pii_detector: Multiple sheets: using sheet names as identifiers
2026-01-07 11:39:49,864 INFO     pii_detector: Sheet 'External Bank Account HDL' -> identifier: 'External Bank Account HDL'
2026-01-07 11:39:49,864 INFO     pii_detector: Sheet 'Assignments HDL' -> identifier: 'Assignments HDL'
2026-01-07 11:39:49,867 INFO     pii_detector: Found 2 valid sheet(s) for processing
2026-01-07 11:39:49,867 INFO     pii_detector: ================================================================================
2026-01-07 11:39:49,867 INFO     pii_detector: PROCESSING SHEET 1/2: 'External Bank Account HDL'
2026-01-07 11:39:49,867 INFO     pii_detector: Identifier: 'External Bank Account HDL'
2026-01-07 11:39:49,874 INFO     pii_detector: Sheet has 8 rows to process
2026-01-07 11:39:49,874 INFO     pii_detector: PHASE 1: RULE-BASED CLASSIFICATION
2026-01-07 11:39:49,879 INFO     rule_based_pii_detector: Rule-based detection: 7 PII, 0 non-PII, 1 ambiguous
2026-01-07 11:39:49,879 INFO     pii_detector: 
Rule-based classification complete:
2026-01-07 11:39:49,882 INFO     pii_detector:   Definite PII (by rules): 7 fields
2026-01-07 11:39:49,885 INFO     pii_detector:   Definite Non-PII (by rules): 0 fields
2026-01-07 11:39:49,887 INFO     pii_detector:   Ambiguous (needs Gemini API): 1 fields
2026-01-07 11:39:49,889 INFO     pii_detector:   API Cost Savings: 87.5% of fields handled without API
2026-01-07 11:39:49,889 INFO     pii_detector: 
  Sample rule-based PII detections (first 5):
2026-01-07 11:39:49,889 INFO     pii_detector:     1. Personal Payment Method.BankAccountNumber -> Financial
2026-01-07 11:39:49,896 INFO     pii_detector:     2. Personal Payment Method.BankAccountType -> Financial
2026-01-07 11:39:49,896 INFO     pii_detector:     3. PayBankAccountPrenote.BankAccountNumber -> Financial
2026-01-07 11:39:49,898 INFO     pii_detector:     4. External Bank Account Owner.BankName -> Name
2026-01-07 11:39:49,898 INFO     pii_detector:     5. External Bank Account Owner.BankBranchName -> Name
2026-01-07 11:39:49,898 INFO     pii_detector: PHASE 2: GEMINI API DETECTION
2026-01-07 11:39:49,902 INFO     pii_detector: Sending 1 ambiguous fields to Gemini API for analysis

2026-01-07 11:39:49,902 INFO     pii_detector:   Processing in 1 batch(es) of up to 12 fields each

2026-01-07 11:39:49,902 INFO     pii_detector:   Processing Batch 1/1 (1 fields)...
2026-01-07 11:39:49,911 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-07 11:39:54,652 INFO     utils.gemini_client: Successfully processed batch with 1 rows
2026-01-07 11:39:54,652 INFO     pii_detector:   Batch 1 complete: 0 PII fields detected by Gemini API
2026-01-07 11:39:54,652 INFO     pii_detector: 
  Gemini API detection complete:
2026-01-07 11:39:54,654 INFO     pii_detector:   Total PII fields detected by Gemini API: 0
2026-01-07 11:39:54,654 INFO     pii_detector: PHASE 3: MERGING RESULTS
2026-01-07 11:39:54,657 INFO     pii_detector: Sheet 'External Bank Account HDL' processing complete
2026-01-07 11:39:54,658 INFO     pii_detector:   - Total fields: 8
2026-01-07 11:39:54,659 INFO     pii_detector:   - PII detected: 7
2026-01-07 11:39:54,661 INFO     pii_detector: ================================================================================
2026-01-07 11:39:54,662 INFO     pii_detector: PROCESSING SHEET 2/2: 'Assignments HDL'
2026-01-07 11:39:54,664 INFO     pii_detector: Identifier: 'Assignments HDL'
2026-01-07 11:39:54,665 INFO     pii_detector: Sheet has 7 rows to process
2026-01-07 11:39:54,666 INFO     pii_detector: PHASE 1: RULE-BASED CLASSIFICATION
2026-01-07 11:39:54,668 INFO     rule_based_pii_detector: Rule-based detection: 5 PII, 0 non-PII, 2 ambiguous
2026-01-07 11:39:54,668 INFO     pii_detector: 
Rule-based classification complete:
2026-01-07 11:39:54,668 INFO     pii_detector:   Definite PII (by rules): 5 fields
2026-01-07 11:39:54,668 INFO     pii_detector:   Definite Non-PII (by rules): 0 fields
2026-01-07 11:39:54,668 INFO     pii_detector:   Ambiguous (needs Gemini API): 2 fields
2026-01-07 11:39:54,679 INFO     pii_detector:   API Cost Savings: 71.4% of fields handled without API
2026-01-07 11:39:54,681 INFO     pii_detector: 
  Sample rule-based PII detections (first 5):
2026-01-07 11:39:54,683 INFO     pii_detector:     1. Personal Payment Method.AssignmentNumber -> Financial
2026-01-07 11:39:54,687 INFO     pii_detector:     2. Position.SupervisorAssignmentNumber -> Financial
2026-01-07 11:39:54,688 INFO     pii_detector:     3. AssignmentWorkMeasure.AssignmentNumber -> Financial
2026-01-07 11:39:54,689 INFO     pii_detector:     4. Salary.AssignmentNumber -> Financial
2026-01-07 11:39:54,691 INFO     pii_detector:     5. Personal Payment Method.AssignmentNumber -> Financial
2026-01-07 11:39:54,693 INFO     pii_detector: PHASE 2: GEMINI API DETECTION
2026-01-07 11:39:54,694 INFO     pii_detector: Sending 2 ambiguous fields to Gemini API for analysis

2026-01-07 11:39:54,696 INFO     pii_detector:   Processing in 1 batch(es) of up to 12 fields each

2026-01-07 11:39:54,698 INFO     pii_detector:   Processing Batch 1/1 (2 fields)...
2026-01-07 11:39:54,714 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-07 11:39:59,373 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-07 11:39:59,389 INFO     pii_detector:   Batch 1 complete: 0 PII fields detected by Gemini API
2026-01-07 11:39:59,389 INFO     pii_detector: 
  Gemini API detection complete:
2026-01-07 11:39:59,391 INFO     pii_detector:   Total PII fields detected by Gemini API: 0
2026-01-07 11:39:59,391 INFO     pii_detector: PHASE 3: MERGING RESULTS
2026-01-07 11:39:59,394 INFO     pii_detector: Sheet 'Assignments HDL' processing complete
2026-01-07 11:39:59,394 INFO     pii_detector:   - Total fields: 7
2026-01-07 11:39:59,394 INFO     pii_detector:   - PII detected: 5
2026-01-07 11:39:59,394 INFO     pii_detector: ================================================================================
2026-01-07 11:39:59,399 INFO     pii_detector: CREATING COMBINED OUTPUT FILE
2026-01-07 11:39:59,402 INFO     pii_detector: ================================================================================
2026-01-07 11:39:59,452 INFO     pii_detector: Multi-sheet output file created: External Bank Account HDL_PII_detected_20260107_113959.xlsx
2026-01-07 11:39:59,453 INFO     pii_detector: Output file created: External Bank Account HDL_PII_detected_20260107_113959.xlsx
2026-01-07 11:39:59,457 INFO     pii_detector: FINAL MULTI-SHEET PII DETECTION SUMMARY
2026-01-07 11:39:59,457 INFO     pii_detector: Total sheets processed: 2
2026-01-07 11:39:59,458 INFO     pii_detector: Total fields analyzed: 15
2026-01-07 11:39:59,459 INFO     pii_detector: 
2026-01-07 11:39:59,461 INFO     pii_detector: Rule-Based Classification: 12 PII fields (80.0%)
2026-01-07 11:39:59,462 INFO     pii_detector: Gemini API Detection: 0 PII fields (0.0%)
2026-01-07 11:39:59,462 INFO     pii_detector: 
2026-01-07 11:39:59,464 INFO     pii_detector: Total PII fields found: 12 (80.0%)
2026-01-07 11:39:59,465 INFO     pii_detector: Non-PII fields: 3 (20.0%)
2026-01-07 11:39:59,465 INFO     pii_detector: 
2026-01-07 11:39:59,468 INFO     pii_detector: API Efficiency: 3 API calls instead of 15
2026-01-07 11:39:59,469 INFO     pii_detector: Cost reduction: 80.0%
2026-01-07 11:39:59,471 INFO     pii_detector: 
2026-01-07 11:39:59,472 INFO     pii_detector: Output file: External Bank Account HDL_PII_detected_20260107_113959.xlsx
2026-01-07 11:39:59,473 INFO     pii_detector: ================================================================================
2026-01-07 11:40:33,170 INFO     __main__: PII detection cleared (including custom rules)
2026-01-07 16:08:00,318 INFO     root: ================================================================================
2026-01-07 16:08:00,318 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV7\MapMaestro.log
2026-01-07 16:08:01,532 INFO     __main__: Connected to database.
2026-01-07 16:08:01,599 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-07 16:08:02,215 INFO     __main__: Connected to database.
2026-01-07 16:08:02,226 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-07 16:08:23,508 INFO     __main__: No custom rules provided, using system rules only
2026-01-07 16:08:23,508 INFO     rule_based_pii_detector_db: Loading PII detection rules from database.
2026-01-07 16:08:24,076 INFO     pii_rules_db_helper: Created new database connection for PII rules loader
2026-01-07 16:08:24,076 INFO     pii_rules_db_helper: Loading PII detection rules from database.
2026-01-07 16:08:24,089 INFO     pii_rules_db_helper: Loaded 17 PII categories
2026-01-07 16:08:24,089 INFO     pii_rules_db_helper: Loaded 43 non-PII patterns
2026-01-07 16:08:24,090 INFO     pii_rules_db_helper: Loaded 11 sensitive keywords
2026-01-07 16:08:24,090 INFO     pii_rules_db_helper: Loaded 7 value patterns
2026-01-07 16:08:24,090 INFO     pii_rules_db_helper: Loaded 4 datatype hint categories
2026-01-07 16:08:24,091 INFO     pii_rules_db_helper: Closed database connection
2026-01-07 16:08:24,091 INFO     rule_based_pii_detector_db: Loaded PII rules from database:
2026-01-07 16:08:24,091 INFO     rule_based_pii_detector_db:    - 17 PII categories
2026-01-07 16:08:24,092 INFO     rule_based_pii_detector_db:    - 43 non-PII patterns
2026-01-07 16:08:24,093 INFO     rule_based_pii_detector_db:    - 11 sensitive keywords
2026-01-07 16:08:24,095 INFO     rule_based_pii_detector_db:    - 7 value patterns
2026-01-07 16:08:24,096 INFO     rule_based_pii_detector_db:    - 4 datatype hint categories
2026-01-07 16:08:24,097 INFO     rule_based_pii_detector_db:    - 209 total field patterns across all categories
2026-01-07 16:08:24,097 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-07 16:08:24,098 INFO     pii_detector: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-07 16:08:24,099 INFO     pii_detector: - Rule-based detector: Ready
2026-01-07 16:08:24,100 INFO     pii_detector: - AI detector batch size: 12
2026-01-07 16:08:24,101 INFO     pii_detector: ================================================================================
2026-01-07 16:08:24,102 INFO     pii_detector: MULTI-SHEET PII DETECTION PROCESS
2026-01-07 16:08:24,102 INFO     pii_detector: ================================================================================
2026-01-07 16:08:24,103 INFO     pii_detector: File: External Bank Account HDL.xlsx
2026-01-07 16:08:24,103 INFO     pii_detector: Reading Excel file for PII detection: 'External Bank Account HDL.xlsx'
2026-01-07 16:08:24,198 INFO     pii_detector: Excel file has 2 sheet(s)
2026-01-07 16:08:24,198 INFO     pii_detector: Inspecting sheet 'External Bank Account HDL' (8 rows, 2 columns)
2026-01-07 16:08:24,198 INFO     pii_detector: Sheet 'External Bank Account HDL' accepted for PII detection.
2026-01-07 16:08:24,198 INFO     pii_detector: Inspecting sheet 'Assignments HDL' (7 rows, 2 columns)
2026-01-07 16:08:24,205 INFO     pii_detector: Sheet 'Assignments HDL' accepted for PII detection.
2026-01-07 16:08:24,205 INFO     pii_detector: Multiple sheets: using sheet names as identifiers
2026-01-07 16:08:24,205 INFO     pii_detector: Sheet 'External Bank Account HDL' -> identifier: 'External Bank Account HDL'
2026-01-07 16:08:24,205 INFO     pii_detector: Sheet 'Assignments HDL' -> identifier: 'Assignments HDL'
2026-01-07 16:08:24,205 INFO     pii_detector: Found 2 valid sheet(s) for processing
2026-01-07 16:08:24,205 INFO     pii_detector: ================================================================================
2026-01-07 16:08:24,205 INFO     pii_detector: PROCESSING SHEET 1/2: 'External Bank Account HDL'
2026-01-07 16:08:24,205 INFO     pii_detector: Identifier: 'External Bank Account HDL'
2026-01-07 16:08:24,221 INFO     pii_detector: Sheet has 8 rows to process
2026-01-07 16:08:24,221 INFO     pii_detector: PHASE 1: RULE-BASED CLASSIFICATION
2026-01-07 16:08:24,221 INFO     rule_based_pii_detector_db: Rule-based detection: 7 PII, 0 non-PII, 1 ambiguous
2026-01-07 16:08:24,221 INFO     pii_detector: 
Rule-based classification complete:
2026-01-07 16:08:24,221 INFO     pii_detector:   Definite PII (by rules): 7 fields
2026-01-07 16:08:24,221 INFO     pii_detector:   Definite Non-PII (by rules): 0 fields
2026-01-07 16:08:24,221 INFO     pii_detector:   Ambiguous (needs Gemini API): 1 fields
2026-01-07 16:08:24,221 INFO     pii_detector:   API Cost Savings: 87.5% of fields handled without API
2026-01-07 16:08:24,237 INFO     pii_detector: 
  Sample rule-based PII detections (first 5):
2026-01-07 16:08:24,239 INFO     pii_detector:     1. Personal Payment Method.BankAccountNumber -> Financial
2026-01-07 16:08:24,239 INFO     pii_detector:     2. Personal Payment Method.BankAccountType -> Financial
2026-01-07 16:08:24,239 INFO     pii_detector:     3. PayBankAccountPrenote.BankAccountNumber -> Financial
2026-01-07 16:08:24,245 INFO     pii_detector:     4. External Bank Account Owner.BankName -> Name
2026-01-07 16:08:24,245 INFO     pii_detector:     5. External Bank Account Owner.BankBranchName -> Name
2026-01-07 16:08:24,247 INFO     pii_detector: PHASE 2: GEMINI API DETECTION
2026-01-07 16:08:24,247 INFO     pii_detector: Sending 1 ambiguous fields to Gemini API for analysis

2026-01-07 16:08:24,247 INFO     pii_detector:   Processing in 1 batch(es) of up to 12 fields each

2026-01-07 16:08:24,247 INFO     pii_detector:   Processing Batch 1/1 (1 fields)...
2026-01-07 16:08:24,282 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-07 16:08:28,188 INFO     utils.gemini_client: Successfully processed batch with 1 rows
2026-01-07 16:08:28,188 INFO     pii_detector:   Batch 1 complete: 0 PII fields detected by Gemini API
2026-01-07 16:08:28,188 INFO     pii_detector: 
  Gemini API detection complete:
2026-01-07 16:08:28,188 INFO     pii_detector:   Total PII fields detected by Gemini API: 0
2026-01-07 16:08:28,188 INFO     pii_detector: PHASE 3: MERGING RESULTS
2026-01-07 16:08:28,204 INFO     pii_detector: Sheet 'External Bank Account HDL' processing complete
2026-01-07 16:08:28,204 INFO     pii_detector:   - Total fields: 8
2026-01-07 16:08:28,204 INFO     pii_detector:   - PII detected: 7
2026-01-07 16:08:28,204 INFO     pii_detector: ================================================================================
2026-01-07 16:08:28,204 INFO     pii_detector: PROCESSING SHEET 2/2: 'Assignments HDL'
2026-01-07 16:08:28,204 INFO     pii_detector: Identifier: 'Assignments HDL'
2026-01-07 16:08:28,220 INFO     pii_detector: Sheet has 7 rows to process
2026-01-07 16:08:28,220 INFO     pii_detector: PHASE 1: RULE-BASED CLASSIFICATION
2026-01-07 16:08:28,220 INFO     rule_based_pii_detector_db: Rule-based detection: 5 PII, 0 non-PII, 2 ambiguous
2026-01-07 16:08:28,220 INFO     pii_detector: 
Rule-based classification complete:
2026-01-07 16:08:28,220 INFO     pii_detector:   Definite PII (by rules): 5 fields
2026-01-07 16:08:28,220 INFO     pii_detector:   Definite Non-PII (by rules): 0 fields
2026-01-07 16:08:28,220 INFO     pii_detector:   Ambiguous (needs Gemini API): 2 fields
2026-01-07 16:08:28,220 INFO     pii_detector:   API Cost Savings: 71.4% of fields handled without API
2026-01-07 16:08:28,236 INFO     pii_detector: 
  Sample rule-based PII detections (first 5):
2026-01-07 16:08:28,236 INFO     pii_detector:     1. Personal Payment Method.AssignmentNumber -> Financial
2026-01-07 16:08:28,236 INFO     pii_detector:     2. Position.SupervisorAssignmentNumber -> Financial
2026-01-07 16:08:28,236 INFO     pii_detector:     3. AssignmentWorkMeasure.AssignmentNumber -> Financial
2026-01-07 16:08:28,236 INFO     pii_detector:     4. Salary.AssignmentNumber -> Financial
2026-01-07 16:08:28,236 INFO     pii_detector:     5. Personal Payment Method.AssignmentNumber -> Financial
2026-01-07 16:08:28,248 INFO     pii_detector: PHASE 2: GEMINI API DETECTION
2026-01-07 16:08:28,248 INFO     pii_detector: Sending 2 ambiguous fields to Gemini API for analysis

2026-01-07 16:08:28,250 INFO     pii_detector:   Processing in 1 batch(es) of up to 12 fields each

2026-01-07 16:08:28,250 INFO     pii_detector:   Processing Batch 1/1 (2 fields)...
2026-01-07 16:08:28,250 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-07 16:08:33,097 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-07 16:08:33,097 INFO     pii_detector:   Batch 1 complete: 0 PII fields detected by Gemini API
2026-01-07 16:08:33,097 INFO     pii_detector: 
  Gemini API detection complete:
2026-01-07 16:08:33,097 INFO     pii_detector:   Total PII fields detected by Gemini API: 0
2026-01-07 16:08:33,097 INFO     pii_detector: PHASE 3: MERGING RESULTS
2026-01-07 16:08:33,097 INFO     pii_detector: Sheet 'Assignments HDL' processing complete
2026-01-07 16:08:33,113 INFO     pii_detector:   - Total fields: 7
2026-01-07 16:08:33,113 INFO     pii_detector:   - PII detected: 5
2026-01-07 16:08:33,113 INFO     pii_detector: ================================================================================
2026-01-07 16:08:33,113 INFO     pii_detector: CREATING COMBINED OUTPUT FILE
2026-01-07 16:08:33,113 INFO     pii_detector: ================================================================================
2026-01-07 16:08:33,198 INFO     pii_detector: Multi-sheet output file created: External Bank Account HDL_PII_detected_20260107_160833.xlsx
2026-01-07 16:08:33,198 INFO     pii_detector: Output file created: External Bank Account HDL_PII_detected_20260107_160833.xlsx
2026-01-07 16:08:33,227 INFO     pii_detector: FINAL MULTI-SHEET PII DETECTION SUMMARY
2026-01-07 16:08:33,227 INFO     pii_detector: Total sheets processed: 2
2026-01-07 16:08:33,227 INFO     pii_detector: Total fields analyzed: 15
2026-01-07 16:08:33,227 INFO     pii_detector: 
2026-01-07 16:08:33,227 INFO     pii_detector: Rule-Based Classification: 12 PII fields (80.0%)
2026-01-07 16:08:33,227 INFO     pii_detector: Gemini API Detection: 0 PII fields (0.0%)
2026-01-07 16:08:33,241 INFO     pii_detector: 
2026-01-07 16:08:33,241 INFO     pii_detector: Total PII fields found: 12 (80.0%)
2026-01-07 16:08:33,241 INFO     pii_detector: Non-PII fields: 3 (20.0%)
2026-01-07 16:08:33,241 INFO     pii_detector: 
2026-01-07 16:08:33,241 INFO     pii_detector: API Efficiency: 3 API calls instead of 15
2026-01-07 16:08:33,241 INFO     pii_detector: Cost reduction: 80.0%
2026-01-07 16:08:33,257 INFO     pii_detector: 
2026-01-07 16:08:33,257 INFO     pii_detector: Output file: External Bank Account HDL_PII_detected_20260107_160833.xlsx
2026-01-07 16:08:33,257 INFO     pii_detector: ================================================================================
2026-01-07 16:08:54,815 INFO     __main__: PII detection cleared (including custom rules)
2026-01-12 20:52:45,734 INFO     root: ================================================================================
2026-01-12 20:52:45,735 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV7\MapMaestro.log
2026-01-12 20:52:46,993 INFO     __main__: Connected to database.
2026-01-12 20:52:47,037 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-12 20:52:47,920 INFO     __main__: Connected to database.
2026-01-12 20:52:47,927 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-12 21:10:01,908 INFO     __main__: Connected to database.
2026-01-12 21:10:01,931 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-12 21:10:05,681 INFO     __main__: Connected to database.
2026-01-12 21:10:05,685 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-12 21:10:07,439 INFO     __main__: Connected to database.
2026-01-12 21:10:07,444 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-12 21:10:09,921 INFO     __main__: Connected to database.
2026-01-12 21:10:09,925 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-12 21:10:13,285 INFO     __main__: Connected to database.
2026-01-12 21:10:13,294 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-12 21:10:15,058 INFO     __main__: Connected to database.
2026-01-12 21:10:15,064 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 12:21:22,415 INFO     root: ================================================================================
2026-01-13 12:21:22,416 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-13 12:21:22,992 INFO     __main__: Connected to database.
2026-01-13 12:21:23,050 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 12:21:23,679 INFO     __main__: Connected to database.
2026-01-13 12:21:23,684 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-13 12:21:31,580 INFO     __main__: Connected to database.
2026-01-13 12:21:31,602 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 12:21:33,598 INFO     __main__: Connected to database.
2026-01-13 12:21:33,607 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 12:21:36,703 INFO     __main__: Connected to database.
2026-01-13 12:21:36,713 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 12:21:37,674 INFO     __main__: Connected to database.
2026-01-13 12:21:37,678 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 12:21:38,860 INFO     __main__: Connected to database.
2026-01-13 12:21:38,860 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 12:21:41,246 INFO     __main__: Connected to database.
2026-01-13 12:21:41,246 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 12:21:47,173 INFO     __main__: Connected to database.
2026-01-13 12:21:47,175 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 12:21:49,987 INFO     __main__: Connected to database.
2026-01-13 12:21:49,987 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 12:22:03,415 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': [], 'subdomainname': ['Pay Bank Account Prenote'], 'filename': []}
2026-01-13 12:22:03,560 INFO     __main__: Connected to database.
2026-01-13 12:22:03,562 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': [], 'subdomainname': ['Pay Bank Account Prenote'], 'filename': []}
2026-01-13 12:22:03,564 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Pay Bank Account Prenote']
2026-01-13 12:22:03,571 INFO     __main__: Retrieved 1 rows.
2026-01-13 12:22:03,573 INFO     __main__: Found 1 project IDs
2026-01-13 12:22:03,573 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [2]
2026-01-13 12:22:03,725 INFO     __main__: Retrieved 5 rows.
2026-01-13 12:22:03,725 INFO     __main__: Found 5 child rows
2026-01-13 12:22:03,725 INFO     __main__: Normal processing (no transitivity)
2026-01-13 12:22:03,897 INFO     __main__: Exported standard Excel file: output.xlsx
2026-01-13 12:22:42,230 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': [], 'subdomainname': ['Pay Bank Account Prenote'], 'filename': []}
2026-01-13 12:22:42,342 INFO     __main__: Connected to database.
2026-01-13 12:22:42,342 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': [], 'subdomainname': ['Pay Bank Account Prenote'], 'filename': []}
2026-01-13 12:22:42,342 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Pay Bank Account Prenote']
2026-01-13 12:22:42,348 INFO     __main__: Retrieved 1 rows.
2026-01-13 12:22:42,348 INFO     __main__: Found 1 project IDs
2026-01-13 12:22:42,350 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [2]
2026-01-13 12:22:42,375 INFO     __main__: Retrieved 5 rows.
2026-01-13 12:22:42,376 INFO     __main__: Found 5 child rows
2026-01-13 12:22:42,377 INFO     __main__: Normal processing (no transitivity)
2026-01-13 12:22:42,466 INFO     __main__: Exported summarized Excel file: CNV21-2 - Pay Bank Account Prenote.xlsx
2026-01-13 12:23:26,185 INFO     __main__: Loaded sheet 'External Bank Account HDL' with 8 rows
2026-01-13 12:23:26,190 INFO     __main__: Loaded sheet 'Assignments HDL' with 7 rows
2026-01-13 12:23:31,403 INFO     __main__: Connected to database.
2026-01-13 12:23:31,403 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 12:23:39,366 INFO     __main__: Starting enhanced mapping process
2026-01-13 12:23:39,368 INFO     __main__: Input: 'External Bank Account HDL.xlsx', Legacy: 'Lawson', Target: 'Oracle Cloud', Export: 'standard', Project: 'None'
2026-01-13 12:23:39,368 INFO     __main__: Reading input file 'External Bank Account HDL.xlsx'
2026-01-13 12:23:39,392 INFO     __main__: Excel file has 2 sheet(s)
2026-01-13 12:23:39,392 INFO     __main__: Inspecting sheet 'External Bank Account HDL' (8 rows, 2 columns)
2026-01-13 12:23:39,394 INFO     __main__: Sheet 'External Bank Account HDL' accepted with all required columns present.
2026-01-13 12:23:39,398 INFO     __main__: Inspecting sheet 'Assignments HDL' (7 rows, 2 columns)
2026-01-13 12:23:39,398 INFO     __main__: Sheet 'Assignments HDL' accepted with all required columns present.
2026-01-13 12:23:39,402 INFO     __main__: Multiple valid sheets detected. Using sheet names as legacytablename.
2026-01-13 12:23:39,404 INFO     __main__: Sheet 'External Bank Account HDL' : legacytablename='External Bank Account HDL'
2026-01-13 12:23:39,406 INFO     __main__: Sheet 'Assignments HDL' : legacytablename='Assignments HDL'
2026-01-13 12:23:39,539 INFO     __main__: Connected to database.
2026-01-13 12:23:39,539 INFO     __main__: Database connection established
2026-01-13 12:23:39,539 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': [], 'domainname': [], 'subdomainname': [], 'filename': []}
2026-01-13 12:23:39,541 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) Params: ['Lawson', 'Oracle Cloud']
2026-01-13 12:23:39,547 INFO     __main__: Retrieved 25 rows.
2026-01-13 12:23:39,547 INFO     __main__: Found project IDs: [23, 24, 11, 8, 19, 25, 4, 21, 14, 3, 17, 22, 20, 13, 10, 9, 7, 1, 5, 18, 2, 16, 15, 6, 12]
2026-01-13 12:23:39,548 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s) Params: [23, 24, 11, 8, 19, 25, 4, 21, 14, 3, 17, 22, 20, 13, 10, 9, 7, 1, 5, 18, 2, 16, 15, 6, 12]
2026-01-13 12:23:39,741 INFO     __main__: Retrieved 7222 rows.
2026-01-13 12:23:39,741 INFO     __main__: Child table query returned 7222 row(s)
2026-01-13 12:23:39,741 INFO     __main__: Processing sheet 'External Bank Account HDL' with legacytablename='External Bank Account HDL'
2026-01-13 12:23:39,753 INFO     __main__: Extracted 8 unique target table/field pairs from input file
2026-01-13 12:23:39,753 INFO     __main__: Sheet 'External Bank Account HDL' -> 8 target pair(s) extracted
2026-01-13 12:23:39,755 INFO     __main__: Sheet 'External Bank Account HDL' -> 2 row(s) matched after filtering
2026-01-13 12:23:39,755 INFO     __main__: Processing sheet 'Assignments HDL' with legacytablename='Assignments HDL'
2026-01-13 12:23:39,755 INFO     __main__: Extracted 6 unique target table/field pairs from input file
2026-01-13 12:23:39,759 INFO     __main__: Sheet 'Assignments HDL' -> 6 target pair(s) extracted
2026-01-13 12:23:39,761 INFO     __main__: Sheet 'Assignments HDL' -> 1 row(s) matched after filtering
2026-01-13 12:23:39,761 INFO     __main__: Total filtered mapping rows across all sheets: 3
2026-01-13 12:23:39,798 INFO     __main__: Exported standard Excel file: uploaded_mapping_output.xlsx
2026-01-13 12:23:39,798 INFO     __main__: Enhanced mapping process completed successfully
2026-01-13 12:23:39,800 INFO     __main__: Output file: uploaded_mapping_output.xlsx
2026-01-13 12:23:39,802 INFO     __main__: Database connection closed
2026-01-13 12:24:08,712 INFO     __main__: Starting enhanced mapping process
2026-01-13 12:24:08,712 INFO     __main__: Input: 'External Bank Account HDL.xlsx', Legacy: 'Lawson', Target: 'Oracle Cloud', Export: 'summarized', Project: 'None'
2026-01-13 12:24:08,712 INFO     __main__: Reading input file 'External Bank Account HDL.xlsx'
2026-01-13 12:24:08,727 INFO     __main__: Excel file has 2 sheet(s)
2026-01-13 12:24:08,727 INFO     __main__: Inspecting sheet 'External Bank Account HDL' (8 rows, 2 columns)
2026-01-13 12:24:08,727 INFO     __main__: Sheet 'External Bank Account HDL' accepted with all required columns present.
2026-01-13 12:24:08,727 INFO     __main__: Inspecting sheet 'Assignments HDL' (7 rows, 2 columns)
2026-01-13 12:24:08,731 INFO     __main__: Sheet 'Assignments HDL' accepted with all required columns present.
2026-01-13 12:24:08,731 INFO     __main__: Multiple valid sheets detected. Using sheet names as legacytablename.
2026-01-13 12:24:08,731 INFO     __main__: Sheet 'External Bank Account HDL' : legacytablename='External Bank Account HDL'
2026-01-13 12:24:08,731 INFO     __main__: Sheet 'Assignments HDL' : legacytablename='Assignments HDL'
2026-01-13 12:24:08,824 INFO     __main__: Connected to database.
2026-01-13 12:24:08,824 INFO     __main__: Database connection established
2026-01-13 12:24:08,824 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': [], 'domainname': [], 'subdomainname': [], 'filename': []}
2026-01-13 12:24:08,824 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) Params: ['Lawson', 'Oracle Cloud']
2026-01-13 12:24:08,842 INFO     __main__: Retrieved 25 rows.
2026-01-13 12:24:08,842 INFO     __main__: Found project IDs: [23, 24, 11, 8, 19, 25, 4, 21, 14, 3, 17, 22, 20, 13, 10, 9, 7, 1, 5, 18, 2, 16, 15, 6, 12]
2026-01-13 12:24:08,842 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s) Params: [23, 24, 11, 8, 19, 25, 4, 21, 14, 3, 17, 22, 20, 13, 10, 9, 7, 1, 5, 18, 2, 16, 15, 6, 12]
2026-01-13 12:24:09,028 INFO     __main__: Retrieved 7222 rows.
2026-01-13 12:24:09,028 INFO     __main__: Child table query returned 7222 row(s)
2026-01-13 12:24:09,030 INFO     __main__: Processing sheet 'External Bank Account HDL' with legacytablename='External Bank Account HDL'
2026-01-13 12:24:09,030 INFO     __main__: Extracted 8 unique target table/field pairs from input file
2026-01-13 12:24:09,030 INFO     __main__: Sheet 'External Bank Account HDL' -> 8 target pair(s) extracted
2026-01-13 12:24:09,030 INFO     __main__: Sheet 'External Bank Account HDL' -> 2 row(s) matched after filtering
2026-01-13 12:24:09,030 INFO     __main__: Processing sheet 'Assignments HDL' with legacytablename='Assignments HDL'
2026-01-13 12:24:09,035 INFO     __main__: Extracted 6 unique target table/field pairs from input file
2026-01-13 12:24:09,035 INFO     __main__: Sheet 'Assignments HDL' -> 6 target pair(s) extracted
2026-01-13 12:24:09,037 INFO     __main__: Sheet 'Assignments HDL' -> 1 row(s) matched after filtering
2026-01-13 12:24:09,037 INFO     __main__: Total filtered mapping rows across all sheets: 3
2026-01-13 12:24:09,065 INFO     __main__: Exported summarized Excel file: uploaded_mapping_output.xlsx
2026-01-13 12:24:09,066 INFO     __main__: Enhanced mapping process completed successfully
2026-01-13 12:24:09,066 INFO     __main__: Output file: uploaded_mapping_output.xlsx
2026-01-13 12:24:09,066 INFO     __main__: Database connection closed
2026-01-13 12:24:39,484 INFO     __main__: No custom rules provided, using system rules only
2026-01-13 12:24:39,484 ERROR    __main__: PII detection error: PIIDetectionOrchestrator.__init__() missing 1 required positional argument: 'db_connection'
Traceback (most recent call last):
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV8.py", line 4927, in detect_pii
    orchestrator = PIIDetectionOrchestrator(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: PIIDetectionOrchestrator.__init__() missing 1 required positional argument: 'db_connection'
2026-01-13 12:38:33,018 INFO     root: ================================================================================
2026-01-13 12:38:33,018 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-13 12:38:33,561 INFO     __main__: Connected to database.
2026-01-13 12:38:33,617 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 12:38:34,199 INFO     __main__: Connected to database.
2026-01-13 12:38:34,203 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-13 12:38:54,968 INFO     __main__: No custom rules provided, using system rules only
2026-01-13 12:38:55,113 INFO     __main__: Connected to database.
2026-01-13 12:38:55,113 INFO     pii_core: Loading PII detection rules from database
2026-01-13 12:38:55,113 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 12:38:55,113 INFO     pii_database: Loading PII detection rules from database
2026-01-13 12:38:55,186 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 12:38:55,186 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 12:38:55,188 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 12:38:55,190 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 12:38:55,193 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 12:38:55,195 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 12:38:55,197 INFO     pii_core: ================================================================================
2026-01-13 12:38:55,199 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 12:38:55,200 INFO     pii_core: ================================================================================
2026-01-13 12:38:55,203 INFO     pii_core: Reading Excel file: 'External Bank Account HDL.xlsx'
2026-01-13 12:38:55,359 INFO     pii_core: Excel file has 2 sheet(s)
2026-01-13 12:38:55,359 INFO     pii_core: Sheet 'External Bank Account HDL' validated
2026-01-13 12:38:55,359 INFO     pii_core: Sheet 'Assignments HDL' validated
2026-01-13 12:38:55,359 INFO     pii_core: Processing 2 sheet(s)
2026-01-13 12:38:55,359 INFO     pii_core: Processing sheet 1/2: 'External Bank Account HDL'
2026-01-13 12:38:55,383 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 12:38:55,389 INFO     pii_core: Rule-based: 7 PII, 0 non-PII, 1 ambiguous
2026-01-13 12:38:55,390 INFO     pii_core: Phase 2: Gemini API detection (1 fields)
2026-01-13 12:38:55,394 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 12:39:00,430 INFO     utils.gemini_client: Successfully processed batch with 1 rows
2026-01-13 12:39:00,446 INFO     pii_core: Processing sheet 2/2: 'Assignments HDL'
2026-01-13 12:39:00,446 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 12:39:00,446 INFO     pii_core: Rule-based: 5 PII, 0 non-PII, 2 ambiguous
2026-01-13 12:39:00,446 INFO     pii_core: Phase 2: Gemini API detection (2 fields)
2026-01-13 12:39:00,461 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 12:39:04,913 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-13 12:39:04,976 INFO     pii_core: ================================================================================
2026-01-13 12:39:04,976 INFO     pii_core: COMPLETE: 12/15 PII fields found
2026-01-13 12:39:04,976 INFO     pii_core: ================================================================================
2026-01-13 13:00:07,903 INFO     root: ================================================================================
2026-01-13 13:00:07,903 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-13 13:00:08,459 INFO     __main__: Connected to database.
2026-01-13 13:00:08,522 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 13:00:09,167 INFO     __main__: Connected to database.
2026-01-13 13:00:09,173 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-13 13:02:21,037 INFO     __main__: Custom rule extracted:
2026-01-13 13:02:21,037 INFO     __main__:   Patterns: 1
2026-01-13 13:02:21,037 INFO     __main__:   Scope: fieldname
2026-01-13 13:02:21,037 INFO     __main__:   Action: Non-PII
2026-01-13 13:02:21,037 INFO     __main__: Custom rules detected: 1 rule(s)
2026-01-13 13:02:21,163 INFO     __main__: Connected to database.
2026-01-13 13:02:21,163 INFO     pii_core: Loading PII detection rules from database
2026-01-13 13:02:21,163 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 13:02:21,173 INFO     pii_database: Loading PII detection rules from database
2026-01-13 13:02:21,226 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 13:02:21,226 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 13:02:21,227 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-13 13:02:21,229 INFO     pii_core:   Rule: 1 patterns, Scope=fieldname, Action=Non-PII, Type=None
2026-01-13 13:02:21,230 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-13 13:02:21,231 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 13:02:21,232 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 13:02:21,233 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 13:02:21,236 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 13:02:21,236 INFO     pii_core: ================================================================================
2026-01-13 13:02:21,238 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 13:02:21,241 INFO     pii_core: ================================================================================
2026-01-13 13:02:21,241 INFO     pii_core: Reading Excel file: 'External Bank Account HDL.xlsx'
2026-01-13 13:02:21,428 INFO     pii_core: Excel file has 2 sheet(s)
2026-01-13 13:02:21,428 INFO     pii_core: Sheet 'External Bank Account HDL' validated
2026-01-13 13:02:21,430 INFO     pii_core: Sheet 'Assignments HDL' validated
2026-01-13 13:02:21,432 INFO     pii_core: Processing 2 sheet(s)
2026-01-13 13:02:21,434 INFO     pii_core: Processing sheet 1/2: 'External Bank Account HDL'
2026-01-13 13:02:21,452 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 13:02:21,452 INFO     pii_core: Rule-based: 7 PII, 0 non-PII, 1 ambiguous
2026-01-13 13:02:21,452 INFO     pii_core: Phase 2: Gemini API detection (1 fields)
2026-01-13 13:02:21,452 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 13:02:26,579 INFO     utils.gemini_client: Successfully processed batch with 1 rows
2026-01-13 13:02:26,586 INFO     pii_core: Processing sheet 2/2: 'Assignments HDL'
2026-01-13 13:02:26,586 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 13:02:26,594 INFO     pii_core: Rule-based: 5 PII, 0 non-PII, 2 ambiguous
2026-01-13 13:02:26,594 INFO     pii_core: Phase 2: Gemini API detection (2 fields)
2026-01-13 13:02:26,594 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 13:02:31,295 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-13 13:02:31,383 INFO     pii_core: ================================================================================
2026-01-13 13:02:31,389 INFO     pii_core: COMPLETE: 12/15 PII fields found
2026-01-13 13:02:31,392 INFO     pii_core: ================================================================================
2026-01-13 13:03:48,955 INFO     __main__: PII detection cleared (including custom rules)
2026-01-13 13:04:00,974 INFO     __main__: PII detection cleared (including custom rules)
2026-01-13 13:04:14,751 INFO     __main__: Custom rule extracted:
2026-01-13 13:04:14,751 INFO     __main__:   Patterns: 1
2026-01-13 13:04:14,751 INFO     __main__:   Scope: fieldname
2026-01-13 13:04:14,751 INFO     __main__:   Action: Non-PII
2026-01-13 13:04:14,760 INFO     __main__: Custom rules detected: 1 rule(s)
2026-01-13 13:04:14,863 INFO     __main__: Connected to database.
2026-01-13 13:04:14,863 INFO     pii_core: Loading PII detection rules from database
2026-01-13 13:04:14,863 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 13:04:14,863 INFO     pii_database: Loading PII detection rules from database
2026-01-13 13:04:14,884 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 13:04:14,886 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 13:04:14,886 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-13 13:04:14,886 INFO     pii_core:   Rule: 1 patterns, Scope=fieldname, Action=Non-PII, Type=None
2026-01-13 13:04:14,886 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-13 13:04:14,888 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 13:04:14,888 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 13:04:14,888 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 13:04:14,893 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 13:04:14,895 INFO     pii_core: ================================================================================
2026-01-13 13:04:14,895 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 13:04:14,895 INFO     pii_core: ================================================================================
2026-01-13 13:04:14,895 INFO     pii_core: Reading Excel file: 'External Bank Account HDL.xlsx'
2026-01-13 13:04:14,914 INFO     pii_core: Excel file has 2 sheet(s)
2026-01-13 13:04:14,914 INFO     pii_core: Sheet 'External Bank Account HDL' validated
2026-01-13 13:04:14,914 INFO     pii_core: Sheet 'Assignments HDL' validated
2026-01-13 13:04:14,914 INFO     pii_core: Processing 2 sheet(s)
2026-01-13 13:04:14,914 INFO     pii_core: Processing sheet 1/2: 'External Bank Account HDL'
2026-01-13 13:04:14,914 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 13:04:14,926 INFO     pii_core: Rule-based: 7 PII, 0 non-PII, 1 ambiguous
2026-01-13 13:04:14,926 INFO     pii_core: Phase 2: Gemini API detection (1 fields)
2026-01-13 13:04:14,926 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 13:04:20,349 INFO     utils.gemini_client: Successfully processed batch with 1 rows
2026-01-13 13:04:20,349 INFO     pii_core: Processing sheet 2/2: 'Assignments HDL'
2026-01-13 13:04:20,349 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 13:04:20,359 INFO     pii_core: Rule-based: 5 PII, 0 non-PII, 2 ambiguous
2026-01-13 13:04:20,359 INFO     pii_core: Phase 2: Gemini API detection (2 fields)
2026-01-13 13:04:20,361 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 13:04:27,083 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-13 13:04:27,143 INFO     pii_core: ================================================================================
2026-01-13 13:04:27,143 INFO     pii_core: COMPLETE: 12/15 PII fields found
2026-01-13 13:04:27,145 INFO     pii_core: ================================================================================
2026-01-13 13:04:58,935 INFO     __main__: PII detection cleared (including custom rules)
2026-01-13 13:05:13,481 INFO     __main__: Custom rule extracted:
2026-01-13 13:05:13,481 INFO     __main__:   Patterns: 1
2026-01-13 13:05:13,481 INFO     __main__:   Scope: tablename
2026-01-13 13:05:13,481 INFO     __main__:   Action: PII
2026-01-13 13:05:13,481 INFO     __main__:   PII Type: Custom_PII
2026-01-13 13:05:13,481 INFO     __main__: Custom rules detected: 1 rule(s)
2026-01-13 13:05:13,667 INFO     __main__: Connected to database.
2026-01-13 13:05:13,667 INFO     pii_core: Loading PII detection rules from database
2026-01-13 13:05:13,668 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 13:05:13,669 INFO     pii_database: Loading PII detection rules from database
2026-01-13 13:05:13,689 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 13:05:13,689 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 13:05:13,689 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-13 13:05:13,696 INFO     pii_core:   Rule: 1 patterns, Scope=tablename, Action=PII, Type=Custom_PII
2026-01-13 13:05:13,700 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-13 13:05:13,702 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 13:05:13,705 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 13:05:13,705 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 13:05:13,709 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 13:05:13,709 INFO     pii_core: ================================================================================
2026-01-13 13:05:13,714 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 13:05:13,716 INFO     pii_core: ================================================================================
2026-01-13 13:05:13,718 INFO     pii_core: Reading Excel file: 'External Bank Account HDL.xlsx'
2026-01-13 13:05:13,743 INFO     pii_core: Excel file has 2 sheet(s)
2026-01-13 13:05:13,744 INFO     pii_core: Sheet 'External Bank Account HDL' validated
2026-01-13 13:05:13,744 INFO     pii_core: Sheet 'Assignments HDL' validated
2026-01-13 13:05:13,746 INFO     pii_core: Processing 2 sheet(s)
2026-01-13 13:05:13,748 INFO     pii_core: Processing sheet 1/2: 'External Bank Account HDL'
2026-01-13 13:05:13,751 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 13:05:13,755 INFO     pii_core: Rule-based: 7 PII, 0 non-PII, 1 ambiguous
2026-01-13 13:05:13,757 INFO     pii_core: Phase 2: Gemini API detection (1 fields)
2026-01-13 13:05:13,759 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 13:05:20,024 INFO     utils.gemini_client: Successfully processed batch with 1 rows
2026-01-13 13:05:20,024 INFO     pii_core: Processing sheet 2/2: 'Assignments HDL'
2026-01-13 13:05:20,024 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 13:05:20,037 INFO     pii_core: Rule-based: 5 PII, 0 non-PII, 2 ambiguous
2026-01-13 13:05:20,041 INFO     pii_core: Phase 2: Gemini API detection (2 fields)
2026-01-13 13:05:20,041 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 13:05:26,071 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-13 13:05:26,134 INFO     pii_core: ================================================================================
2026-01-13 13:05:26,136 INFO     pii_core: COMPLETE: 12/15 PII fields found
2026-01-13 13:05:26,138 INFO     pii_core: ================================================================================
2026-01-13 13:27:15,727 INFO     root: ================================================================================
2026-01-13 13:27:15,728 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-13 13:27:16,285 INFO     __main__: Connected to database.
2026-01-13 13:27:16,344 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 13:27:16,837 INFO     __main__: Connected to database.
2026-01-13 13:27:16,837 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-13 13:28:20,239 INFO     __main__: Custom rule extracted:
2026-01-13 13:28:20,239 INFO     __main__:   Patterns: 1
2026-01-13 13:28:20,239 INFO     __main__:   Scope: tablename
2026-01-13 13:28:20,239 INFO     __main__:   Action: PII
2026-01-13 13:28:20,252 INFO     __main__:   PII Type: Custom_PII
2026-01-13 13:28:20,252 INFO     __main__: Custom rules detected: 1 rule(s)
2026-01-13 13:28:20,335 INFO     __main__: Connected to database.
2026-01-13 13:28:20,335 INFO     pii_core: Loading PII detection rules from database
2026-01-13 13:28:20,335 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 13:28:20,335 INFO     pii_database: Loading PII detection rules from database
2026-01-13 13:28:20,372 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 13:28:20,373 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 13:28:20,373 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-13 13:28:20,375 INFO     pii_core:   Rule: 1 patterns, Scope=tablename, Action=PII, Type=Custom_PII
2026-01-13 13:28:20,376 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-13 13:28:20,377 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 13:28:20,379 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 13:28:20,380 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 13:28:20,382 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 13:28:20,384 INFO     pii_core: ================================================================================
2026-01-13 13:28:20,384 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 13:28:20,386 INFO     pii_core: ================================================================================
2026-01-13 13:28:20,387 INFO     pii_core: Reading Excel file: 'External Bank Account HDL.xlsx'
2026-01-13 13:28:20,499 INFO     pii_core: Excel file has 2 sheet(s)
2026-01-13 13:28:20,499 INFO     pii_core: Sheet 'External Bank Account HDL' validated
2026-01-13 13:28:20,499 INFO     pii_core: Sheet 'Assignments HDL' validated
2026-01-13 13:28:20,515 INFO     pii_core: Processing 2 sheet(s)
2026-01-13 13:28:20,516 INFO     pii_core: Processing sheet 1/2: 'External Bank Account HDL'
2026-01-13 13:28:20,532 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 13:28:20,532 INFO     pii_core: Rule-based: 7 PII, 0 non-PII, 1 ambiguous
2026-01-13 13:28:20,532 INFO     pii_core: Phase 2: Gemini API detection (1 fields)
2026-01-13 13:28:20,542 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 13:28:26,573 INFO     utils.gemini_client: Successfully processed batch with 1 rows
2026-01-13 13:28:26,576 INFO     pii_core: Processing sheet 2/2: 'Assignments HDL'
2026-01-13 13:28:26,576 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 13:28:26,580 INFO     pii_core: Rule-based: 7 PII, 0 non-PII, 0 ambiguous
2026-01-13 13:28:26,652 INFO     pii_core: ================================================================================
2026-01-13 13:28:26,652 INFO     pii_core: COMPLETE: 14/15 PII fields found
2026-01-13 13:28:26,652 INFO     pii_core: ================================================================================
2026-01-13 13:29:14,200 INFO     __main__: PII detection cleared (including custom rules)
2026-01-13 13:29:28,976 INFO     __main__: Custom rule extracted:
2026-01-13 13:29:28,976 INFO     __main__:   Patterns: 1
2026-01-13 13:29:28,978 INFO     __main__:   Scope: fieldname
2026-01-13 13:29:28,978 INFO     __main__:   Action: Non-PII
2026-01-13 13:29:28,978 INFO     __main__: Custom rules detected: 1 rule(s)
2026-01-13 13:29:29,083 INFO     __main__: Connected to database.
2026-01-13 13:29:29,083 INFO     pii_core: Loading PII detection rules from database
2026-01-13 13:29:29,083 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 13:29:29,083 INFO     pii_database: Loading PII detection rules from database
2026-01-13 13:29:29,110 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 13:29:29,110 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 13:29:29,111 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-13 13:29:29,114 INFO     pii_core:   Rule: 1 patterns, Scope=fieldname, Action=Non-PII, Type=None
2026-01-13 13:29:29,115 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-13 13:29:29,117 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 13:29:29,118 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 13:29:29,120 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 13:29:29,121 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 13:29:29,125 INFO     pii_core: ================================================================================
2026-01-13 13:29:29,125 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 13:29:29,127 INFO     pii_core: ================================================================================
2026-01-13 13:29:29,131 INFO     pii_core: Reading Excel file: 'External Bank Account HDL.xlsx'
2026-01-13 13:29:29,157 INFO     pii_core: Excel file has 2 sheet(s)
2026-01-13 13:29:29,158 INFO     pii_core: Sheet 'External Bank Account HDL' validated
2026-01-13 13:29:29,158 INFO     pii_core: Sheet 'Assignments HDL' validated
2026-01-13 13:29:29,160 INFO     pii_core: Processing 2 sheet(s)
2026-01-13 13:29:29,162 INFO     pii_core: Processing sheet 1/2: 'External Bank Account HDL'
2026-01-13 13:29:29,168 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 13:29:29,173 INFO     pii_core: Rule-based: 7 PII, 0 non-PII, 1 ambiguous
2026-01-13 13:29:29,175 INFO     pii_core: Phase 2: Gemini API detection (1 fields)
2026-01-13 13:29:29,177 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 13:29:35,973 INFO     utils.gemini_client: Successfully processed batch with 1 rows
2026-01-13 13:29:35,973 INFO     pii_core: Processing sheet 2/2: 'Assignments HDL'
2026-01-13 13:29:35,973 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 13:29:35,984 INFO     pii_core: Rule-based: 5 PII, 0 non-PII, 2 ambiguous
2026-01-13 13:29:35,984 INFO     pii_core: Phase 2: Gemini API detection (2 fields)
2026-01-13 13:29:35,986 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 13:29:40,380 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-13 13:29:40,441 INFO     pii_core: ================================================================================
2026-01-13 13:29:40,441 INFO     pii_core: COMPLETE: 12/15 PII fields found
2026-01-13 13:29:40,443 INFO     pii_core: ================================================================================
2026-01-13 13:30:33,265 INFO     __main__: PII detection cleared (including custom rules)
2026-01-13 13:30:49,639 INFO     __main__: Custom rule extracted:
2026-01-13 13:30:49,640 INFO     __main__:   Patterns: 1
2026-01-13 13:30:49,640 INFO     __main__:   Scope: fieldname
2026-01-13 13:30:49,641 INFO     __main__:   Action: PII
2026-01-13 13:30:49,641 INFO     __main__:   PII Type: Custom_PII
2026-01-13 13:30:49,642 INFO     __main__: Custom rules detected: 1 rule(s)
2026-01-13 13:30:49,715 INFO     __main__: Connected to database.
2026-01-13 13:30:49,715 INFO     pii_core: Loading PII detection rules from database
2026-01-13 13:30:49,715 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 13:30:49,715 INFO     pii_database: Loading PII detection rules from database
2026-01-13 13:30:49,726 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 13:30:49,726 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 13:30:49,730 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-13 13:30:49,731 INFO     pii_core:   Rule: 1 patterns, Scope=fieldname, Action=PII, Type=Custom_PII
2026-01-13 13:30:49,731 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-13 13:30:49,732 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 13:30:49,733 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 13:30:49,734 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 13:30:49,735 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 13:30:49,736 INFO     pii_core: ================================================================================
2026-01-13 13:30:49,737 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 13:30:49,739 INFO     pii_core: ================================================================================
2026-01-13 13:30:49,739 INFO     pii_core: Reading Excel file: 'External Bank Account HDL.xlsx'
2026-01-13 13:30:49,750 INFO     pii_core: Excel file has 2 sheet(s)
2026-01-13 13:30:49,750 INFO     pii_core: Sheet 'External Bank Account HDL' validated
2026-01-13 13:30:49,765 INFO     pii_core: Sheet 'Assignments HDL' validated
2026-01-13 13:30:49,767 INFO     pii_core: Processing 2 sheet(s)
2026-01-13 13:30:49,768 INFO     pii_core: Processing sheet 1/2: 'External Bank Account HDL'
2026-01-13 13:30:49,773 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 13:30:49,777 INFO     pii_core: Rule-based: 7 PII, 0 non-PII, 1 ambiguous
2026-01-13 13:30:49,777 INFO     pii_core: Phase 2: Gemini API detection (1 fields)
2026-01-13 13:30:49,781 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 13:31:02,471 INFO     utils.gemini_client: Successfully processed batch with 1 rows
2026-01-13 13:31:02,486 INFO     pii_core: Processing sheet 2/2: 'Assignments HDL'
2026-01-13 13:31:02,486 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 13:31:02,486 INFO     pii_core: Rule-based: 5 PII, 0 non-PII, 2 ambiguous
2026-01-13 13:31:02,486 INFO     pii_core: Phase 2: Gemini API detection (2 fields)
2026-01-13 13:31:02,486 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 13:31:12,148 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-13 13:31:12,200 INFO     pii_core: ================================================================================
2026-01-13 13:31:12,200 INFO     pii_core: COMPLETE: 12/15 PII fields found
2026-01-13 13:31:12,200 INFO     pii_core: ================================================================================
2026-01-13 13:31:47,115 INFO     __main__: PII detection cleared (including custom rules)
2026-01-13 13:40:01,575 INFO     root: ================================================================================
2026-01-13 13:40:01,575 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-13 13:40:02,096 INFO     __main__: Connected to database.
2026-01-13 13:40:02,109 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 13:40:02,373 INFO     __main__: Connected to database.
2026-01-13 13:40:02,373 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-13 13:40:35,400 INFO     __main__: Custom rule extracted:
2026-01-13 13:40:35,400 INFO     __main__:   Patterns: 1
2026-01-13 13:40:35,400 INFO     __main__:   Scope: fieldname
2026-01-13 13:40:35,410 INFO     __main__:   Action: Non-PII
2026-01-13 13:40:35,410 INFO     __main__: Custom rules detected: 1 rule(s)
2026-01-13 13:40:35,541 INFO     __main__: Connected to database.
2026-01-13 13:40:35,541 INFO     pii_core: Loading PII detection rules from database
2026-01-13 13:40:35,541 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 13:40:35,541 INFO     pii_database: Loading PII detection rules from database
2026-01-13 13:40:35,569 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 13:40:35,569 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 13:40:35,569 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-13 13:40:35,574 INFO     pii_core:   Rule: 1 patterns, Scope=fieldname, Action=Non-PII, Type=None
2026-01-13 13:40:35,575 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-13 13:40:35,578 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 13:40:35,580 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 13:40:35,581 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 13:40:35,583 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 13:40:35,585 INFO     pii_core: ================================================================================
2026-01-13 13:40:35,585 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 13:40:35,587 INFO     pii_core: ================================================================================
2026-01-13 13:40:35,589 INFO     pii_core: Reading Excel file: 'External Bank Account HDL.xlsx'
2026-01-13 13:40:35,707 INFO     pii_core: Excel file has 2 sheet(s)
2026-01-13 13:40:35,707 INFO     pii_core: Sheet 'External Bank Account HDL' validated
2026-01-13 13:40:35,707 INFO     pii_core: Sheet 'Assignments HDL' validated
2026-01-13 13:40:35,707 INFO     pii_core: Processing 2 sheet(s)
2026-01-13 13:40:35,707 INFO     pii_core: Processing sheet 1/2: 'External Bank Account HDL'
2026-01-13 13:40:35,707 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 13:40:35,707 INFO     pii_core: CUSTOM RULES CHECK - Field: 'BankAccountNumber'
2026-01-13 13:40:35,707 INFO     pii_core:   Normalized name: 'bank account number'
2026-01-13 13:40:35,707 INFO     pii_core:   Description: ''
2026-01-13 13:40:35,707 INFO     pii_core:   Table name: 'personal payment method'
2026-01-13 13:40:35,707 INFO     pii_core:   Total custom rules: 1
2026-01-13 13:40:35,707 INFO     pii_core:   Rule #1: scope='fieldname', action='Non-PII', patterns=1
2026-01-13 13:40:35,720 INFO     pii_core:     Checking pattern: 'AssignmentNumber' (lowercase: 'assignmentnumber')
2026-01-13 13:40:35,720 INFO     pii_core:       Scope=fieldname: 'assignmentnumber' in 'bank account number' = False
2026-01-13 13:40:35,720 INFO     pii_core:   No custom rule matches found for 'BankAccountNumber'
2026-01-13 13:40:35,721 INFO     pii_core: CUSTOM RULES CHECK - Field: 'BankAccountType'
2026-01-13 13:40:35,721 INFO     pii_core:   Normalized name: 'bank account type'
2026-01-13 13:40:35,721 INFO     pii_core:   Description: ''
2026-01-13 13:40:35,723 INFO     pii_core:   Table name: 'personal payment method'
2026-01-13 13:40:35,723 INFO     pii_core:   Total custom rules: 1
2026-01-13 13:40:35,724 INFO     pii_core:   Rule #1: scope='fieldname', action='Non-PII', patterns=1
2026-01-13 13:40:35,724 INFO     pii_core:     Checking pattern: 'AssignmentNumber' (lowercase: 'assignmentnumber')
2026-01-13 13:40:35,724 INFO     pii_core:       Scope=fieldname: 'assignmentnumber' in 'bank account type' = False
2026-01-13 13:40:35,724 INFO     pii_core:   No custom rule matches found for 'BankAccountType'
2026-01-13 13:40:35,728 INFO     pii_core: CUSTOM RULES CHECK - Field: 'BankAccountNumber'
2026-01-13 13:40:35,728 INFO     pii_core:   Normalized name: 'bank account number'
2026-01-13 13:40:35,728 INFO     pii_core:   Description: ''
2026-01-13 13:40:35,728 INFO     pii_core:   Table name: 'paybankaccountprenote'
2026-01-13 13:40:35,731 INFO     pii_core:   Total custom rules: 1
2026-01-13 13:40:35,732 INFO     pii_core:   Rule #1: scope='fieldname', action='Non-PII', patterns=1
2026-01-13 13:40:35,732 INFO     pii_core:     Checking pattern: 'AssignmentNumber' (lowercase: 'assignmentnumber')
2026-01-13 13:40:35,732 INFO     pii_core:       Scope=fieldname: 'assignmentnumber' in 'bank account number' = False
2026-01-13 13:40:35,732 INFO     pii_core:   No custom rule matches found for 'BankAccountNumber'
2026-01-13 13:40:35,734 INFO     pii_core: CUSTOM RULES CHECK - Field: 'BankName'
2026-01-13 13:40:35,734 INFO     pii_core:   Normalized name: 'bank name'
2026-01-13 13:40:35,734 INFO     pii_core:   Description: ''
2026-01-13 13:40:35,737 INFO     pii_core:   Table name: 'external bank account owner'
2026-01-13 13:40:35,739 INFO     pii_core:   Total custom rules: 1
2026-01-13 13:40:35,740 INFO     pii_core:   Rule #1: scope='fieldname', action='Non-PII', patterns=1
2026-01-13 13:40:35,740 INFO     pii_core:     Checking pattern: 'AssignmentNumber' (lowercase: 'assignmentnumber')
2026-01-13 13:40:35,741 INFO     pii_core:       Scope=fieldname: 'assignmentnumber' in 'bank name' = False
2026-01-13 13:40:35,741 INFO     pii_core:   No custom rule matches found for 'BankName'
2026-01-13 13:40:35,743 INFO     pii_core: CUSTOM RULES CHECK - Field: 'BankBranchName'
2026-01-13 13:40:35,744 INFO     pii_core:   Normalized name: 'bank branch name'
2026-01-13 13:40:35,744 INFO     pii_core:   Description: ''
2026-01-13 13:40:35,745 INFO     pii_core:   Table name: 'external bank account owner'
2026-01-13 13:40:35,746 INFO     pii_core:   Total custom rules: 1
2026-01-13 13:40:35,748 INFO     pii_core:   Rule #1: scope='fieldname', action='Non-PII', patterns=1
2026-01-13 13:40:35,748 INFO     pii_core:     Checking pattern: 'AssignmentNumber' (lowercase: 'assignmentnumber')
2026-01-13 13:40:35,749 INFO     pii_core:       Scope=fieldname: 'assignmentnumber' in 'bank branch name' = False
2026-01-13 13:40:35,750 INFO     pii_core:   No custom rule matches found for 'BankBranchName'
2026-01-13 13:40:35,750 INFO     pii_core: CUSTOM RULES CHECK - Field: 'AccountNumber'
2026-01-13 13:40:35,751 INFO     pii_core:   Normalized name: 'account number'
2026-01-13 13:40:35,751 INFO     pii_core:   Description: ''
2026-01-13 13:40:35,753 INFO     pii_core:   Table name: 'external bank account owner'
2026-01-13 13:40:35,753 INFO     pii_core:   Total custom rules: 1
2026-01-13 13:40:35,754 INFO     pii_core:   Rule #1: scope='fieldname', action='Non-PII', patterns=1
2026-01-13 13:40:35,755 INFO     pii_core:     Checking pattern: 'AssignmentNumber' (lowercase: 'assignmentnumber')
2026-01-13 13:40:35,755 INFO     pii_core:       Scope=fieldname: 'assignmentnumber' in 'account number' = False
2026-01-13 13:40:35,756 INFO     pii_core:   No custom rule matches found for 'AccountNumber'
2026-01-13 13:40:35,757 INFO     pii_core: CUSTOM RULES CHECK - Field: 'ExternalBankAccountId'
2026-01-13 13:40:35,757 INFO     pii_core:   Normalized name: 'external bank account id'
2026-01-13 13:40:35,757 INFO     pii_core:   Description: ''
2026-01-13 13:40:35,758 INFO     pii_core:   Table name: 'external bank account owner'
2026-01-13 13:40:35,758 INFO     pii_core:   Total custom rules: 1
2026-01-13 13:40:35,759 INFO     pii_core:   Rule #1: scope='fieldname', action='Non-PII', patterns=1
2026-01-13 13:40:35,759 INFO     pii_core:     Checking pattern: 'AssignmentNumber' (lowercase: 'assignmentnumber')
2026-01-13 13:40:35,760 INFO     pii_core:       Scope=fieldname: 'assignmentnumber' in 'external bank account id' = False
2026-01-13 13:40:35,761 INFO     pii_core:   No custom rule matches found for 'ExternalBankAccountId'
2026-01-13 13:40:35,761 INFO     pii_core: CUSTOM RULES CHECK - Field: 'BankBranchNumber'
2026-01-13 13:40:35,761 INFO     pii_core:   Normalized name: 'bank branch number'
2026-01-13 13:40:35,763 INFO     pii_core:   Description: ''
2026-01-13 13:40:35,765 INFO     pii_core:   Table name: 'external bank account owner'
2026-01-13 13:40:35,766 INFO     pii_core:   Total custom rules: 1
2026-01-13 13:40:35,767 INFO     pii_core:   Rule #1: scope='fieldname', action='Non-PII', patterns=1
2026-01-13 13:40:35,768 INFO     pii_core:     Checking pattern: 'AssignmentNumber' (lowercase: 'assignmentnumber')
2026-01-13 13:40:35,769 INFO     pii_core:       Scope=fieldname: 'assignmentnumber' in 'bank branch number' = False
2026-01-13 13:40:35,770 INFO     pii_core:   No custom rule matches found for 'BankBranchNumber'
2026-01-13 13:40:35,770 INFO     pii_core: Rule-based: 7 PII, 0 non-PII, 1 ambiguous
2026-01-13 13:40:35,771 INFO     pii_core: Phase 2: Gemini API detection (1 fields)
2026-01-13 13:40:35,772 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 13:40:39,442 INFO     utils.gemini_client: Successfully processed batch with 1 rows
2026-01-13 13:40:39,444 INFO     pii_core: Processing sheet 2/2: 'Assignments HDL'
2026-01-13 13:40:39,448 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 13:40:39,450 INFO     pii_core: CUSTOM RULES CHECK - Field: 'AssignmentNumber'
2026-01-13 13:40:39,450 INFO     pii_core:   Normalized name: 'assignment number'
2026-01-13 13:40:39,450 INFO     pii_core:   Description: ''
2026-01-13 13:40:39,450 INFO     pii_core:   Table name: 'personal payment method'
2026-01-13 13:40:39,456 INFO     pii_core:   Total custom rules: 1
2026-01-13 13:40:39,457 INFO     pii_core:   Rule #1: scope='fieldname', action='Non-PII', patterns=1
2026-01-13 13:40:39,461 INFO     pii_core:     Checking pattern: 'AssignmentNumber' (lowercase: 'assignmentnumber')
2026-01-13 13:40:39,461 INFO     pii_core:       Scope=fieldname: 'assignmentnumber' in 'assignment number' = False
2026-01-13 13:40:39,464 INFO     pii_core:   No custom rule matches found for 'AssignmentNumber'
2026-01-13 13:40:39,467 INFO     pii_core: CUSTOM RULES CHECK - Field: 'SupervisorAssignmentNumber'
2026-01-13 13:40:39,467 INFO     pii_core:   Normalized name: 'supervisor assignment number'
2026-01-13 13:40:39,467 INFO     pii_core:   Description: ''
2026-01-13 13:40:39,471 INFO     pii_core:   Table name: 'position'
2026-01-13 13:40:39,471 INFO     pii_core:   Total custom rules: 1
2026-01-13 13:40:39,475 INFO     pii_core:   Rule #1: scope='fieldname', action='Non-PII', patterns=1
2026-01-13 13:40:39,475 INFO     pii_core:     Checking pattern: 'AssignmentNumber' (lowercase: 'assignmentnumber')
2026-01-13 13:40:39,480 INFO     pii_core:       Scope=fieldname: 'assignmentnumber' in 'supervisor assignment number' = False
2026-01-13 13:40:39,480 INFO     pii_core:   No custom rule matches found for 'SupervisorAssignmentNumber'
2026-01-13 13:40:39,482 INFO     pii_core: CUSTOM RULES CHECK - Field: 'GradeCode'
2026-01-13 13:40:39,484 INFO     pii_core:   Normalized name: 'grade code'
2026-01-13 13:40:39,486 INFO     pii_core:   Description: ''
2026-01-13 13:40:39,489 INFO     pii_core:   Table name: 'seniority date'
2026-01-13 13:40:39,491 INFO     pii_core:   Total custom rules: 1
2026-01-13 13:40:39,492 INFO     pii_core:   Rule #1: scope='fieldname', action='Non-PII', patterns=1
2026-01-13 13:40:39,495 INFO     pii_core:     Checking pattern: 'AssignmentNumber' (lowercase: 'assignmentnumber')
2026-01-13 13:40:39,498 INFO     pii_core:       Scope=fieldname: 'assignmentnumber' in 'grade code' = False
2026-01-13 13:40:39,501 INFO     pii_core:   No custom rule matches found for 'GradeCode'
2026-01-13 13:40:39,505 INFO     pii_core: CUSTOM RULES CHECK - Field: 'JobCode'
2026-01-13 13:40:39,507 INFO     pii_core:   Normalized name: 'job code'
2026-01-13 13:40:39,507 INFO     pii_core:   Description: ''
2026-01-13 13:40:39,509 INFO     pii_core:   Table name: 'seniority date'
2026-01-13 13:40:39,511 INFO     pii_core:   Total custom rules: 1
2026-01-13 13:40:39,513 INFO     pii_core:   Rule #1: scope='fieldname', action='Non-PII', patterns=1
2026-01-13 13:40:39,515 INFO     pii_core:     Checking pattern: 'AssignmentNumber' (lowercase: 'assignmentnumber')
2026-01-13 13:40:39,517 INFO     pii_core:       Scope=fieldname: 'assignmentnumber' in 'job code' = False
2026-01-13 13:40:39,521 INFO     pii_core:   No custom rule matches found for 'JobCode'
2026-01-13 13:40:39,524 INFO     pii_core: CUSTOM RULES CHECK - Field: 'AssignmentNumber'
2026-01-13 13:40:39,526 INFO     pii_core:   Normalized name: 'assignment number'
2026-01-13 13:40:39,527 INFO     pii_core:   Description: ''
2026-01-13 13:40:39,530 INFO     pii_core:   Table name: 'assignmentworkmeasure'
2026-01-13 13:40:39,532 INFO     pii_core:   Total custom rules: 1
2026-01-13 13:40:39,534 INFO     pii_core:   Rule #1: scope='fieldname', action='Non-PII', patterns=1
2026-01-13 13:40:39,535 INFO     pii_core:     Checking pattern: 'AssignmentNumber' (lowercase: 'assignmentnumber')
2026-01-13 13:40:39,537 INFO     pii_core:       Scope=fieldname: 'assignmentnumber' in 'assignment number' = False
2026-01-13 13:40:39,540 INFO     pii_core:   No custom rule matches found for 'AssignmentNumber'
2026-01-13 13:40:39,542 INFO     pii_core: CUSTOM RULES CHECK - Field: 'AssignmentNumber'
2026-01-13 13:40:39,544 INFO     pii_core:   Normalized name: 'assignment number'
2026-01-13 13:40:39,546 INFO     pii_core:   Description: ''
2026-01-13 13:40:39,547 INFO     pii_core:   Table name: 'salary'
2026-01-13 13:40:39,550 INFO     pii_core:   Total custom rules: 1
2026-01-13 13:40:39,552 INFO     pii_core:   Rule #1: scope='fieldname', action='Non-PII', patterns=1
2026-01-13 13:40:39,552 INFO     pii_core:     Checking pattern: 'AssignmentNumber' (lowercase: 'assignmentnumber')
2026-01-13 13:40:39,552 INFO     pii_core:       Scope=fieldname: 'assignmentnumber' in 'assignment number' = False
2026-01-13 13:40:39,556 INFO     pii_core:   No custom rule matches found for 'AssignmentNumber'
2026-01-13 13:40:39,558 INFO     pii_core: CUSTOM RULES CHECK - Field: 'AssignmentNumber'
2026-01-13 13:40:39,560 INFO     pii_core:   Normalized name: 'assignment number'
2026-01-13 13:40:39,560 INFO     pii_core:   Description: ''
2026-01-13 13:40:39,562 INFO     pii_core:   Table name: 'personal payment method'
2026-01-13 13:40:39,562 INFO     pii_core:   Total custom rules: 1
2026-01-13 13:40:39,562 INFO     pii_core:   Rule #1: scope='fieldname', action='Non-PII', patterns=1
2026-01-13 13:40:39,562 INFO     pii_core:     Checking pattern: 'AssignmentNumber' (lowercase: 'assignmentnumber')
2026-01-13 13:40:39,568 INFO     pii_core:       Scope=fieldname: 'assignmentnumber' in 'assignment number' = False
2026-01-13 13:40:39,568 INFO     pii_core:   No custom rule matches found for 'AssignmentNumber'
2026-01-13 13:40:39,573 INFO     pii_core: Rule-based: 5 PII, 0 non-PII, 2 ambiguous
2026-01-13 13:40:39,573 INFO     pii_core: Phase 2: Gemini API detection (2 fields)
2026-01-13 13:40:39,577 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 13:40:43,924 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-13 13:40:43,986 INFO     pii_core: ================================================================================
2026-01-13 13:40:43,986 INFO     pii_core: COMPLETE: 12/15 PII fields found
2026-01-13 13:40:43,989 INFO     pii_core: ================================================================================
2026-01-13 15:59:06,718 INFO     root: ================================================================================
2026-01-13 15:59:06,718 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-13 15:59:07,246 INFO     __main__: Connected to database.
2026-01-13 15:59:07,302 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 15:59:07,869 INFO     __main__: Connected to database.
2026-01-13 15:59:07,885 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-13 16:04:53,297 INFO     root: ================================================================================
2026-01-13 16:04:53,298 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-13 16:04:53,783 INFO     __main__: Connected to database.
2026-01-13 16:04:53,803 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:04:54,037 INFO     __main__: Connected to database.
2026-01-13 16:04:54,037 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-13 16:05:42,149 INFO     __main__: Custom rule extracted:
2026-01-13 16:05:42,149 INFO     __main__:   Patterns: 1
2026-01-13 16:05:42,149 INFO     __main__:   Scope: fieldname
2026-01-13 16:05:42,165 INFO     __main__:   Action: Non-PII
2026-01-13 16:05:42,165 INFO     __main__: Custom rules detected: 1 rule(s)
2026-01-13 16:05:42,287 INFO     __main__: Connected to database.
2026-01-13 16:05:42,287 INFO     pii_core: Loading PII detection rules from database
2026-01-13 16:05:42,287 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 16:05:42,287 INFO     pii_database: Loading PII detection rules from database
2026-01-13 16:05:42,335 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 16:05:42,335 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 16:05:42,335 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-13 16:05:42,335 INFO     pii_core:   Rule: 1 patterns, Scope=fieldname, Action=Non-PII, Type=None
2026-01-13 16:05:42,350 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-13 16:05:42,350 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 16:05:42,354 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 16:05:42,355 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 16:05:42,356 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 16:05:42,357 INFO     pii_core: ================================================================================
2026-01-13 16:05:42,359 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 16:05:42,360 INFO     pii_core: ================================================================================
2026-01-13 16:05:42,362 INFO     pii_core: Reading Excel file: 'External Bank Account HDL.xlsx'
2026-01-13 16:05:42,508 INFO     pii_core: Excel file has 2 sheet(s)
2026-01-13 16:05:42,508 INFO     pii_core: Sheet 'External Bank Account HDL' validated
2026-01-13 16:05:42,508 INFO     pii_core: Sheet 'Assignments HDL' validated
2026-01-13 16:05:42,515 INFO     pii_core: Processing 2 sheet(s)
2026-01-13 16:05:42,517 INFO     pii_core: Processing sheet 1/2: 'External Bank Account HDL'
2026-01-13 16:05:42,537 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 16:05:42,537 INFO     pii_core: Rule-based: 7 PII, 0 non-PII, 1 ambiguous
2026-01-13 16:05:42,537 INFO     pii_core: Phase 2: Gemini API detection (1 fields)
2026-01-13 16:05:42,547 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 16:05:47,340 INFO     utils.gemini_client: Successfully processed batch with 1 rows
2026-01-13 16:05:47,340 INFO     pii_core: Processing sheet 2/2: 'Assignments HDL'
2026-01-13 16:05:47,340 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 16:05:47,356 INFO     pii_core: Rule-based: 0 PII, 5 non-PII, 2 ambiguous
2026-01-13 16:05:47,359 INFO     pii_core: Phase 2: Gemini API detection (2 fields)
2026-01-13 16:05:47,362 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 16:05:52,112 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-13 16:05:52,203 INFO     pii_core: ================================================================================
2026-01-13 16:05:52,203 INFO     pii_core: COMPLETE: 7/15 PII fields found
2026-01-13 16:05:52,203 INFO     pii_core: ================================================================================
2026-01-13 16:06:57,740 INFO     __main__: PII detection cleared (including custom rules)
2026-01-13 16:07:12,689 INFO     __main__: Custom rule extracted:
2026-01-13 16:07:12,689 INFO     __main__:   Patterns: 1
2026-01-13 16:07:12,689 INFO     __main__:   Scope: tablename
2026-01-13 16:07:12,689 INFO     __main__:   Action: PII
2026-01-13 16:07:12,689 INFO     __main__:   PII Type: Custom_PII
2026-01-13 16:07:12,695 INFO     __main__: Custom rules detected: 1 rule(s)
2026-01-13 16:07:12,768 INFO     __main__: Connected to database.
2026-01-13 16:07:12,768 INFO     pii_core: Loading PII detection rules from database
2026-01-13 16:07:12,768 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 16:07:12,768 INFO     pii_database: Loading PII detection rules from database
2026-01-13 16:07:12,797 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 16:07:12,797 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 16:07:12,797 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-13 16:07:12,803 INFO     pii_core:   Rule: 1 patterns, Scope=tablename, Action=PII, Type=Custom_PII
2026-01-13 16:07:12,805 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-13 16:07:12,807 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 16:07:12,809 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 16:07:12,811 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 16:07:12,812 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 16:07:12,815 INFO     pii_core: ================================================================================
2026-01-13 16:07:12,818 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 16:07:12,818 INFO     pii_core: ================================================================================
2026-01-13 16:07:12,821 INFO     pii_core: Reading Excel file: 'External Bank Account HDL.xlsx'
2026-01-13 16:07:12,846 INFO     pii_core: Excel file has 2 sheet(s)
2026-01-13 16:07:12,847 INFO     pii_core: Sheet 'External Bank Account HDL' validated
2026-01-13 16:07:12,848 INFO     pii_core: Sheet 'Assignments HDL' validated
2026-01-13 16:07:12,849 INFO     pii_core: Processing 2 sheet(s)
2026-01-13 16:07:12,852 INFO     pii_core: Processing sheet 1/2: 'External Bank Account HDL'
2026-01-13 16:07:12,854 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 16:07:12,859 INFO     pii_core: Rule-based: 7 PII, 0 non-PII, 1 ambiguous
2026-01-13 16:07:12,859 INFO     pii_core: Phase 2: Gemini API detection (1 fields)
2026-01-13 16:07:12,863 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 16:07:17,371 INFO     utils.gemini_client: Successfully processed batch with 1 rows
2026-01-13 16:07:17,371 INFO     pii_core: Processing sheet 2/2: 'Assignments HDL'
2026-01-13 16:07:17,371 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 16:07:17,379 INFO     pii_core: Rule-based: 7 PII, 0 non-PII, 0 ambiguous
2026-01-13 16:07:17,440 INFO     pii_core: ================================================================================
2026-01-13 16:07:17,441 INFO     pii_core: COMPLETE: 14/15 PII fields found
2026-01-13 16:07:17,442 INFO     pii_core: ================================================================================
2026-01-13 16:14:13,021 INFO     root: ================================================================================
2026-01-13 16:14:13,021 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-13 16:14:13,523 INFO     __main__: Connected to database.
2026-01-13 16:14:13,543 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:14:13,731 INFO     __main__: Connected to database.
2026-01-13 16:14:13,731 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-13 16:40:31,346 INFO     __main__: Connected to database.
2026-01-13 16:40:31,394 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:40:32,653 INFO     __main__: Connected to database.
2026-01-13 16:40:32,655 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:40:34,625 INFO     __main__: Connected to database.
2026-01-13 16:40:34,625 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:40:37,435 INFO     __main__: Connected to database.
2026-01-13 16:40:37,435 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:40:40,711 INFO     __main__: Connected to database.
2026-01-13 16:40:40,711 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:40:43,102 INFO     __main__: Connected to database.
2026-01-13 16:40:43,118 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:40:52,295 INFO     __main__: Connected to database.
2026-01-13 16:40:52,295 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:40:58,869 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry', 'External Bank Account', 'Pay Bank Account Prenote'], 'filename': []}
2026-01-13 16:40:59,013 INFO     __main__: Connected to database.
2026-01-13 16:40:59,013 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry', 'External Bank Account', 'Pay Bank Account Prenote'], 'filename': []}
2026-01-13 16:40:59,015 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s,%s,%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry', 'External Bank Account', 'Pay Bank Account Prenote']
2026-01-13 16:40:59,027 INFO     __main__: Retrieved 3 rows.
2026-01-13 16:40:59,028 INFO     __main__: Found 3 project IDs
2026-01-13 16:40:59,029 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s,%s,%s) Params: [1, 2, 4]
2026-01-13 16:40:59,188 INFO     __main__: Retrieved 54 rows.
2026-01-13 16:40:59,188 INFO     __main__: Found 54 child rows
2026-01-13 16:40:59,188 INFO     __main__: Normal processing (no transitivity)
2026-01-13 16:40:59,418 INFO     __main__: Exported summarized Excel file: CNV21-2 - Pay Bank Account Prenote.xlsx
2026-01-13 16:40:59,464 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-13 16:54:34,145 INFO     root: ================================================================================
2026-01-13 16:54:34,145 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-13 16:54:34,671 INFO     __main__: Connected to database.
2026-01-13 16:54:34,717 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:54:35,074 INFO     __main__: Connected to database.
2026-01-13 16:54:35,095 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-13 16:54:44,003 INFO     __main__: Connected to database.
2026-01-13 16:54:44,024 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:54:45,964 INFO     __main__: Connected to database.
2026-01-13 16:54:45,964 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:54:49,668 INFO     __main__: Connected to database.
2026-01-13 16:54:49,668 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:54:51,823 INFO     __main__: Connected to database.
2026-01-13 16:54:51,825 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:54:54,147 INFO     __main__: Connected to database.
2026-01-13 16:54:54,147 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:54:56,510 INFO     __main__: Connected to database.
2026-01-13 16:54:56,510 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:54:59,440 INFO     __main__: Connected to database.
2026-01-13 16:54:59,440 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 16:55:07,800 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-13 16:55:07,933 INFO     __main__: Connected to database.
2026-01-13 16:55:07,933 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-13 16:55:07,933 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-13 16:55:07,948 INFO     __main__: Retrieved 1 rows.
2026-01-13 16:55:07,949 INFO     __main__: Found 1 project IDs
2026-01-13 16:55:07,949 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-13 16:55:08,102 INFO     __main__: Retrieved 49 rows.
2026-01-13 16:55:08,102 INFO     __main__: Found 49 child rows
2026-01-13 16:55:08,104 INFO     __main__: Normal processing (no transitivity)
2026-01-13 16:55:08,104 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-13 16:55:08,328 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-13 16:55:08,328 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-13 16:55:08,348 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-13 16:55:08,455 INFO     __main__: Connected to database.
2026-01-13 16:55:08,455 INFO     pii_core: Loading PII detection rules from database
2026-01-13 16:55:08,455 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 16:55:08,455 INFO     pii_database: Loading PII detection rules from database
2026-01-13 16:55:08,471 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 16:55:08,471 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 16:55:08,471 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 16:55:08,471 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 16:55:08,471 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 16:55:08,471 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 16:55:08,487 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-13 16:55:08,487 INFO     pii_core: ================================================================================
2026-01-13 16:55:08,487 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 16:55:08,487 INFO     pii_core: ================================================================================
2026-01-13 16:55:08,487 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-13 16:55:08,562 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-13 16:55:08,562 ERROR    pii_core: No valid sheets found
2026-01-13 16:55:08,576 ERROR    pii_core: PII detection failed: No valid sheets found
2026-01-13 16:55:08,578 ERROR    __main__: PII detection failed for CNV24 - ElementEntry.xlsx: No valid sheets found
Traceback (most recent call last):
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 5520, in run
    pii_output_file, pii_count, field_count, preview_df = orchestrator.process_file(
                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\pii_core.py", line 438, in process_file
    raise ValueError("No valid sheets found")
ValueError: No valid sheets found
2026-01-13 16:55:29,902 INFO     __main__: PII detection complete: 0 successful, 1 failed
2026-01-13 16:55:39,664 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-13 16:55:39,792 INFO     __main__: Connected to database.
2026-01-13 16:55:39,792 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-13 16:55:39,792 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-13 16:55:39,809 INFO     __main__: Retrieved 1 rows.
2026-01-13 16:55:39,810 INFO     __main__: Found 1 project IDs
2026-01-13 16:55:39,812 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-13 16:55:39,860 INFO     __main__: Retrieved 49 rows.
2026-01-13 16:55:39,860 INFO     __main__: Found 49 child rows
2026-01-13 16:55:39,869 INFO     __main__: Normal processing (no transitivity)
2026-01-13 16:55:39,869 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-13 16:55:39,957 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-13 16:55:39,957 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-13 16:55:39,957 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-13 16:55:40,020 INFO     __main__: Connected to database.
2026-01-13 16:55:40,020 INFO     pii_core: Loading PII detection rules from database
2026-01-13 16:55:40,020 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 16:55:40,020 INFO     pii_database: Loading PII detection rules from database
2026-01-13 16:55:40,031 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 16:55:40,036 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 16:55:40,036 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 16:55:40,036 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 16:55:40,036 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 16:55:40,036 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 16:55:40,036 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-13 16:55:40,036 INFO     pii_core: ================================================================================
2026-01-13 16:55:40,036 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 16:55:40,036 INFO     pii_core: ================================================================================
2026-01-13 16:55:40,036 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-13 16:55:40,068 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-13 16:55:40,068 ERROR    pii_core: No valid sheets found
2026-01-13 16:55:40,068 ERROR    pii_core: PII detection failed: No valid sheets found
2026-01-13 16:55:40,068 ERROR    __main__: PII detection failed for CNV24 - ElementEntry.xlsx: No valid sheets found
Traceback (most recent call last):
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 5520, in run
    pii_output_file, pii_count, field_count, preview_df = orchestrator.process_file(
                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\pii_core.py", line 438, in process_file
    raise ValueError("No valid sheets found")
ValueError: No valid sheets found
2026-01-13 16:56:14,968 INFO     __main__: PII detection complete: 0 successful, 1 failed
2026-01-13 16:56:18,959 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-13 16:56:19,133 INFO     __main__: Connected to database.
2026-01-13 16:56:19,134 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-13 16:56:19,134 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-13 16:56:19,140 INFO     __main__: Retrieved 1 rows.
2026-01-13 16:56:19,140 INFO     __main__: Found 1 project IDs
2026-01-13 16:56:19,140 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-13 16:56:19,206 INFO     __main__: Retrieved 49 rows.
2026-01-13 16:56:19,207 INFO     __main__: Found 49 child rows
2026-01-13 16:56:19,207 INFO     __main__: Normal processing (no transitivity)
2026-01-13 16:56:19,273 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-13 17:09:41,467 INFO     root: ================================================================================
2026-01-13 17:09:41,467 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-13 17:09:41,996 INFO     __main__: Connected to database.
2026-01-13 17:09:42,032 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:09:42,362 INFO     __main__: Connected to database.
2026-01-13 17:09:42,362 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-13 17:09:46,170 INFO     __main__: Connected to database.
2026-01-13 17:09:46,190 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:09:47,832 INFO     __main__: Connected to database.
2026-01-13 17:09:47,835 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:09:50,054 INFO     __main__: Connected to database.
2026-01-13 17:09:50,054 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:09:51,506 INFO     __main__: Connected to database.
2026-01-13 17:09:51,506 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:09:53,451 INFO     __main__: Connected to database.
2026-01-13 17:09:53,451 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:09:58,806 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-13 17:09:58,930 INFO     __main__: Connected to database.
2026-01-13 17:09:58,930 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-13 17:09:58,930 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-13 17:09:58,948 INFO     __main__: Retrieved 1 rows.
2026-01-13 17:09:58,949 INFO     __main__: Found 1 project IDs
2026-01-13 17:09:58,950 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-13 17:09:59,075 INFO     __main__: Retrieved 49 rows.
2026-01-13 17:09:59,075 INFO     __main__: Found 49 child rows
2026-01-13 17:09:59,075 INFO     __main__: Normal processing (no transitivity)
2026-01-13 17:09:59,075 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-13 17:10:06,406 ERROR    __main__: Mapping generation error: [Errno 13] Permission denied: 'CNV24 - ElementEntry.xlsx'
Traceback (most recent call last):
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 5453, in run
    export_summarized_excel(grp.to_dict("records"), fname)
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 514, in export_summarized_excel
    wb.save(filename)
  File "C:\Users\L10319\AppData\Local\Programs\Python\Python311\Lib\site-packages\openpyxl\workbook\workbook.py", line 386, in save
    save_workbook(self, filename)
  File "C:\Users\L10319\AppData\Local\Programs\Python\Python311\Lib\site-packages\openpyxl\writer\excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\L10319\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1294, in __init__
    self.fp = io.open(file, filemode)
              ^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'CNV24 - ElementEntry.xlsx'
2026-01-13 17:10:34,422 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-13 17:10:34,528 INFO     __main__: Connected to database.
2026-01-13 17:10:34,528 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-13 17:10:34,528 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-13 17:10:34,538 INFO     __main__: Retrieved 1 rows.
2026-01-13 17:10:34,538 INFO     __main__: Found 1 project IDs
2026-01-13 17:10:34,538 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-13 17:10:34,579 INFO     __main__: Retrieved 49 rows.
2026-01-13 17:10:34,579 INFO     __main__: Found 49 child rows
2026-01-13 17:10:34,579 INFO     __main__: Normal processing (no transitivity)
2026-01-13 17:10:34,579 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-13 17:10:34,644 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-13 17:10:34,644 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-13 17:10:34,644 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-13 17:10:34,734 INFO     __main__: Connected to database.
2026-01-13 17:10:34,734 INFO     pii_core: Loading PII detection rules from database
2026-01-13 17:10:34,734 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 17:10:34,734 INFO     pii_database: Loading PII detection rules from database
2026-01-13 17:10:34,755 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 17:10:34,755 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 17:10:34,756 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 17:10:34,756 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 17:10:34,756 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 17:10:34,757 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 17:10:34,757 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-13 17:10:34,758 INFO     pii_core: ================================================================================
2026-01-13 17:10:34,759 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 17:10:34,760 INFO     pii_core: ================================================================================
2026-01-13 17:10:34,762 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-13 17:10:34,787 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-13 17:10:34,787 ERROR    pii_core: No valid sheets found
2026-01-13 17:10:34,789 ERROR    pii_core: PII detection failed: No valid sheets found
2026-01-13 17:10:34,789 ERROR    __main__: PII detection failed for CNV24 - ElementEntry.xlsx: No valid sheets found
Traceback (most recent call last):
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 5520, in run
    pii_output_file, pii_count, field_count, preview_df = orchestrator.process_file(
                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\pii_core.py", line 438, in process_file
    raise ValueError("No valid sheets found")
ValueError: No valid sheets found
2026-01-13 17:10:56,708 INFO     __main__: PII detection complete: 0 successful, 1 failed
2026-01-13 17:11:00,332 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-13 17:11:00,477 INFO     __main__: Connected to database.
2026-01-13 17:11:00,477 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-13 17:11:00,477 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-13 17:11:00,485 INFO     __main__: Retrieved 1 rows.
2026-01-13 17:11:00,486 INFO     __main__: Found 1 project IDs
2026-01-13 17:11:00,486 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-13 17:11:00,531 INFO     __main__: Retrieved 49 rows.
2026-01-13 17:11:00,532 INFO     __main__: Found 49 child rows
2026-01-13 17:11:00,533 INFO     __main__: Normal processing (no transitivity)
2026-01-13 17:11:00,536 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-13 17:11:00,610 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-13 17:11:00,610 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-13 17:11:00,610 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-13 17:11:00,684 INFO     __main__: Connected to database.
2026-01-13 17:11:00,684 INFO     pii_core: Loading PII detection rules from database
2026-01-13 17:11:00,684 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 17:11:00,685 INFO     pii_database: Loading PII detection rules from database
2026-01-13 17:11:00,695 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 17:11:00,695 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 17:11:00,695 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 17:11:00,695 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 17:11:00,695 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 17:11:00,695 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 17:11:00,695 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-13 17:11:00,695 INFO     pii_core: ================================================================================
2026-01-13 17:11:00,695 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 17:11:00,695 INFO     pii_core: ================================================================================
2026-01-13 17:11:00,695 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-13 17:11:00,727 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-13 17:11:00,727 ERROR    pii_core: No valid sheets found
2026-01-13 17:11:00,727 ERROR    pii_core: PII detection failed: No valid sheets found
2026-01-13 17:11:00,727 ERROR    __main__: PII detection failed for CNV24 - ElementEntry.xlsx: No valid sheets found
Traceback (most recent call last):
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 5520, in run
    pii_output_file, pii_count, field_count, preview_df = orchestrator.process_file(
                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\pii_core.py", line 438, in process_file
    raise ValueError("No valid sheets found")
ValueError: No valid sheets found
2026-01-13 17:11:07,349 INFO     __main__: PII detection complete: 0 successful, 1 failed
2026-01-13 17:11:08,211 INFO     __main__: Connected to database.
2026-01-13 17:11:08,211 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:11:09,898 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': ['CNV24 - ElementEntry']}
2026-01-13 17:11:09,995 INFO     __main__: Connected to database.
2026-01-13 17:11:09,995 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': ['CNV24 - ElementEntry']}
2026-01-13 17:11:09,995 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) AND filename IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry', 'CNV24 - ElementEntry']
2026-01-13 17:11:09,995 INFO     __main__: Retrieved 1 rows.
2026-01-13 17:11:09,995 INFO     __main__: Found 1 project IDs
2026-01-13 17:11:09,995 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-13 17:11:10,048 INFO     __main__: Retrieved 49 rows.
2026-01-13 17:11:10,048 INFO     __main__: Found 49 child rows
2026-01-13 17:11:10,049 INFO     __main__: Normal processing (no transitivity)
2026-01-13 17:11:10,050 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-13 17:11:10,202 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-13 17:11:10,202 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-13 17:11:10,206 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-13 17:11:10,332 INFO     __main__: Connected to database.
2026-01-13 17:11:10,332 INFO     pii_core: Loading PII detection rules from database
2026-01-13 17:11:10,333 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 17:11:10,333 INFO     pii_database: Loading PII detection rules from database
2026-01-13 17:11:10,345 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 17:11:10,346 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 17:11:10,346 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 17:11:10,349 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 17:11:10,350 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 17:11:10,350 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 17:11:10,352 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-13 17:11:10,354 INFO     pii_core: ================================================================================
2026-01-13 17:11:10,355 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 17:11:10,357 INFO     pii_core: ================================================================================
2026-01-13 17:11:10,359 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-13 17:11:10,410 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-13 17:11:10,410 ERROR    pii_core: No valid sheets found
2026-01-13 17:11:10,410 ERROR    pii_core: PII detection failed: No valid sheets found
2026-01-13 17:11:10,410 ERROR    __main__: PII detection failed for CNV24 - ElementEntry.xlsx: No valid sheets found
Traceback (most recent call last):
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 5520, in run
    pii_output_file, pii_count, field_count, preview_df = orchestrator.process_file(
                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\pii_core.py", line 438, in process_file
    raise ValueError("No valid sheets found")
ValueError: No valid sheets found
2026-01-13 17:19:06,964 INFO     __main__: PII detection complete: 0 successful, 1 failed
2026-01-13 17:19:13,200 INFO     root: ================================================================================
2026-01-13 17:19:13,200 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-13 17:19:13,754 INFO     __main__: Connected to database.
2026-01-13 17:19:13,771 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:19:13,987 INFO     __main__: Connected to database.
2026-01-13 17:19:13,987 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-13 17:19:17,047 INFO     __main__: Connected to database.
2026-01-13 17:19:17,063 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:19:18,162 INFO     __main__: Connected to database.
2026-01-13 17:19:18,164 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:19:19,886 INFO     __main__: Connected to database.
2026-01-13 17:19:19,886 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:19:21,684 INFO     __main__: Connected to database.
2026-01-13 17:19:21,700 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:19:24,421 INFO     __main__: Connected to database.
2026-01-13 17:19:24,437 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:19:27,390 INFO     __main__: Connected to database.
2026-01-13 17:19:27,393 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:19:33,389 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': ['CNV24 - ElementEntry']}
2026-01-13 17:19:33,521 INFO     __main__: Connected to database.
2026-01-13 17:19:33,521 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': ['CNV24 - ElementEntry']}
2026-01-13 17:19:33,521 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) AND filename IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry', 'CNV24 - ElementEntry']
2026-01-13 17:19:33,521 INFO     __main__: Retrieved 1 rows.
2026-01-13 17:19:33,521 INFO     __main__: Found 1 project IDs
2026-01-13 17:19:33,521 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-13 17:19:33,586 INFO     __main__: Retrieved 49 rows.
2026-01-13 17:19:33,586 INFO     __main__: Found 49 child rows
2026-01-13 17:19:33,586 INFO     __main__: Normal processing (no transitivity)
2026-01-13 17:19:33,586 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-13 17:19:33,830 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-13 17:19:33,830 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-13 17:19:33,834 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-13 17:19:33,953 INFO     __main__: Connected to database.
2026-01-13 17:19:33,953 INFO     pii_core: Loading PII detection rules from database
2026-01-13 17:19:33,953 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 17:19:33,955 INFO     pii_database: Loading PII detection rules from database
2026-01-13 17:19:33,970 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 17:19:33,970 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 17:19:33,970 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 17:19:33,978 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 17:19:33,981 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 17:19:33,981 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 17:19:33,985 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-13 17:19:33,987 INFO     pii_core: ================================================================================
2026-01-13 17:19:33,987 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 17:19:33,987 INFO     pii_core: ================================================================================
2026-01-13 17:19:33,995 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-13 17:19:34,011 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-13 17:19:34,242 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-13 17:19:34,270 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-13 17:19:34,317 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-13 17:19:34,317 INFO     pii_core: Processing 1 sheet(s)
2026-01-13 17:19:34,317 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-13 17:19:34,317 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 17:19:34,325 INFO     pii_core: Rule-based: 2 PII, 2 non-PII, 26 ambiguous
2026-01-13 17:19:34,325 INFO     pii_core: Phase 2: Gemini API detection (26 fields)
2026-01-13 17:19:34,332 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 17:19:41,012 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-13 17:19:41,012 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 17:19:48,744 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-13 17:19:48,744 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 17:19:53,378 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-13 17:19:53,442 INFO     pii_core: ================================================================================
2026-01-13 17:19:53,442 INFO     pii_core: COMPLETE: 2/30 PII fields found
2026-01-13 17:19:53,442 INFO     pii_core: ================================================================================
2026-01-13 17:19:53,442 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 2/30 PII fields detected
2026-01-13 17:23:23,361 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-13 17:27:14,284 INFO     __main__: Connected to database.
2026-01-13 17:27:14,284 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:27:17,352 INFO     __main__: Connected to database.
2026-01-13 17:27:17,352 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:27:18,630 INFO     __main__: Connected to database.
2026-01-13 17:27:18,630 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:27:19,748 INFO     __main__: Connected to database.
2026-01-13 17:27:19,763 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:27:22,530 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry', 'Pay Bank Account Prenote', 'Personal Payment Method'], 'filename': []}
2026-01-13 17:27:22,664 INFO     __main__: Connected to database.
2026-01-13 17:27:22,664 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry', 'Pay Bank Account Prenote', 'Personal Payment Method'], 'filename': []}
2026-01-13 17:27:22,664 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s,%s,%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry', 'Pay Bank Account Prenote', 'Personal Payment Method']
2026-01-13 17:27:22,680 INFO     __main__: Retrieved 3 rows.
2026-01-13 17:27:22,681 INFO     __main__: Found 3 project IDs
2026-01-13 17:27:22,681 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s,%s,%s) Params: [2, 3, 4]
2026-01-13 17:27:22,740 INFO     __main__: Retrieved 82 rows.
2026-01-13 17:27:22,741 INFO     __main__: Found 82 child rows
2026-01-13 17:27:22,741 INFO     __main__: Normal processing (no transitivity)
2026-01-13 17:27:22,741 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-13 17:27:22,789 INFO     __main__: Exported summarized Excel file: CNV21-2 - Pay Bank Account Prenote.xlsx
2026-01-13 17:27:22,790 INFO     __main__: Generated mapping file: CNV21-2 - Pay Bank Account Prenote.xlsx
2026-01-13 17:27:22,877 INFO     __main__: Exported summarized Excel file: CNV23 - Personal Payment Method.xlsx
2026-01-13 17:27:22,877 INFO     __main__: Generated mapping file: CNV23 - Personal Payment Method.xlsx
2026-01-13 17:27:23,001 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-13 17:27:23,001 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-13 17:27:23,004 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 3 files
2026-01-13 17:27:23,162 INFO     __main__: Connected to database.
2026-01-13 17:27:23,162 INFO     pii_core: Loading PII detection rules from database
2026-01-13 17:27:23,177 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 17:27:23,178 INFO     pii_database: Loading PII detection rules from database
2026-01-13 17:27:23,199 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 17:27:23,199 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 17:27:23,206 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 17:27:23,210 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 17:27:23,210 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 17:27:23,210 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 17:27:23,210 INFO     __main__: Processing file 1/3: CNV21-2 - Pay Bank Account Prenote.xlsx
2026-01-13 17:27:23,210 INFO     pii_core: ================================================================================
2026-01-13 17:27:23,210 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 17:27:23,210 INFO     pii_core: ================================================================================
2026-01-13 17:27:23,210 INFO     pii_core: Reading Excel file: 'CNV21-2 - Pay Bank Account Prenote.xlsx'
2026-01-13 17:27:23,234 INFO     pii_core: Excel file has 2 sheet(s)
2026-01-13 17:27:23,354 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-13 17:27:23,378 INFO     pii_core: Sheet 'PayBankAccountPrenote' validated (header row: 6, 5 data rows)
2026-01-13 17:27:23,378 INFO     pii_core: Processing 1 sheet(s)
2026-01-13 17:27:23,378 INFO     pii_core: Processing sheet 1/1: 'PayBankAccountPrenote'
2026-01-13 17:27:23,378 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 17:27:23,378 INFO     pii_core: Rule-based: 3 PII, 0 non-PII, 2 ambiguous
2026-01-13 17:27:23,378 INFO     pii_core: Phase 2: Gemini API detection (2 fields)
2026-01-13 17:27:23,378 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 17:27:27,741 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-13 17:27:27,800 INFO     pii_core: ================================================================================
2026-01-13 17:27:27,800 INFO     pii_core: COMPLETE: 3/5 PII fields found
2026-01-13 17:27:27,800 INFO     pii_core: ================================================================================
2026-01-13 17:27:27,800 INFO     __main__: Completed CNV21-2 - Pay Bank Account Prenote.xlsx: 3/5 PII fields detected
2026-01-13 17:27:27,800 INFO     __main__: Processing file 2/3: CNV23 - Personal Payment Method.xlsx
2026-01-13 17:27:27,800 INFO     pii_core: ================================================================================
2026-01-13 17:27:27,813 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 17:27:27,814 INFO     pii_core: ================================================================================
2026-01-13 17:27:27,814 INFO     pii_core: Reading Excel file: 'CNV23 - Personal Payment Method.xlsx'
2026-01-13 17:27:27,834 INFO     pii_core: Excel file has 2 sheet(s)
2026-01-13 17:27:27,952 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-13 17:27:27,992 INFO     pii_core: Sheet 'Personal Payment Method' validated (header row: 6, 28 data rows)
2026-01-13 17:27:27,992 INFO     pii_core: Processing 1 sheet(s)
2026-01-13 17:27:27,994 INFO     pii_core: Processing sheet 1/1: 'Personal Payment Method'
2026-01-13 17:27:27,994 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 17:27:27,994 INFO     pii_core: Rule-based: 4 PII, 2 non-PII, 22 ambiguous
2026-01-13 17:27:27,994 INFO     pii_core: Phase 2: Gemini API detection (22 fields)
2026-01-13 17:27:27,994 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 17:27:33,353 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-13 17:27:33,353 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 17:27:38,223 INFO     utils.gemini_client: Successfully processed batch with 10 rows
2026-01-13 17:27:38,280 INFO     pii_core: ================================================================================
2026-01-13 17:27:38,280 INFO     pii_core: COMPLETE: 4/28 PII fields found
2026-01-13 17:27:38,280 INFO     pii_core: ================================================================================
2026-01-13 17:27:38,280 INFO     __main__: Completed CNV23 - Personal Payment Method.xlsx: 4/28 PII fields detected
2026-01-13 17:27:38,296 INFO     __main__: Processing file 3/3: CNV24 - ElementEntry.xlsx
2026-01-13 17:27:38,297 INFO     pii_core: ================================================================================
2026-01-13 17:27:38,297 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 17:27:38,297 INFO     pii_core: ================================================================================
2026-01-13 17:27:38,297 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-13 17:27:38,325 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-13 17:27:38,491 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-13 17:27:38,523 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-13 17:27:38,606 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-13 17:27:38,606 INFO     pii_core: Processing 1 sheet(s)
2026-01-13 17:27:38,607 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-13 17:27:38,608 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 17:27:38,615 INFO     pii_core: Rule-based: 2 PII, 2 non-PII, 26 ambiguous
2026-01-13 17:27:38,616 INFO     pii_core: Phase 2: Gemini API detection (26 fields)
2026-01-13 17:27:38,618 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 17:27:46,729 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-13 17:27:46,729 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 17:27:52,055 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-13 17:27:52,055 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 17:27:56,607 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-13 17:27:56,680 INFO     pii_core: ================================================================================
2026-01-13 17:27:56,680 INFO     pii_core: COMPLETE: 2/30 PII fields found
2026-01-13 17:27:56,680 INFO     pii_core: ================================================================================
2026-01-13 17:27:56,680 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 2/30 PII fields detected
2026-01-13 17:28:21,309 INFO     __main__: PII detection complete: 3 successful, 0 failed
2026-01-13 17:40:02,226 INFO     root: ================================================================================
2026-01-13 17:40:02,226 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-13 17:40:02,720 INFO     __main__: Connected to database.
2026-01-13 17:40:02,801 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:40:03,198 INFO     __main__: Connected to database.
2026-01-13 17:40:03,198 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-13 17:40:07,329 INFO     __main__: Connected to database.
2026-01-13 17:40:07,329 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:40:09,288 INFO     __main__: Connected to database.
2026-01-13 17:40:09,290 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:40:11,020 INFO     __main__: Connected to database.
2026-01-13 17:40:11,020 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:40:12,767 INFO     __main__: Connected to database.
2026-01-13 17:40:12,781 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:40:17,803 INFO     __main__: Connected to database.
2026-01-13 17:40:17,803 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:40:19,139 INFO     __main__: Connected to database.
2026-01-13 17:40:19,144 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-13 17:40:30,077 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['External Bank Account', 'Pay Bank Account Prenote'], 'filename': []}
2026-01-13 17:40:30,202 INFO     __main__: Connected to database.
2026-01-13 17:40:30,202 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['External Bank Account', 'Pay Bank Account Prenote'], 'filename': []}
2026-01-13 17:40:30,202 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s,%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'External Bank Account', 'Pay Bank Account Prenote']
2026-01-13 17:40:30,223 INFO     __main__: Retrieved 2 rows.
2026-01-13 17:40:30,225 INFO     __main__: Found 2 project IDs
2026-01-13 17:40:30,226 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s,%s) Params: [1, 2]
2026-01-13 17:40:30,334 INFO     __main__: Retrieved 5 rows.
2026-01-13 17:40:30,334 INFO     __main__: Found 5 child rows
2026-01-13 17:40:30,334 INFO     __main__: Normal processing (no transitivity)
2026-01-13 17:40:30,334 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-13 17:40:30,501 INFO     __main__: Exported summarized Excel file: CNV21-2 - Pay Bank Account Prenote.xlsx
2026-01-13 17:40:30,501 INFO     __main__: Generated mapping file: CNV21-2 - Pay Bank Account Prenote.xlsx
2026-01-13 17:40:30,501 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-13 17:40:30,601 INFO     __main__: Connected to database.
2026-01-13 17:40:30,613 INFO     pii_core: Loading PII detection rules from database
2026-01-13 17:40:30,613 INFO     pii_database: Using provided database connection for PII rules
2026-01-13 17:40:30,613 INFO     pii_database: Loading PII detection rules from database
2026-01-13 17:40:30,646 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-13 17:40:30,647 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-13 17:40:30,648 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-13 17:40:30,650 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-13 17:40:30,652 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-13 17:40:30,655 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-13 17:40:30,656 INFO     __main__: Processing file 1/1: CNV21-2 - Pay Bank Account Prenote.xlsx
2026-01-13 17:40:30,658 INFO     pii_core: ================================================================================
2026-01-13 17:40:30,661 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-13 17:40:30,662 INFO     pii_core: ================================================================================
2026-01-13 17:40:30,665 INFO     pii_core: Reading Excel file: 'CNV21-2 - Pay Bank Account Prenote.xlsx'
2026-01-13 17:40:30,685 INFO     pii_core: Excel file has 2 sheet(s)
2026-01-13 17:40:30,930 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-13 17:40:31,044 INFO     pii_core: Sheet 'PayBankAccountPrenote' validated (header row: 6, 5 data rows)
2026-01-13 17:40:31,044 INFO     pii_core: Processing 1 sheet(s)
2026-01-13 17:40:31,045 INFO     pii_core: Processing sheet 1/1: 'PayBankAccountPrenote'
2026-01-13 17:40:31,045 INFO     pii_core: Phase 1: Rule-based classification
2026-01-13 17:40:31,052 INFO     pii_core: Rule-based: 3 PII, 0 non-PII, 2 ambiguous
2026-01-13 17:40:31,053 INFO     pii_core: Phase 2: Gemini API detection (2 fields)
2026-01-13 17:40:31,054 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-13 17:40:35,037 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-13 17:40:35,086 INFO     pii_core: ================================================================================
2026-01-13 17:40:35,088 INFO     pii_core: COMPLETE: 3/5 PII fields found
2026-01-13 17:40:35,089 INFO     pii_core: ================================================================================
2026-01-13 17:40:35,089 INFO     __main__: Completed CNV21-2 - Pay Bank Account Prenote.xlsx: 3/5 PII fields detected
2026-01-13 17:40:51,970 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-13 17:40:51,970 WARNING  __main__: Could not delete CNV21-2 - Pay Bank Account Prenote.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV21-2 - Pay Bank Account Prenote.xlsx'
2026-01-13 17:40:51,986 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-19 10:40:16,049 INFO     root: ================================================================================
2026-01-19 10:40:16,049 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-19 10:40:17,150 INFO     __main__: Connected to database.
2026-01-19 10:40:17,236 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:40:17,685 INFO     __main__: Connected to database.
2026-01-19 10:40:17,694 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-19 10:40:34,732 INFO     __main__: Connected to database.
2026-01-19 10:40:34,748 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:40:36,422 INFO     __main__: Connected to database.
2026-01-19 10:40:36,425 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:40:39,164 INFO     __main__: Connected to database.
2026-01-19 10:40:39,180 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:40:41,378 INFO     __main__: Connected to database.
2026-01-19 10:40:41,388 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:40:45,116 INFO     __main__: Connected to database.
2026-01-19 10:40:45,120 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:40:47,165 INFO     __main__: Connected to database.
2026-01-19 10:40:47,165 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:40:47,805 INFO     __main__: Connected to database.
2026-01-19 10:40:47,808 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:40:50,863 INFO     __main__: Connected to database.
2026-01-19 10:40:50,868 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:41:00,815 INFO     __main__: Connected to database.
2026-01-19 10:41:00,815 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:41:16,283 INFO     __main__: Filters: {'legacysystem': ['PeopleSoft'], 'targetsystem': ['Oracle Cloud'], 'projectname': [], 'domainname': [], 'subdomainname': [], 'filename': []}
2026-01-19 10:41:16,380 INFO     __main__: Connected to database.
2026-01-19 10:41:16,380 INFO     __main__: Building projectid query with filters: {'legacysystem': ['PeopleSoft'], 'targetsystem': ['Oracle Cloud'], 'projectname': [], 'domainname': [], 'subdomainname': [], 'filename': []}
2026-01-19 10:41:16,380 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) Params: ['PeopleSoft', 'Oracle Cloud']
2026-01-19 10:41:16,390 INFO     __main__: Retrieved 46 rows.
2026-01-19 10:41:16,390 INFO     __main__: Found 46 project IDs
2026-01-19 10:41:16,390 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s) Params: [54, 29, 71, 68, 34, 51, 70, 52, 67, 63, 35, 45, 39, 69, 36, 31, 50, 60, 66, 59, 65, 62, 44, 42, 41, 46, 40, 43, 53, 32, 38, 48, 26, 57, 61, 30, 49, 47, 37, 28, 33, 64, 55, 27, 56, 58]
2026-01-19 10:41:16,838 INFO     __main__: Retrieved 20798 rows.
2026-01-19 10:41:16,838 INFO     __main__: Found 20798 child rows
2026-01-19 10:41:16,838 INFO     __main__: Normal processing (no transitivity)
2026-01-19 10:41:16,838 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-19 10:41:17,143 INFO     __main__: Exported summarized Excel file: AP Open Invoices Conversion Mapping Specification.xlsx
2026-01-19 10:41:17,143 INFO     __main__: Generated mapping file: AP Open Invoices Conversion Mapping Specification.xlsx
2026-01-19 10:41:17,177 INFO     __main__: Exported summarized Excel file: Banks and Branches-Template.xlsx
2026-01-19 10:41:17,177 INFO     __main__: Generated mapping file: Banks and Branches-Template.xlsx
2026-01-19 10:41:17,362 INFO     __main__: Exported summarized Excel file: CMX_C_016 - Fixed Assets Conversion Specification (All Books).xlsx
2026-01-19 10:41:17,362 INFO     __main__: Generated mapping file: CMX_C_016 - Fixed Assets Conversion Specification (All Books).xlsx
2026-01-19 10:41:17,496 INFO     __main__: Exported summarized Excel file: FIN-61_62-GL Journal Mapping Specification.xlsx
2026-01-19 10:41:17,498 INFO     __main__: Generated mapping file: FIN-61_62-GL Journal Mapping Specification.xlsx
2026-01-19 10:41:17,652 INFO     __main__: Exported summarized Excel file: FIN-63-Fixed Assets Mapping Specification.xlsx
2026-01-19 10:41:17,652 INFO     __main__: Generated mapping file: FIN-63-Fixed Assets Mapping Specification.xlsx
2026-01-19 10:41:17,865 INFO     __main__: Exported summarized Excel file: FIN-64A-Project Header Mapping Specification.xlsx
2026-01-19 10:41:17,865 INFO     __main__: Generated mapping file: FIN-64A-Project Header Mapping Specification.xlsx
2026-01-19 10:41:17,903 INFO     __main__: Exported summarized Excel file: FIN-65-Project Cost Mapping Specification.xlsx
2026-01-19 10:41:17,904 INFO     __main__: Generated mapping file: FIN-65-Project Cost Mapping Specification.xlsx
2026-01-19 10:41:17,950 INFO     __main__: Exported summarized Excel file: FIN-68A-Project Budgets Mapping Specification.xlsx
2026-01-19 10:41:17,950 INFO     __main__: Generated mapping file: FIN-68A-Project Budgets Mapping Specification.xlsx
2026-01-19 10:41:18,067 INFO     __main__: Exported summarized Excel file: FIN-70A-AP Invoices Mapping Specification UNPAID.xlsx
2026-01-19 10:41:18,067 INFO     __main__: Generated mapping file: FIN-70A-AP Invoices Mapping Specification UNPAID.xlsx
2026-01-19 10:41:18,171 INFO     __main__: Exported summarized Excel file: FIN-70C-AP Invoices Mapping Specification PAID.xlsx
2026-01-19 10:41:18,171 INFO     __main__: Generated mapping file: FIN-70C-AP Invoices Mapping Specification PAID.xlsx
2026-01-19 10:41:18,459 INFO     __main__: Exported summarized Excel file: Fixed Assets-Mapping Specification.xlsx
2026-01-19 10:41:18,459 INFO     __main__: Generated mapping file: Fixed Assets-Mapping Specification.xlsx
2026-01-19 10:41:18,502 INFO     __main__: Exported summarized Excel file: GL-Mapping Specification.xlsx
2026-01-19 10:41:18,502 INFO     __main__: Generated mapping file: GL-Mapping Specification.xlsx
2026-01-19 10:41:18,603 INFO     __main__: Exported summarized Excel file: HCM-01-Location Mapping Specification.xlsx
2026-01-19 10:41:18,603 INFO     __main__: Generated mapping file: HCM-01-Location Mapping Specification.xlsx
2026-01-19 10:41:19,388 INFO     __main__: Exported summarized Excel file: HCM-02-Organization Mapping Specification.xlsx
2026-01-19 10:41:19,403 INFO     __main__: Generated mapping file: HCM-02-Organization Mapping Specification.xlsx
2026-01-19 10:41:19,519 INFO     __main__: Exported summarized Excel file: HCM-03-Positions Mapping Specification.xlsx
2026-01-19 10:41:19,519 INFO     __main__: Generated mapping file: HCM-03-Positions Mapping Specification.xlsx
2026-01-19 10:41:19,698 INFO     __main__: Exported summarized Excel file: HCM-04-Jobs Mapping Specification.xlsx
2026-01-19 10:41:19,698 INFO     __main__: Generated mapping file: HCM-04-Jobs Mapping Specification.xlsx
2026-01-19 10:41:19,905 INFO     __main__: Exported summarized Excel file: HCM-05-Grades Mapping Specification.xlsx
2026-01-19 10:41:19,905 INFO     __main__: Generated mapping file: HCM-05-Grades Mapping Specification.xlsx
2026-01-19 10:41:20,296 INFO     __main__: Exported summarized Excel file: HCM-06-Person Worker Mapping Specification.xlsx
2026-01-19 10:41:20,298 INFO     __main__: Generated mapping file: HCM-06-Person Worker Mapping Specification.xlsx
2026-01-19 10:41:20,613 INFO     __main__: Exported summarized Excel file: HCM-07-Assignments Mapping Specificaion.xlsx
2026-01-19 10:41:20,613 INFO     __main__: Generated mapping file: HCM-07-Assignments Mapping Specificaion.xlsx
2026-01-19 10:41:20,777 INFO     __main__: Exported summarized Excel file: HCM-08-Salary Mapping Specification.xlsx
2026-01-19 10:41:20,777 INFO     __main__: Generated mapping file: HCM-08-Salary Mapping Specification.xlsx
2026-01-19 10:41:20,831 INFO     __main__: Exported summarized Excel file: HCM-20-Schools (Educational Establishments) Conversion Mapping Specification.xlsx
2026-01-19 10:41:20,832 INFO     __main__: Generated mapping file: HCM-20-Schools (Educational Establishments) Conversion Mapping Specification.xlsx
2026-01-19 10:41:21,098 INFO     __main__: Exported summarized Excel file: HCM-25-Talent Profile Conversion Mapping Specification.xlsx
2026-01-19 10:41:21,100 INFO     __main__: Generated mapping file: HCM-25-Talent Profile Conversion Mapping Specification.xlsx
2026-01-19 10:41:21,157 INFO     __main__: Exported summarized Excel file: PAY-02-Banks and Branches.xlsx
2026-01-19 10:41:21,158 INFO     __main__: Generated mapping file: PAY-02-Banks and Branches.xlsx
2026-01-19 10:41:21,221 INFO     __main__: Exported summarized Excel file: PAY-03-External Banks.xlsx
2026-01-19 10:41:21,221 INFO     __main__: Generated mapping file: PAY-03-External Banks.xlsx
2026-01-19 10:41:21,268 INFO     __main__: Exported summarized Excel file: PAY-04-PersonalPaymentMethod.xlsx
2026-01-19 10:41:21,268 INFO     __main__: Generated mapping file: PAY-04-PersonalPaymentMethod.xlsx
2026-01-19 10:41:21,339 INFO     __main__: Exported summarized Excel file: PAY-05-PayrollRelationship.xlsx
2026-01-19 10:41:21,339 INFO     __main__: Generated mapping file: PAY-05-PayrollRelationship.xlsx
2026-01-19 10:41:21,381 INFO     __main__: Exported summarized Excel file: PAY-06-ElementEntry.xlsx
2026-01-19 10:41:21,381 INFO     __main__: Generated mapping file: PAY-06-ElementEntry.xlsx
2026-01-19 10:41:22,273 INFO     __main__: Exported summarized Excel file: PAY-07A-E-CalculationCard-Taxes.xlsx
2026-01-19 10:41:22,273 INFO     __main__: Generated mapping file: PAY-07A-E-CalculationCard-Taxes.xlsx
2026-01-19 10:41:23,005 INFO     __main__: Exported summarized Excel file: PAY-07F-CalculationCard-Savings Plans.xlsx
2026-01-19 10:41:23,005 INFO     __main__: Generated mapping file: PAY-07F-CalculationCard-Savings Plans.xlsx
2026-01-19 10:41:23,863 INFO     __main__: Exported summarized Excel file: PAY-07G-CalculationCard-Involuntary Deductions.xlsx
2026-01-19 10:41:23,863 INFO     __main__: Generated mapping file: PAY-07G-CalculationCard-Involuntary Deductions.xlsx
2026-01-19 10:41:24,006 INFO     __main__: Exported summarized Excel file: PAY-08-BalanceAdjustment - FMLA.xlsx
2026-01-19 10:41:24,006 INFO     __main__: Generated mapping file: PAY-08-BalanceAdjustment - FMLA.xlsx
2026-01-19 10:41:24,088 INFO     __main__: Exported summarized Excel file: PAY-08-BalanceAdjustment - Limit.xlsx
2026-01-19 10:41:24,088 INFO     __main__: Generated mapping file: PAY-08-BalanceAdjustment - Limit.xlsx
2026-01-19 10:41:24,115 INFO     __main__: Exported summarized Excel file: PAY-10-PayBankAccountPrenote.xlsx
2026-01-19 10:41:24,116 INFO     __main__: Generated mapping file: PAY-10-PayBankAccountPrenote.xlsx
2026-01-19 10:41:24,301 INFO     __main__: Exported summarized Excel file: Purchase Order-Mapping Specification.xlsx
2026-01-19 10:41:24,301 INFO     __main__: Generated mapping file: Purchase Order-Mapping Specification.xlsx
2026-01-19 10:41:24,490 INFO     __main__: Exported summarized Excel file: SCM-73-Suppliers-Mapping Specification.xlsx
2026-01-19 10:41:24,490 INFO     __main__: Generated mapping file: SCM-73-Suppliers-Mapping Specification.xlsx
2026-01-19 10:41:25,344 INFO     __main__: Exported summarized Excel file: SCM-75A-Item Master-Mapping Specification.xlsx
2026-01-19 10:41:25,346 INFO     __main__: Generated mapping file: SCM-75A-Item Master-Mapping Specification.xlsx
2026-01-19 10:41:25,390 INFO     __main__: Exported summarized Excel file: SCM-75C-Item Transaction Default Locators-Mapping Specification.xlsx
2026-01-19 10:41:25,390 INFO     __main__: Generated mapping file: SCM-75C-Item Transaction Default Locators-Mapping Specification.xlsx
2026-01-19 10:41:25,494 INFO     __main__: Exported summarized Excel file: SCM-75D-Item Subinventory Planning Parameters-Mapping Specification.xlsx
2026-01-19 10:41:25,494 INFO     __main__: Generated mapping file: SCM-75D-Item Subinventory Planning Parameters-Mapping Specification.xlsx
2026-01-19 10:41:25,773 INFO     __main__: Exported summarized Excel file: SCM-76-On Hand Inventory-Mapping Specification.xlsx
2026-01-19 10:41:25,773 INFO     __main__: Generated mapping file: SCM-76-On Hand Inventory-Mapping Specification.xlsx
2026-01-19 10:41:25,933 INFO     __main__: Exported summarized Excel file: SCM-79-Purchase Order-Mapping Specification.xlsx
2026-01-19 10:41:25,933 INFO     __main__: Generated mapping file: SCM-79-Purchase Order-Mapping Specification.xlsx
2026-01-19 10:41:26,002 INFO     __main__: Exported summarized Excel file: SCM-80-Intraclass UOM - Mapping Specification.xlsx
2026-01-19 10:41:26,005 INFO     __main__: Generated mapping file: SCM-80-Intraclass UOM - Mapping Specification.xlsx
2026-01-19 10:41:26,086 INFO     __main__: Exported summarized Excel file: SCM-82A-Contract Purchase Agreements - Mapping Specification.xlsx
2026-01-19 10:41:26,086 INFO     __main__: Generated mapping file: SCM-82A-Contract Purchase Agreements - Mapping Specification.xlsx
2026-01-19 10:41:26,170 INFO     __main__: Exported summarized Excel file: Supplier Bank Account-Mapping Specification.xlsx
2026-01-19 10:41:26,170 INFO     __main__: Generated mapping file: Supplier Bank Account-Mapping Specification.xlsx
2026-01-19 10:41:26,229 INFO     __main__: Exported summarized Excel file: SupplierBankAccount Mapping Specification.xlsx
2026-01-19 10:41:26,229 INFO     __main__: Generated mapping file: SupplierBankAccount Mapping Specification.xlsx
2026-01-19 10:41:26,555 INFO     __main__: Exported summarized Excel file: Suppliers Mapping Specification.xlsx
2026-01-19 10:41:26,555 INFO     __main__: Generated mapping file: Suppliers Mapping Specification.xlsx
2026-01-19 10:41:26,794 INFO     __main__: Exported summarized Excel file: Suppliers-Mapping Specification.xlsx
2026-01-19 10:41:26,794 INFO     __main__: Generated mapping file: Suppliers-Mapping Specification.xlsx
2026-01-19 10:41:26,794 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 46 files
2026-01-19 10:41:26,854 INFO     __main__: Connected to database.
2026-01-19 10:41:26,854 INFO     pii_core: Loading PII detection rules from database
2026-01-19 10:41:26,854 INFO     pii_database: Using provided database connection for PII rules
2026-01-19 10:41:26,854 INFO     pii_database: Loading PII detection rules from database
2026-01-19 10:41:26,870 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-19 10:41:26,870 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-19 10:41:26,870 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-19 10:41:26,870 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-19 10:41:26,870 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-19 10:41:26,870 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-19 10:41:26,870 INFO     __main__: Processing file 1/46: AP Open Invoices Conversion Mapping Specification.xlsx
2026-01-19 10:41:26,870 INFO     pii_core: ================================================================================
2026-01-19 10:41:26,870 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-19 10:41:26,870 INFO     pii_core: ================================================================================
2026-01-19 10:41:26,870 INFO     pii_core: Reading Excel file: 'AP Open Invoices Conversion Mapping Specification.xlsx'
2026-01-19 10:41:26,892 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-19 10:41:26,954 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-19 10:41:27,023 INFO     pii_core: Sheet 'AP_INVOICES_INTERFACE' validated (header row: 6, 131 data rows)
2026-01-19 10:41:27,072 INFO     pii_core: Sheet 'AP_INVOICES_LINES_INTERFACE' validated (header row: 6, 157 data rows)
2026-01-19 10:41:27,072 INFO     pii_core: Processing 2 sheet(s)
2026-01-19 10:41:27,072 INFO     pii_core: Processing sheet 1/2: 'AP_INVOICES_INTERFACE'
2026-01-19 10:41:27,072 INFO     pii_core: Phase 1: Rule-based classification
2026-01-19 10:41:27,098 INFO     pii_core: Rule-based: 4 PII, 3 non-PII, 124 ambiguous
2026-01-19 10:41:27,098 INFO     pii_core: Phase 2: Gemini API detection (124 fields)
2026-01-19 10:41:27,104 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:41:32,591 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:41:32,591 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:41:37,903 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:41:37,906 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:41:44,103 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:41:44,107 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:41:49,895 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:41:49,895 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:41:54,897 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:41:54,903 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:42:00,253 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:42:00,253 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:42:00,629 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 58.81592813s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 58
}
]
2026-01-19 10:42:01,638 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:42:01,977 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 57.452090642s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 57
}
]
2026-01-19 10:42:03,988 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:42:04,331 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 55.095189279s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 55
}
]
2026-01-19 10:42:04,331 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:42:04,331 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:42:04,694 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 54.751993359s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 54
}
]
2026-01-19 10:42:05,696 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:42:06,014 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 53.405569771s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 53
}
]
2026-01-19 10:42:08,029 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:42:08,352 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 51.0633838s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 51
}
]
2026-01-19 10:42:08,352 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:42:08,352 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:42:08,713 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 50.722147603s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 50
}
]
2026-01-19 10:42:09,714 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:42:10,047 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 49.375847663s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 49
}
]
2026-01-19 10:42:12,058 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:42:12,415 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 47.017147685s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 47
}
]
2026-01-19 10:42:12,415 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:42:12,415 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:42:12,764 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 46.671232318s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 46
}
]
2026-01-19 10:42:13,776 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:42:14,126 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 45.309695147s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 45
}
]
2026-01-19 10:42:16,133 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:42:16,479 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 42.960689381s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 42
}
]
2026-01-19 10:42:16,479 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:42:16,479 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:42:16,827 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 42.608286811s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 42
}
]
2026-01-19 10:42:17,833 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:42:18,179 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 41.257574187s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 41
}
]
2026-01-19 10:42:20,181 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:42:20,515 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 38.915113615s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 38
}
]
2026-01-19 10:42:20,531 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:42:20,535 INFO     pii_core: Processing sheet 2/2: 'AP_INVOICES_LINES_INTERFACE'
2026-01-19 10:42:20,535 INFO     pii_core: Phase 1: Rule-based classification
2026-01-19 10:42:20,577 INFO     pii_core: Rule-based: 1 PII, 1 non-PII, 155 ambiguous
2026-01-19 10:42:20,578 INFO     pii_core: Phase 2: Gemini API detection (155 fields)
2026-01-19 10:42:20,592 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:42:20,924 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 38.50905976s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 38
}
]
2026-01-19 10:42:21,933 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:42:22,265 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 37.16271256s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 37
}
]
2026-01-19 10:42:24,277 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:42:24,616 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 34.819686753s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 34
}
]
2026-01-19 10:42:24,616 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:42:24,627 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:42:24,981 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 34.460231406s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 34
}
]
2026-01-19 10:42:25,989 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:42:26,315 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 33.111723412s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 33
}
]
2026-01-19 10:42:28,325 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:42:28,668 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 30.769879735s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 30
}
]
2026-01-19 10:42:28,668 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:42:28,668 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:42:36,554 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:42:36,554 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:42:44,011 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:42:44,011 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:42:52,854 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:42:52,854 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:43:03,425 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:43:03,426 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:43:11,727 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:43:11,727 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:43:16,993 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:43:16,993 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:43:17,342 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 42.09153014s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 42
}
]
2026-01-19 10:43:18,343 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:43:18,680 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 40.750714037s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 40
}
]
2026-01-19 10:43:20,683 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:43:21,028 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 38.418022902s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 38
}
]
2026-01-19 10:43:21,028 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:43:21,028 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:43:21,361 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 38.05184576s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 38
}
]
2026-01-19 10:43:22,376 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:43:22,702 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 36.717204451s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 36
}
]
2026-01-19 10:43:24,705 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:43:25,032 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 34.391864892s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 34
}
]
2026-01-19 10:43:25,032 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:43:25,032 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:43:25,383 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 34.053866325s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 34
}
]
2026-01-19 10:43:26,385 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:43:26,736 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 32.712172397s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 32
}
]
2026-01-19 10:43:28,738 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:43:34,012 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:43:34,012 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:43:40,098 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:43:40,103 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:43:44,623 INFO     utils.gemini_client: Successfully processed batch with 11 rows
2026-01-19 10:43:44,850 INFO     pii_core: ================================================================================
2026-01-19 10:43:44,850 INFO     pii_core: COMPLETE: 5/288 PII fields found
2026-01-19 10:43:44,850 INFO     pii_core: ================================================================================
2026-01-19 10:43:44,850 INFO     __main__: Completed AP Open Invoices Conversion Mapping Specification.xlsx: 5/288 PII fields detected
2026-01-19 10:43:44,850 INFO     __main__: Processing file 2/46: Banks and Branches-Template.xlsx
2026-01-19 10:43:44,850 INFO     pii_core: ================================================================================
2026-01-19 10:43:44,850 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-19 10:43:44,850 INFO     pii_core: ================================================================================
2026-01-19 10:43:44,850 INFO     pii_core: Reading Excel file: 'Banks and Branches-Template.xlsx'
2026-01-19 10:43:44,850 INFO     pii_core: Excel file has 2 sheet(s)
2026-01-19 10:43:44,917 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-19 10:43:44,947 INFO     pii_core: Sheet 'T_BANKS' validated (header row: 6, 23 data rows)
2026-01-19 10:43:44,947 INFO     pii_core: Processing 1 sheet(s)
2026-01-19 10:43:44,947 INFO     pii_core: Processing sheet 1/1: 'T_BANKS'
2026-01-19 10:43:44,947 INFO     pii_core: Phase 1: Rule-based classification
2026-01-19 10:43:44,950 INFO     pii_core: Rule-based: 3 PII, 2 non-PII, 18 ambiguous
2026-01-19 10:43:44,950 INFO     pii_core: Phase 2: Gemini API detection (18 fields)
2026-01-19 10:43:44,950 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:43:52,551 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:43:52,551 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:43:56,959 INFO     utils.gemini_client: Successfully processed batch with 6 rows
2026-01-19 10:43:56,993 INFO     pii_core: ================================================================================
2026-01-19 10:43:56,993 INFO     pii_core: COMPLETE: 3/23 PII fields found
2026-01-19 10:43:56,993 INFO     pii_core: ================================================================================
2026-01-19 10:43:57,002 INFO     __main__: Completed Banks and Branches-Template.xlsx: 3/23 PII fields detected
2026-01-19 10:43:57,002 INFO     __main__: Processing file 3/46: CMX_C_016 - Fixed Assets Conversion Specification (All Books).xlsx
2026-01-19 10:43:57,003 INFO     pii_core: ================================================================================
2026-01-19 10:43:57,004 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-19 10:43:57,005 INFO     pii_core: ================================================================================
2026-01-19 10:43:57,007 INFO     pii_core: Reading Excel file: 'CMX_C_016 - Fixed Assets Conversion Specification (All Books).xlsx'
2026-01-19 10:43:57,024 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-19 10:43:57,116 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-19 10:43:57,161 INFO     pii_core: Sheet 'FA_MASSADD_DIST' validated (header row: 6, 40 data rows)
2026-01-19 10:43:57,234 INFO     pii_core: Sheet 'FA_MASS_ADD' validated (header row: 6, 418 data rows)
2026-01-19 10:43:57,234 INFO     pii_core: Processing 2 sheet(s)
2026-01-19 10:43:57,234 INFO     pii_core: Processing sheet 1/2: 'FA_MASSADD_DIST'
2026-01-19 10:43:57,234 INFO     pii_core: Phase 1: Rule-based classification
2026-01-19 10:43:57,257 INFO     pii_core: Rule-based: 1 PII, 1 non-PII, 38 ambiguous
2026-01-19 10:43:57,258 INFO     pii_core: Phase 2: Gemini API detection (38 fields)
2026-01-19 10:43:57,268 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:44:04,027 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:44:04,027 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:44:04,369 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 55.05635262s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 55
}
]
2026-01-19 10:44:05,378 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:44:05,725 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 53.701802276s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 53
}
]
2026-01-19 10:44:07,741 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:44:08,078 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 51.348743356s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 51
}
]
2026-01-19 10:44:08,078 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:44:08,078 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:44:08,426 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 51.000070637s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 51
}
]
2026-01-19 10:44:09,441 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:44:09,774 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 49.649983071s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 49
}
]
2026-01-19 10:44:11,788 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:44:12,113 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 47.303911759s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 47
}
]
2026-01-19 10:44:12,130 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:44:12,130 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:44:12,468 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 46.967486877s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 46
}
]
2026-01-19 10:44:13,471 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:44:13,780 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 45.628874175s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 45
}
]
2026-01-19 10:44:15,794 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:44:16,138 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 43.300161944s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 43
}
]
2026-01-19 10:44:16,141 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:44:16,145 INFO     pii_core: Processing sheet 2/2: 'FA_MASS_ADD'
2026-01-19 10:44:16,147 INFO     pii_core: Phase 1: Rule-based classification
2026-01-19 10:44:16,220 INFO     pii_core: Rule-based: 2 PII, 7 non-PII, 409 ambiguous
2026-01-19 10:44:16,220 INFO     pii_core: Phase 2: Gemini API detection (409 fields)
2026-01-19 10:44:16,235 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:44:16,564 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 42.868039888s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 42
}
]
2026-01-19 10:44:17,573 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:44:17,895 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 41.523038961s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 41
}
]
2026-01-19 10:44:19,896 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:44:20,232 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 39.195868522s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 39
}
]
2026-01-19 10:44:20,234 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:44:20,234 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:44:20,561 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 38.855551259s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 38
}
]
2026-01-19 10:44:21,577 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:44:21,926 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 37.51111827s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 37
}
]
2026-01-19 10:44:23,931 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:44:24,262 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 35.162564712s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 35
}
]
2026-01-19 10:44:24,262 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:44:24,262 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:44:24,592 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 34.832030343s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 34
}
]
2026-01-19 10:44:25,609 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:44:25,959 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 33.477530299s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 33
}
]
2026-01-19 10:44:27,961 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:44:28,315 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 5, model: gemini-2.5-flash
Please retry in 31.134198s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 5
}
, retry_delay {
  seconds: 31
}
]
2026-01-19 10:44:28,316 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:44:28,316 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:44:34,080 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:44:34,081 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:44:39,538 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:44:39,538 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:44:45,863 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-19 10:44:45,864 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:44:46,213 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 13.226653529s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 13
}
]
2026-01-19 10:44:47,217 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:44:47,573 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 11.857227158s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 11
}
]
2026-01-19 10:44:49,579 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:44:49,932 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 9.513822967s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 9
}
]
2026-01-19 10:44:49,932 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:44:49,935 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:44:50,280 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 9.161792617s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 9
}
]
2026-01-19 10:44:51,282 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:44:51,602 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 7.82029285s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 7
}
]
2026-01-19 10:44:53,607 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:44:53,946 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 5.489846623s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 5
}
]
2026-01-19 10:44:53,946 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:44:53,946 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:44:54,277 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 5.149086551s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 5
}
]
2026-01-19 10:44:55,285 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:44:55,618 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 3.808915066s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 3
}
]
2026-01-19 10:44:57,624 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:44:57,953 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 1.470020343s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 1
}
]
2026-01-19 10:44:57,953 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:44:57,953 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:44:58,292 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 1.136166657s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 1
}
]
2026-01-19 10:44:59,304 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:44:59,660 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 59.787736154s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 59
}
]
2026-01-19 10:45:01,662 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:45:02,032 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 57.395426312s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 57
}
]
2026-01-19 10:45:02,034 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:45:02,034 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:45:02,359 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 57.063707361s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 57
}
]
2026-01-19 10:45:03,363 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:45:03,693 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 55.726791606s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 55
}
]
2026-01-19 10:45:05,708 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:45:06,063 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 53.381058738s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 53
}
]
2026-01-19 10:45:06,063 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:45:06,063 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:45:06,381 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 53.03238328s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 53
}
]
2026-01-19 10:45:07,383 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:45:07,726 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 51.703722947s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 51
}
]
2026-01-19 10:45:09,727 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:45:10,068 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 49.368926401s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 49
}
]
2026-01-19 10:45:10,068 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:45:10,075 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:45:10,404 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 49.016280973s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 49
}
]
2026-01-19 10:45:11,408 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:45:11,732 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 47.688455583s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 47
}
]
2026-01-19 10:45:13,737 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:45:14,062 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 45.352941495s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 45
}
]
2026-01-19 10:45:14,062 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:45:14,062 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:45:14,406 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 45.023588293s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 45
}
]
2026-01-19 10:45:15,408 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:45:15,737 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 43.677656191s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 43
}
]
2026-01-19 10:45:17,744 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:45:18,079 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 41.346269084s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 41
}
]
2026-01-19 10:45:18,079 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:45:18,081 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:45:18,420 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 41.008295868s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 41
}
]
2026-01-19 10:45:19,422 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:45:19,745 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 39.661057584s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 39
}
]
2026-01-19 10:45:21,762 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:45:22,111 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 37.325776776s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 37
}
]
2026-01-19 10:45:22,118 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:45:22,118 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:45:22,468 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 36.974860007s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 36
}
]
2026-01-19 10:45:23,470 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:45:23,823 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 35.62128375s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 35
}
]
2026-01-19 10:45:25,825 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:45:26,177 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 33.264736004s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 33
}
]
2026-01-19 10:45:26,177 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:45:26,178 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:45:26,515 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 32.914361198s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 32
}
]
2026-01-19 10:45:27,519 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:45:27,852 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 31.56857967s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 31
}
]
2026-01-19 10:45:29,854 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:45:30,181 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 29.246801743s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 29
}
]
2026-01-19 10:45:30,189 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:45:30,189 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:45:30,523 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 28.902672667s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 28
}
]
2026-01-19 10:45:31,524 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:45:31,866 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 27.553729467s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 27
}
]
2026-01-19 10:45:33,875 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:45:34,204 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 25.222073958s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 25
}
]
2026-01-19 10:45:34,214 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:45:34,214 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:45:34,541 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 24.885597419s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 24
}
]
2026-01-19 10:46:57,376 INFO     root: ================================================================================
2026-01-19 10:46:57,376 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-19 10:46:57,898 INFO     __main__: Connected to database.
2026-01-19 10:46:57,911 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:46:58,139 INFO     __main__: Connected to database.
2026-01-19 10:46:58,139 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-19 10:47:01,111 INFO     __main__: Connected to database.
2026-01-19 10:47:01,117 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:47:02,698 INFO     __main__: Connected to database.
2026-01-19 10:47:02,706 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:47:05,601 INFO     __main__: Connected to database.
2026-01-19 10:47:05,601 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:47:11,311 INFO     __main__: Connected to database.
2026-01-19 10:47:11,318 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:47:12,097 INFO     __main__: Connected to database.
2026-01-19 10:47:12,099 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:47:13,747 INFO     __main__: Connected to database.
2026-01-19 10:47:13,754 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:47:14,619 INFO     __main__: Connected to database.
2026-01-19 10:47:14,619 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:47:15,989 INFO     __main__: Connected to database.
2026-01-19 10:47:15,992 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:47:19,088 INFO     __main__: Connected to database.
2026-01-19 10:47:19,090 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:47:26,405 INFO     __main__: Connected to database.
2026-01-19 10:47:26,405 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:47:33,306 INFO     __main__: Connected to database.
2026-01-19 10:47:33,306 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:47:34,016 INFO     __main__: Connected to database.
2026-01-19 10:47:34,016 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-19 10:52:34,988 INFO     __main__: Filters: {'legacysystem': ['PeopleSoft'], 'targetsystem': ['Oracle Cloud'], 'projectname': [], 'domainname': ['Finance', 'Inventory'], 'subdomainname': ['Banks and Branches', 'Item Master', 'Purchase Order'], 'filename': []}
2026-01-19 10:52:35,064 INFO     __main__: Connected to database.
2026-01-19 10:52:35,064 INFO     __main__: Building projectid query with filters: {'legacysystem': ['PeopleSoft'], 'targetsystem': ['Oracle Cloud'], 'projectname': [], 'domainname': ['Finance', 'Inventory'], 'subdomainname': ['Banks and Branches', 'Item Master', 'Purchase Order'], 'filename': []}
2026-01-19 10:52:35,064 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND domainname IN (%s,%s) AND subdomainname IN (%s,%s,%s) Params: ['PeopleSoft', 'Oracle Cloud', 'Finance', 'Inventory', 'Banks and Branches', 'Item Master', 'Purchase Order']
2026-01-19 10:52:35,064 INFO     __main__: Retrieved 3 rows.
2026-01-19 10:52:35,064 INFO     __main__: Found 3 project IDs
2026-01-19 10:52:35,064 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s,%s,%s) Params: [31, 65, 69]
2026-01-19 10:52:35,232 INFO     __main__: Retrieved 2625 rows.
2026-01-19 10:52:35,232 INFO     __main__: Found 2625 child rows
2026-01-19 10:52:35,232 INFO     __main__: Normal processing (no transitivity)
2026-01-19 10:52:35,244 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-19 10:52:35,309 INFO     __main__: Exported summarized Excel file: Banks and Branches-Template.xlsx
2026-01-19 10:52:35,309 INFO     __main__: Generated mapping file: Banks and Branches-Template.xlsx
2026-01-19 10:52:36,265 INFO     __main__: Exported summarized Excel file: SCM-75A-Item Master-Mapping Specification.xlsx
2026-01-19 10:52:36,265 INFO     __main__: Generated mapping file: SCM-75A-Item Master-Mapping Specification.xlsx
2026-01-19 10:52:36,457 INFO     __main__: Exported summarized Excel file: SCM-79-Purchase Order-Mapping Specification.xlsx
2026-01-19 10:52:36,457 INFO     __main__: Generated mapping file: SCM-79-Purchase Order-Mapping Specification.xlsx
2026-01-19 10:52:36,465 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 3 files
2026-01-19 10:52:36,601 INFO     __main__: Connected to database.
2026-01-19 10:52:36,601 INFO     pii_core: Loading PII detection rules from database
2026-01-19 10:52:36,602 INFO     pii_database: Using provided database connection for PII rules
2026-01-19 10:52:36,602 INFO     pii_database: Loading PII detection rules from database
2026-01-19 10:52:36,617 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-19 10:52:36,618 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-19 10:52:36,618 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-19 10:52:36,619 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-19 10:52:36,620 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-19 10:52:36,621 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-19 10:52:36,621 INFO     __main__: Processing file 1/3: Banks and Branches-Template.xlsx
2026-01-19 10:52:36,622 INFO     pii_core: ================================================================================
2026-01-19 10:52:36,623 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-19 10:52:36,624 INFO     pii_core: ================================================================================
2026-01-19 10:52:36,625 INFO     pii_core: Reading Excel file: 'Banks and Branches-Template.xlsx'
2026-01-19 10:52:36,638 INFO     pii_core: Excel file has 2 sheet(s)
2026-01-19 10:52:36,705 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-19 10:52:36,758 INFO     pii_core: Sheet 'T_BANKS' validated (header row: 6, 23 data rows)
2026-01-19 10:52:36,758 INFO     pii_core: Processing 1 sheet(s)
2026-01-19 10:52:36,758 INFO     pii_core: Processing sheet 1/1: 'T_BANKS'
2026-01-19 10:52:36,759 INFO     pii_core: Phase 1: Rule-based classification
2026-01-19 10:52:36,763 INFO     pii_core: Rule-based: 3 PII, 2 non-PII, 18 ambiguous
2026-01-19 10:52:36,764 INFO     pii_core: Phase 2: Gemini API detection (18 fields)
2026-01-19 10:52:36,765 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:52:37,346 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 22.058958573s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 22
}
]
2026-01-19 10:52:38,360 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:52:38,692 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 20.718725981s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 20
}
]
2026-01-19 10:52:40,699 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:52:41,055 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 18.369376447s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 18
}
]
2026-01-19 10:52:41,058 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:52:41,058 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:52:41,394 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 18.020315642s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 18
}
]
2026-01-19 10:52:42,401 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:52:42,729 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 16.680920863s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 16
}
]
2026-01-19 10:52:44,734 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:52:45,060 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 14.351299026s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 14
}
]
2026-01-19 10:52:45,066 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:52:45,119 INFO     pii_core: ================================================================================
2026-01-19 10:52:45,119 INFO     pii_core: COMPLETE: 3/23 PII fields found
2026-01-19 10:52:45,119 INFO     pii_core: ================================================================================
2026-01-19 10:52:45,120 INFO     __main__: Completed Banks and Branches-Template.xlsx: 3/23 PII fields detected
2026-01-19 10:52:45,121 INFO     __main__: Processing file 2/3: SCM-75A-Item Master-Mapping Specification.xlsx
2026-01-19 10:52:45,123 INFO     pii_core: ================================================================================
2026-01-19 10:52:45,124 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-19 10:52:45,126 INFO     pii_core: ================================================================================
2026-01-19 10:52:45,128 INFO     pii_core: Reading Excel file: 'SCM-75A-Item Master-Mapping Specification.xlsx'
2026-01-19 10:52:45,144 INFO     pii_core: Excel file has 23 sheet(s)
2026-01-19 10:52:45,594 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-19 10:52:45,828 INFO     pii_core: Sheet 'EGO_ITEM_ASSOCIATIONS_INTF' validated (header row: 6, 15 data rows)
2026-01-19 10:52:46,033 INFO     pii_core: Sheet 'EGO_ITEM_INTF_EFF_B (Descr)' validated (header row: 6, 130 data rows)
2026-01-19 10:52:46,418 INFO     pii_core: Sheet 'EGO_ITEM_INTF_EFF_B (Ext Sys)' validated (header row: 6, 130 data rows)
2026-01-19 10:52:46,895 INFO     pii_core: Sheet 'EGO_ITEM_INTF_EFF_B (HCPCS)' validated (header row: 6, 130 data rows)
2026-01-19 10:52:47,395 INFO     pii_core: Sheet 'EGO_ITEM_INTF_EFF_B (Pat Chart)' validated (header row: 6, 130 data rows)
2026-01-19 10:52:47,875 INFO     pii_core: Sheet 'EGO_ITEM_INTF_EFF_B (Prod Det)' validated (header row: 6, 130 data rows)
2026-01-19 10:52:48,462 INFO     pii_core: Sheet 'EGO_ITEM_INTF_EFF_B (Reporting)' validated (header row: 6, 130 data rows)
2026-01-19 10:52:48,953 INFO     pii_core: Sheet 'EGO_ITEM_INTF_EFF_B(PurchPrice)' validated (header row: 6, 130 data rows)
2026-01-19 10:52:49,378 INFO     pii_core: Sheet 'EGO_ITEM_INTF_EFF_TL' validated (header row: 6, 52 data rows)
2026-01-19 10:52:49,841 INFO     pii_core: Sheet 'EGO_ITEM_REVISION_INTF_EFF_B' validated (header row: 6, 131 data rows)
2026-01-19 10:52:50,295 INFO     pii_core: Sheet 'EGO_ITEM_REVISION_INTF_EFF_TL' validated (header row: 6, 53 data rows)
2026-01-19 10:52:50,761 INFO     pii_core: Sheet 'EGO_ITEM_SUPPLIER_INTF_EFF_B' validated (header row: 6, 132 data rows)
2026-01-19 10:52:51,228 INFO     pii_core: Sheet 'EGO_ITEM_SUPPLIER_INTF_EFF_TL' validated (header row: 6, 54 data rows)
2026-01-19 10:52:51,658 INFO     pii_core: Sheet 'EGO_STYLE_VARIANT_ATTR_VS_INTF' validated (header row: 6, 8 data rows)
2026-01-19 10:52:52,145 INFO     pii_core: Sheet 'EGP_ITEM_ATTACHMENTS_INTF' validated (header row: 6, 146 data rows)
2026-01-19 10:52:52,622 INFO     pii_core: Sheet 'EGP_ITEM_CATEGORIES (Report)' validated (header row: 6, 12 data rows)
2026-01-19 10:52:53,061 INFO     pii_core: Sheet 'EGP_ITEM_CATEGORIES (TC)' validated (header row: 6, 12 data rows)
2026-01-19 10:52:53,473 INFO     pii_core: Sheet 'EGP_ITEM_RELATIONSHIPS (MASTER)' validated (header row: 6, 79 data rows)
2026-01-19 10:52:53,895 INFO     pii_core: Sheet 'EGP_ITEM_RELATIONSHIPS (ORG)' validated (header row: 6, 79 data rows)
2026-01-19 10:52:54,357 INFO     pii_core: Sheet 'EGP_ITEM_REVISIONS_INTERFACE' validated (header row: 6, 49 data rows)
2026-01-19 10:52:55,020 INFO     pii_core: Sheet 'EGP_SYSTEM_ITEMS_INTERFACE' validated (header row: 6, 389 data rows)
2026-01-19 10:52:55,520 INFO     pii_core: Sheet 'EGP_TRADING_PARTNER_ITEMS_INTF' validated (header row: 6, 65 data rows)
2026-01-19 10:52:55,520 INFO     pii_core: Processing 22 sheet(s)
2026-01-19 10:52:55,520 INFO     pii_core: Processing sheet 1/22: 'EGO_ITEM_ASSOCIATIONS_INTF'
2026-01-19 10:52:55,520 INFO     pii_core: Phase 1: Rule-based classification
2026-01-19 10:52:55,534 INFO     pii_core: Rule-based: 0 PII, 0 non-PII, 15 ambiguous
2026-01-19 10:52:55,534 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-19 10:52:55,538 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:52:55,896 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 3.522942218s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 3
}
]
2026-01-19 10:52:56,898 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:52:57,248 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 2.158948951s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 2
}
]
2026-01-19 10:52:59,254 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:52:59,602 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 59.812134165s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 59
}
]
2026-01-19 10:52:59,602 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:52:59,602 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:52:59,943 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 59.47186253s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 59
}
]
2026-01-19 10:53:00,947 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:53:01,293 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 58.129960514s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 58
}
]
2026-01-19 10:53:03,295 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:53:03,628 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 55.78734925s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 55
}
]
2026-01-19 10:53:03,636 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:53:03,641 INFO     pii_core: Processing sheet 2/22: 'EGO_ITEM_INTF_EFF_B (Descr)'
2026-01-19 10:53:03,644 INFO     pii_core: Phase 1: Rule-based classification
2026-01-19 10:53:03,714 INFO     pii_core: Rule-based: 0 PII, 0 non-PII, 130 ambiguous
2026-01-19 10:53:03,714 INFO     pii_core: Phase 2: Gemini API detection (130 fields)
2026-01-19 10:53:03,739 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:53:04,080 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 55.338454493s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 55
}
]
2026-01-19 10:53:05,081 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:53:05,411 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 54.002707512s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 54
}
]
2026-01-19 10:53:07,421 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:53:07,763 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 51.657708519s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 51
}
]
2026-01-19 10:53:07,764 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:53:07,764 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:53:08,099 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 51.303193037s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 51
}
]
2026-01-19 10:53:09,106 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:53:09,441 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 49.969658083s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 49
}
]
2026-01-19 10:53:11,446 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:53:11,776 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 47.625629191s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 47
}
]
2026-01-19 10:53:11,792 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:53:11,792 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:53:12,139 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 47.279386501s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 47
}
]
2026-01-19 10:53:13,141 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:53:13,474 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 45.928049681s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 45
}
]
2026-01-19 10:53:15,475 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:53:15,810 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 43.596954579s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 43
}
]
2026-01-19 10:53:15,810 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:53:15,810 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:53:16,143 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 43.258194273s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 43
}
]
2026-01-19 10:53:17,144 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-19 10:53:17,460 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 41.939501761s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 41
}
]
2026-01-19 10:53:19,466 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-19 10:53:19,812 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 39.609740283s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 39
}
]
2026-01-19 10:53:19,814 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-19 10:53:19,815 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-19 10:53:20,144 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 39.263438562s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 39
}
]
2026-01-20 15:40:22,258 INFO     root: ================================================================================
2026-01-20 15:40:22,258 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-20 15:40:22,839 INFO     __main__: Connected to database.
2026-01-20 15:40:22,949 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 15:40:23,401 INFO     __main__: Connected to database.
2026-01-20 15:40:23,410 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-20 15:40:37,160 INFO     __main__: Connected to database.
2026-01-20 15:40:37,160 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 15:40:39,043 INFO     __main__: Connected to database.
2026-01-20 15:40:39,051 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 15:40:44,407 INFO     __main__: Connected to database.
2026-01-20 15:40:44,413 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 15:40:46,391 INFO     __main__: Connected to database.
2026-01-20 15:40:46,391 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 15:40:47,382 INFO     __main__: Connected to database.
2026-01-20 15:40:47,383 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 15:40:52,878 INFO     __main__: Connected to database.
2026-01-20 15:40:52,882 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 15:40:54,167 INFO     __main__: Connected to database.
2026-01-20 15:40:54,173 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 15:40:55,806 INFO     __main__: Connected to database.
2026-01-20 15:40:55,808 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 15:40:56,906 INFO     __main__: Connected to database.
2026-01-20 15:40:56,909 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 15:41:01,822 INFO     __main__: Connected to database.
2026-01-20 15:41:01,826 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 15:41:09,440 INFO     __main__: Connected to database.
2026-01-20 15:41:09,440 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 15:45:32,195 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-20 15:45:32,304 INFO     __main__: Connected to database.
2026-01-20 15:45:32,304 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-20 15:45:32,304 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-20 15:45:32,315 INFO     __main__: Retrieved 1 rows.
2026-01-20 15:45:32,315 INFO     __main__: Found 1 project IDs
2026-01-20 15:45:32,315 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-20 15:45:32,451 INFO     __main__: Retrieved 49 rows.
2026-01-20 15:45:32,467 INFO     __main__: Found 49 child rows
2026-01-20 15:45:32,467 INFO     __main__: Normal processing (no transitivity)
2026-01-20 15:45:32,655 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-20 15:48:16,181 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-20 15:48:16,282 INFO     __main__: Connected to database.
2026-01-20 15:48:16,282 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-20 15:48:16,282 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-20 15:48:16,290 INFO     __main__: Retrieved 1 rows.
2026-01-20 15:48:16,290 INFO     __main__: Found 1 project IDs
2026-01-20 15:48:16,290 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-20 15:48:16,316 INFO     __main__: Retrieved 49 rows.
2026-01-20 15:48:16,317 INFO     __main__: Found 49 child rows
2026-01-20 15:48:16,317 INFO     __main__: Normal processing (no transitivity)
2026-01-20 15:48:16,317 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-20 15:48:16,365 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-20 15:48:16,365 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-20 15:48:16,366 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-20 16:53:17,268 INFO     root: ================================================================================
2026-01-20 16:53:17,268 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-20 16:53:17,799 INFO     __main__: Connected to database.
2026-01-20 16:53:17,858 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 16:53:18,333 INFO     __main__: Connected to database.
2026-01-20 16:53:18,333 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-20 16:53:23,299 INFO     __main__: Connected to database.
2026-01-20 16:53:23,299 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 16:53:24,392 INFO     __main__: Connected to database.
2026-01-20 16:53:24,396 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 16:53:25,611 INFO     __main__: Connected to database.
2026-01-20 16:53:25,611 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 16:53:27,377 INFO     __main__: Connected to database.
2026-01-20 16:53:27,383 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 16:53:27,860 INFO     __main__: Connected to database.
2026-01-20 16:53:27,860 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 16:53:29,260 INFO     __main__: Connected to database.
2026-01-20 16:53:29,270 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 16:53:29,721 INFO     __main__: Connected to database.
2026-01-20 16:53:29,721 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 16:53:30,661 INFO     __main__: Connected to database.
2026-01-20 16:53:30,661 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 16:53:32,275 INFO     __main__: Connected to database.
2026-01-20 16:53:32,275 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-20 16:54:06,519 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-20 16:54:06,627 INFO     __main__: Connected to database.
2026-01-20 16:54:06,627 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-20 16:54:06,628 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-20 16:54:06,628 INFO     __main__: Retrieved 1 rows.
2026-01-20 16:54:06,628 INFO     __main__: Found 1 project IDs
2026-01-20 16:54:06,628 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-20 16:54:06,714 INFO     __main__: Retrieved 49 rows.
2026-01-20 16:54:06,715 INFO     __main__: Found 49 child rows
2026-01-20 16:54:06,715 INFO     __main__: Normal processing (no transitivity)
2026-01-20 16:54:06,716 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-20 16:54:06,923 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-20 16:54:06,923 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-20 16:54:06,923 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-20 16:54:06,923 INFO     __main__: Custom rule extracted from Generate Mapping tab:
2026-01-20 16:54:06,923 INFO     __main__:   Patterns: 1
2026-01-20 16:54:06,923 INFO     __main__:   Scope: tablename
2026-01-20 16:54:06,923 INFO     __main__:   Action: PII
2026-01-20 16:54:06,923 INFO     __main__:   PII Type: Custom_PII
2026-01-20 16:54:06,939 INFO     __main__: Custom rules detected from Generate Mapping tab: 1 rule(s)
2026-01-20 16:54:07,009 INFO     __main__: Connected to database.
2026-01-20 16:54:07,009 INFO     pii_core: Loading PII detection rules from database
2026-01-20 16:54:07,010 INFO     pii_database: Using provided database connection for PII rules
2026-01-20 16:54:07,010 INFO     pii_database: Loading PII detection rules from database
2026-01-20 16:54:07,025 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-20 16:54:07,025 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-20 16:54:07,025 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-20 16:54:07,025 INFO     pii_core:   Rule: 1 patterns, Scope=tablename, Action=PII, Type=Custom_PII
2026-01-20 16:54:07,025 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-20 16:54:07,025 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-20 16:54:07,025 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-20 16:54:07,025 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-20 16:54:07,025 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-20 16:54:07,025 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-20 16:54:07,025 INFO     pii_core: ================================================================================
2026-01-20 16:54:07,025 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-20 16:54:07,025 INFO     pii_core: ================================================================================
2026-01-20 16:54:07,025 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-20 16:54:07,041 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-20 16:54:07,117 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-20 16:54:07,130 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-20 16:54:07,245 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-20 16:54:07,245 INFO     pii_core: Processing 1 sheet(s)
2026-01-20 16:54:07,245 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-20 16:54:07,245 INFO     pii_core: Phase 1: Rule-based classification
2026-01-20 16:54:07,265 INFO     pii_core: Rule-based: 2 PII, 2 non-PII, 26 ambiguous
2026-01-20 16:54:07,266 INFO     pii_core: Phase 2: Gemini API detection (26 fields)
2026-01-20 16:54:07,270 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-20 16:54:13,842 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-20 16:54:13,842 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-20 16:54:24,376 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-20 16:54:24,390 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-20 16:54:29,013 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-20 16:54:29,078 INFO     pii_core: ================================================================================
2026-01-20 16:54:29,078 INFO     pii_core: COMPLETE: 2/30 PII fields found
2026-01-20 16:54:29,078 INFO     pii_core: ================================================================================
2026-01-20 16:54:29,078 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 2/30 PII fields detected
2026-01-20 16:54:35,678 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-20 16:54:35,678 WARNING  __main__: Could not delete CNV24 - ElementEntry.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV24 - ElementEntry.xlsx'
2026-01-20 16:54:35,678 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-20 17:29:20,746 INFO     __main__: Custom rule extracted from PII Field tab:
2026-01-20 17:29:20,746 INFO     __main__:   Patterns: 1
2026-01-20 17:29:20,746 INFO     __main__:   Scope: fieldname
2026-01-20 17:29:20,746 INFO     __main__:   Action: PII
2026-01-20 17:29:20,760 INFO     __main__:   PII Type: Custom_PII
2026-01-20 17:29:20,762 INFO     __main__: Custom rules detected: 1 rule(s)
2026-01-20 17:29:20,844 INFO     __main__: Connected to database.
2026-01-20 17:29:20,844 INFO     pii_core: Loading PII detection rules from database
2026-01-20 17:29:20,844 INFO     pii_database: Using provided database connection for PII rules
2026-01-20 17:29:20,844 INFO     pii_database: Loading PII detection rules from database
2026-01-20 17:29:20,844 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-20 17:29:20,844 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-20 17:29:20,844 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-20 17:29:20,844 INFO     pii_core:   Rule: 1 patterns, Scope=fieldname, Action=PII, Type=Custom_PII
2026-01-20 17:29:20,844 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-20 17:29:20,861 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-20 17:29:20,861 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-20 17:29:20,861 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-20 17:29:20,861 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-20 17:29:20,861 INFO     pii_core: ================================================================================
2026-01-20 17:29:20,861 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-20 17:29:20,861 INFO     pii_core: ================================================================================
2026-01-20 17:29:20,861 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-20 17:29:20,876 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-20 17:29:20,982 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-20 17:29:21,010 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-20 17:29:21,106 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-20 17:29:21,110 INFO     pii_core: Processing 1 sheet(s)
2026-01-20 17:29:21,111 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-20 17:29:21,114 INFO     pii_core: Phase 1: Rule-based classification
2026-01-20 17:29:21,128 INFO     pii_core: Rule-based: 3 PII, 1 non-PII, 26 ambiguous
2026-01-20 17:29:21,129 INFO     pii_core: Phase 2: Gemini API detection (26 fields)
2026-01-20 17:29:21,133 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-20 17:29:43,667 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-20 17:29:43,667 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-20 17:30:03,222 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-20 17:30:03,222 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-20 17:30:07,867 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-20 17:30:07,926 INFO     pii_core: ================================================================================
2026-01-20 17:30:07,942 INFO     pii_core: COMPLETE: 3/30 PII fields found
2026-01-20 17:30:07,943 INFO     pii_core: ================================================================================
2026-01-21 10:28:29,160 INFO     root: ================================================================================
2026-01-21 10:28:29,160 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 10:28:29,815 INFO     __main__: Connected to database.
2026-01-21 10:28:29,901 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 10:28:30,355 INFO     __main__: Connected to database.
2026-01-21 10:28:30,359 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 10:28:34,847 INFO     __main__: Connected to database.
2026-01-21 10:28:34,852 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 10:28:36,117 INFO     __main__: Connected to database.
2026-01-21 10:28:36,117 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 10:28:37,783 INFO     __main__: Connected to database.
2026-01-21 10:28:37,783 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 10:28:38,837 INFO     __main__: Connected to database.
2026-01-21 10:28:38,837 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 10:28:40,955 INFO     __main__: Connected to database.
2026-01-21 10:28:40,971 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 10:28:41,975 INFO     __main__: Connected to database.
2026-01-21 10:28:41,981 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 10:29:54,572 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': ['CNV24 - ElementEntry']}
2026-01-21 10:29:54,648 INFO     __main__: Connected to database.
2026-01-21 10:29:54,648 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': ['CNV24 - ElementEntry']}
2026-01-21 10:29:54,648 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) AND filename IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry', 'CNV24 - ElementEntry']
2026-01-21 10:29:54,648 INFO     __main__: Retrieved 1 rows.
2026-01-21 10:29:54,648 INFO     __main__: Found 1 project IDs
2026-01-21 10:29:54,648 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-21 10:29:54,746 INFO     __main__: Retrieved 49 rows.
2026-01-21 10:29:54,747 INFO     __main__: Found 49 child rows
2026-01-21 10:29:54,747 INFO     __main__: Normal processing (no transitivity)
2026-01-21 10:29:54,749 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-21 10:31:24,416 ERROR    __main__: Mapping generation error: [Errno 13] Permission denied: 'CNV24 - ElementEntry.xlsx'
Traceback (most recent call last):
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 5700, in run
    export_summarized_excel(grp.to_dict("records"), fname)
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 514, in export_summarized_excel
    wb.save(filename)
  File "C:\Users\L10319\AppData\Local\Programs\Python\Python311\Lib\site-packages\openpyxl\workbook\workbook.py", line 386, in save
    save_workbook(self, filename)
  File "C:\Users\L10319\AppData\Local\Programs\Python\Python311\Lib\site-packages\openpyxl\writer\excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\L10319\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1294, in __init__
    self.fp = io.open(file, filemode)
              ^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'CNV24 - ElementEntry.xlsx'
2026-01-21 10:31:25,497 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': ['CNV24 - ElementEntry']}
2026-01-21 10:31:25,564 INFO     __main__: Connected to database.
2026-01-21 10:31:25,564 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': ['CNV24 - ElementEntry']}
2026-01-21 10:31:25,564 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) AND filename IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry', 'CNV24 - ElementEntry']
2026-01-21 10:31:25,564 INFO     __main__: Retrieved 1 rows.
2026-01-21 10:31:25,564 INFO     __main__: Found 1 project IDs
2026-01-21 10:31:25,564 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-21 10:31:25,595 INFO     __main__: Retrieved 49 rows.
2026-01-21 10:31:25,595 INFO     __main__: Found 49 child rows
2026-01-21 10:31:25,596 INFO     __main__: Normal processing (no transitivity)
2026-01-21 10:31:25,596 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-21 10:31:27,896 ERROR    __main__: Mapping generation error: [Errno 13] Permission denied: 'CNV24 - ElementEntry.xlsx'
Traceback (most recent call last):
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 5700, in run
    export_summarized_excel(grp.to_dict("records"), fname)
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 514, in export_summarized_excel
    wb.save(filename)
  File "C:\Users\L10319\AppData\Local\Programs\Python\Python311\Lib\site-packages\openpyxl\workbook\workbook.py", line 386, in save
    save_workbook(self, filename)
  File "C:\Users\L10319\AppData\Local\Programs\Python\Python311\Lib\site-packages\openpyxl\writer\excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\L10319\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1294, in __init__
    self.fp = io.open(file, filemode)
              ^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'CNV24 - ElementEntry.xlsx'
2026-01-21 10:31:39,182 INFO     root: ================================================================================
2026-01-21 10:31:39,182 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 10:31:39,677 INFO     __main__: Connected to database.
2026-01-21 10:31:39,691 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 10:31:40,079 INFO     __main__: Connected to database.
2026-01-21 10:31:40,080 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 10:31:42,621 INFO     __main__: Connected to database.
2026-01-21 10:31:42,621 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 10:31:43,813 INFO     __main__: Connected to database.
2026-01-21 10:31:43,813 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 10:31:45,356 INFO     __main__: Connected to database.
2026-01-21 10:31:45,356 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 10:31:46,363 INFO     __main__: Connected to database.
2026-01-21 10:31:46,363 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 10:31:47,972 INFO     __main__: Connected to database.
2026-01-21 10:31:47,972 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 10:32:02,120 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 10:32:02,201 INFO     __main__: Connected to database.
2026-01-21 10:32:02,201 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 10:32:02,201 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-21 10:32:02,201 INFO     __main__: Retrieved 1 rows.
2026-01-21 10:32:02,201 INFO     __main__: Found 1 project IDs
2026-01-21 10:32:02,201 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-21 10:32:02,238 INFO     __main__: Retrieved 49 rows.
2026-01-21 10:32:02,238 INFO     __main__: Found 49 child rows
2026-01-21 10:32:02,238 INFO     __main__: Normal processing (no transitivity)
2026-01-21 10:32:02,238 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-21 10:32:21,987 ERROR    __main__: Mapping generation error: [Errno 13] Permission denied: 'CNV24 - ElementEntry.xlsx'
Traceback (most recent call last):
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 5700, in run
    export_summarized_excel(grp.to_dict("records"), fname)
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 514, in export_summarized_excel
    wb.save(filename)
  File "C:\Users\L10319\AppData\Local\Programs\Python\Python311\Lib\site-packages\openpyxl\workbook\workbook.py", line 386, in save
    save_workbook(self, filename)
  File "C:\Users\L10319\AppData\Local\Programs\Python\Python311\Lib\site-packages\openpyxl\writer\excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\L10319\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1294, in __init__
    self.fp = io.open(file, filemode)
              ^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'CNV24 - ElementEntry.xlsx'
2026-01-21 10:32:28,844 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 10:32:29,008 INFO     __main__: Connected to database.
2026-01-21 10:32:29,009 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 10:32:29,010 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-21 10:32:29,018 INFO     __main__: Retrieved 1 rows.
2026-01-21 10:32:29,019 INFO     __main__: Found 1 project IDs
2026-01-21 10:32:29,020 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-21 10:32:29,086 INFO     __main__: Retrieved 49 rows.
2026-01-21 10:32:29,087 INFO     __main__: Found 49 child rows
2026-01-21 10:32:29,087 INFO     __main__: Normal processing (no transitivity)
2026-01-21 10:32:29,089 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-21 10:33:27,345 ERROR    __main__: Mapping generation error: [Errno 13] Permission denied: 'CNV24 - ElementEntry.xlsx'
Traceback (most recent call last):
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 5700, in run
    export_summarized_excel(grp.to_dict("records"), fname)
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 514, in export_summarized_excel
    wb.save(filename)
  File "C:\Users\L10319\AppData\Local\Programs\Python\Python311\Lib\site-packages\openpyxl\workbook\workbook.py", line 386, in save
    save_workbook(self, filename)
  File "C:\Users\L10319\AppData\Local\Programs\Python\Python311\Lib\site-packages\openpyxl\writer\excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\L10319\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1294, in __init__
    self.fp = io.open(file, filemode)
              ^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'CNV24 - ElementEntry.xlsx'
2026-01-21 10:33:28,171 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 10:33:28,397 INFO     __main__: Connected to database.
2026-01-21 10:33:28,398 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 10:33:28,398 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-21 10:33:28,406 INFO     __main__: Retrieved 1 rows.
2026-01-21 10:33:28,406 INFO     __main__: Found 1 project IDs
2026-01-21 10:33:28,407 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-21 10:33:28,453 INFO     __main__: Retrieved 49 rows.
2026-01-21 10:33:28,453 INFO     __main__: Found 49 child rows
2026-01-21 10:33:28,453 INFO     __main__: Normal processing (no transitivity)
2026-01-21 10:33:28,453 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-21 10:33:28,531 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-21 10:33:28,531 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-21 10:33:28,531 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-21 10:33:28,531 INFO     __main__: Custom rule extracted from Generate Mapping tab:
2026-01-21 10:33:28,531 INFO     __main__:   Patterns: 1
2026-01-21 10:33:28,543 INFO     __main__:   Scope: fieldname
2026-01-21 10:33:28,545 INFO     __main__:   Action: PII
2026-01-21 10:33:28,545 INFO     __main__:   PII Type: Custom_PII
2026-01-21 10:33:28,545 INFO     __main__: Custom rules detected from Generate Mapping tab: 1 rule(s)
2026-01-21 10:33:28,659 INFO     __main__: Connected to database.
2026-01-21 10:33:28,659 INFO     pii_core: Loading PII detection rules from database
2026-01-21 10:33:28,660 INFO     pii_database: Using provided database connection for PII rules
2026-01-21 10:33:28,660 INFO     pii_database: Loading PII detection rules from database
2026-01-21 10:33:28,674 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-21 10:33:28,674 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-21 10:33:28,674 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-21 10:33:28,674 INFO     pii_core:   Rule: 1 patterns, Scope=fieldname, Action=PII, Type=Custom_PII
2026-01-21 10:33:28,674 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-21 10:33:28,674 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-21 10:33:28,674 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-21 10:33:28,674 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-21 10:33:28,676 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-21 10:33:28,676 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-21 10:33:28,676 INFO     pii_core: ================================================================================
2026-01-21 10:33:28,676 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-21 10:33:28,679 INFO     pii_core: ================================================================================
2026-01-21 10:33:28,679 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-21 10:33:28,692 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-21 10:33:28,940 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-21 10:33:28,964 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-21 10:33:29,009 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-21 10:33:29,010 INFO     pii_core: Processing 1 sheet(s)
2026-01-21 10:33:29,010 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-21 10:33:29,012 INFO     pii_core: Phase 1: Rule-based classification
2026-01-21 10:33:29,020 INFO     pii_core: Rule-based: 3 PII, 1 non-PII, 26 ambiguous
2026-01-21 10:33:29,020 INFO     pii_core: Phase 2: Gemini API detection (26 fields)
2026-01-21 10:33:29,023 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 10:33:34,798 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 10:33:34,806 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 10:33:40,965 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 10:33:40,965 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 10:33:44,617 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-21 10:33:44,696 INFO     pii_core: ================================================================================
2026-01-21 10:33:44,696 INFO     pii_core: COMPLETE: 3/30 PII fields found
2026-01-21 10:33:44,696 INFO     pii_core: ================================================================================
2026-01-21 10:33:44,696 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 3/30 PII fields detected
2026-01-21 10:33:56,914 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-21 10:33:56,914 WARNING  __main__: Could not delete CNV24 - ElementEntry.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV24 - ElementEntry.xlsx'
2026-01-21 10:33:56,928 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-21 10:35:54,622 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 10:35:54,737 INFO     __main__: Connected to database.
2026-01-21 10:35:54,737 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 10:35:54,739 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-21 10:35:54,744 INFO     __main__: Retrieved 1 rows.
2026-01-21 10:35:54,745 INFO     __main__: Found 1 project IDs
2026-01-21 10:35:54,745 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-21 10:35:54,797 INFO     __main__: Retrieved 49 rows.
2026-01-21 10:35:54,797 INFO     __main__: Found 49 child rows
2026-01-21 10:35:54,797 INFO     __main__: Normal processing (no transitivity)
2026-01-21 10:35:54,797 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-21 10:35:55,003 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-21 10:35:55,003 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-21 10:35:55,015 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-21 10:35:55,032 INFO     __main__: Custom rule extracted from Generate Mapping tab:
2026-01-21 10:35:55,032 INFO     __main__:   Patterns: 4
2026-01-21 10:35:55,035 INFO     __main__:   Scope: fieldname
2026-01-21 10:35:55,035 INFO     __main__:   Action: PII
2026-01-21 10:35:55,035 INFO     __main__:   PII Type: Custom_PII
2026-01-21 10:35:55,037 INFO     __main__: Custom rules detected from Generate Mapping tab: 1 rule(s)
2026-01-21 10:35:55,181 INFO     __main__: Connected to database.
2026-01-21 10:35:55,182 INFO     pii_core: Loading PII detection rules from database
2026-01-21 10:35:55,182 INFO     pii_database: Using provided database connection for PII rules
2026-01-21 10:35:55,182 INFO     pii_database: Loading PII detection rules from database
2026-01-21 10:35:55,195 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-21 10:35:55,200 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-21 10:35:55,200 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-21 10:35:55,200 INFO     pii_core:   Rule: 4 patterns, Scope=fieldname, Action=PII, Type=Custom_PII
2026-01-21 10:35:55,200 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-21 10:35:55,200 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-21 10:35:55,200 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-21 10:35:55,205 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-21 10:35:55,205 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-21 10:35:55,205 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-21 10:35:55,205 INFO     pii_core: ================================================================================
2026-01-21 10:35:55,205 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-21 10:35:55,205 INFO     pii_core: ================================================================================
2026-01-21 10:35:55,207 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-21 10:35:55,221 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-21 10:35:55,309 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-21 10:35:55,326 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-21 10:35:55,426 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-21 10:35:55,426 INFO     pii_core: Processing 1 sheet(s)
2026-01-21 10:35:55,426 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-21 10:35:55,426 INFO     pii_core: Phase 1: Rule-based classification
2026-01-21 10:35:55,442 INFO     pii_core: Rule-based: 4 PII, 0 non-PII, 26 ambiguous
2026-01-21 10:35:55,442 INFO     pii_core: Phase 2: Gemini API detection (26 fields)
2026-01-21 10:35:55,442 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 10:36:03,545 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 10:36:03,546 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 10:36:09,176 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 10:36:09,176 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 10:36:13,776 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-21 10:36:13,914 INFO     pii_core: ================================================================================
2026-01-21 10:36:13,914 INFO     pii_core: COMPLETE: 4/30 PII fields found
2026-01-21 10:36:13,914 INFO     pii_core: ================================================================================
2026-01-21 10:36:13,923 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 4/30 PII fields detected
2026-01-21 10:46:38,788 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-21 10:46:38,790 WARNING  __main__: Could not delete CNV24 - ElementEntry.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV24 - ElementEntry.xlsx'
2026-01-21 10:46:38,790 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-21 11:43:43,783 INFO     __main__: Custom rule extracted from PII Field tab:
2026-01-21 11:43:43,787 INFO     __main__:   Patterns: 4
2026-01-21 11:43:43,787 INFO     __main__:   Scope: fieldname
2026-01-21 11:43:43,787 INFO     __main__:   Action: PII
2026-01-21 11:43:43,787 INFO     __main__:   PII Type: Custom_PII
2026-01-21 11:43:43,787 INFO     __main__: Custom rules detected: 1 rule(s)
2026-01-21 11:43:43,883 INFO     __main__: Connected to database.
2026-01-21 11:43:43,883 INFO     pii_core: Loading PII detection rules from database
2026-01-21 11:43:43,883 INFO     pii_database: Using provided database connection for PII rules
2026-01-21 11:43:43,883 INFO     pii_database: Loading PII detection rules from database
2026-01-21 11:43:43,917 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-21 11:43:43,917 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-21 11:43:43,917 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-21 11:43:43,917 INFO     pii_core:   Rule: 4 patterns, Scope=fieldname, Action=PII, Type=Custom_PII
2026-01-21 11:43:43,917 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-21 11:43:43,917 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-21 11:43:43,917 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-21 11:43:43,917 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-21 11:43:43,917 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-21 11:43:43,917 INFO     pii_core: ================================================================================
2026-01-21 11:43:43,917 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-21 11:43:43,933 INFO     pii_core: ================================================================================
2026-01-21 11:43:43,934 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-21 11:43:43,951 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-21 11:43:44,046 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-21 11:43:44,062 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-21 11:43:44,164 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-21 11:43:44,164 INFO     pii_core: Processing 1 sheet(s)
2026-01-21 11:43:44,164 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-21 11:43:44,166 INFO     pii_core: Phase 1: Rule-based classification
2026-01-21 11:43:44,176 INFO     pii_core: Rule-based: 4 PII, 0 non-PII, 26 ambiguous
2026-01-21 11:43:44,176 INFO     pii_core: Phase 2: Gemini API detection (26 fields)
2026-01-21 11:43:44,185 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 11:43:49,932 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 11:43:49,932 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 11:43:55,281 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 11:43:55,281 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 11:44:00,772 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-21 11:44:00,834 INFO     pii_core: ================================================================================
2026-01-21 11:44:00,834 INFO     pii_core: COMPLETE: 4/30 PII fields found
2026-01-21 11:44:00,834 INFO     pii_core: ================================================================================
2026-01-21 11:47:26,532 INFO     root: ================================================================================
2026-01-21 11:47:26,532 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 11:47:27,078 INFO     __main__: Connected to database.
2026-01-21 11:47:27,102 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 11:47:27,401 INFO     __main__: Connected to database.
2026-01-21 11:47:27,406 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 11:47:30,166 INFO     __main__: Connected to database.
2026-01-21 11:47:30,168 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 11:47:31,699 INFO     __main__: Connected to database.
2026-01-21 11:47:31,706 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 11:47:33,057 INFO     __main__: Connected to database.
2026-01-21 11:47:33,066 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 11:47:34,398 INFO     __main__: Connected to database.
2026-01-21 11:47:34,401 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 11:47:36,122 INFO     __main__: Connected to database.
2026-01-21 11:47:36,122 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 11:47:38,165 INFO     __main__: Connected to database.
2026-01-21 11:47:38,167 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 11:49:10,539 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': ['CNV24 - ElementEntry']}
2026-01-21 11:49:10,639 INFO     __main__: Connected to database.
2026-01-21 11:49:10,639 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': ['CNV24 - ElementEntry']}
2026-01-21 11:49:10,639 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) AND filename IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry', 'CNV24 - ElementEntry']
2026-01-21 11:49:10,647 INFO     __main__: Retrieved 1 rows.
2026-01-21 11:49:10,647 INFO     __main__: Found 1 project IDs
2026-01-21 11:49:10,647 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-21 11:49:10,759 INFO     __main__: Retrieved 49 rows.
2026-01-21 11:49:10,760 INFO     __main__: Found 49 child rows
2026-01-21 11:49:10,760 INFO     __main__: Normal processing (no transitivity)
2026-01-21 11:49:10,761 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-21 11:49:10,900 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-21 11:49:10,900 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-21 11:49:10,903 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-21 11:49:10,908 INFO     __main__: Custom rule extracted from Generate Mapping tab:
2026-01-21 11:49:10,909 INFO     __main__:   Patterns: 5
2026-01-21 11:49:10,909 INFO     __main__:   Scope: fieldname
2026-01-21 11:49:10,909 INFO     __main__:   Action: PII
2026-01-21 11:49:10,909 INFO     __main__:   PII Type: Custom_PII
2026-01-21 11:49:10,910 INFO     __main__: Custom rules detected from Generate Mapping tab: 1 rule(s)
2026-01-21 11:49:11,124 INFO     __main__: Connected to database.
2026-01-21 11:49:11,124 INFO     pii_core: Loading PII detection rules from database
2026-01-21 11:49:11,126 INFO     pii_database: Using provided database connection for PII rules
2026-01-21 11:49:11,126 INFO     pii_database: Loading PII detection rules from database
2026-01-21 11:49:11,126 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-21 11:49:11,126 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-21 11:49:11,126 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-21 11:49:11,126 INFO     pii_core:   Rule: 5 patterns, Scope=fieldname, Action=PII, Type=Custom_PII
2026-01-21 11:49:11,126 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-21 11:49:11,126 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-21 11:49:11,126 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-21 11:49:11,126 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-21 11:49:11,126 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-21 11:49:11,142 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-21 11:49:11,143 INFO     pii_core: ================================================================================
2026-01-21 11:49:11,143 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-21 11:49:11,143 INFO     pii_core: ================================================================================
2026-01-21 11:49:11,143 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-21 11:49:11,164 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-21 11:49:11,245 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-21 11:49:11,261 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-21 11:49:11,393 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-21 11:49:11,393 INFO     pii_core: Processing 1 sheet(s)
2026-01-21 11:49:11,393 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-21 11:49:11,406 INFO     pii_core: Phase 1: Rule-based classification
2026-01-21 11:49:11,425 INFO     pii_core: Rule-based: 11 PII, 5 non-PII, 14 ambiguous
2026-01-21 11:49:11,425 INFO     pii_core: Phase 2: Gemini API detection (14 fields)
2026-01-21 11:49:11,429 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 11:49:17,110 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 11:49:17,110 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 11:49:21,610 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-21 11:49:21,681 INFO     pii_core: ================================================================================
2026-01-21 11:49:21,682 INFO     pii_core: COMPLETE: 11/30 PII fields found
2026-01-21 11:49:21,682 INFO     pii_core: ================================================================================
2026-01-21 11:49:21,682 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 11/30 PII fields detected
2026-01-21 11:49:32,047 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-21 11:49:32,047 WARNING  __main__: Could not delete CNV24 - ElementEntry.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV24 - ElementEntry.xlsx'
2026-01-21 11:49:32,052 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-21 12:50:51,689 INFO     root: ================================================================================
2026-01-21 12:50:51,689 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 12:50:52,374 INFO     __main__: Connected to database.
2026-01-21 12:50:52,407 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 12:50:52,660 INFO     __main__: Connected to database.
2026-01-21 12:50:52,660 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 13:56:58,575 INFO     root: ================================================================================
2026-01-21 13:56:58,576 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 13:56:59,110 INFO     __main__: Connected to database.
2026-01-21 13:56:59,122 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 13:56:59,343 INFO     __main__: Connected to database.
2026-01-21 13:56:59,343 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 14:02:01,552 INFO     root: ================================================================================
2026-01-21 14:02:01,552 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 14:02:02,089 INFO     __main__: Connected to database.
2026-01-21 14:02:02,113 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 14:02:02,424 INFO     __main__: Connected to database.
2026-01-21 14:02:02,424 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 15:24:30,864 INFO     root: ================================================================================
2026-01-21 15:24:30,865 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 15:24:31,477 INFO     __main__: Connected to database.
2026-01-21 15:24:31,489 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 15:24:31,746 INFO     __main__: Connected to database.
2026-01-21 15:24:31,746 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 15:28:28,443 INFO     root: ================================================================================
2026-01-21 15:28:28,443 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 15:28:28,983 INFO     __main__: Connected to database.
2026-01-21 15:28:28,999 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 15:28:29,331 INFO     __main__: Connected to database.
2026-01-21 15:28:29,331 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 15:29:43,451 INFO     root: ================================================================================
2026-01-21 15:29:43,451 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 15:29:43,999 INFO     __main__: Connected to database.
2026-01-21 15:29:44,015 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 15:29:44,365 INFO     __main__: Connected to database.
2026-01-21 15:29:44,365 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 15:30:35,734 INFO     root: ================================================================================
2026-01-21 15:30:35,734 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 15:30:36,295 INFO     __main__: Connected to database.
2026-01-21 15:30:36,312 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 15:30:36,758 INFO     __main__: Connected to database.
2026-01-21 15:30:36,758 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 15:33:24,789 INFO     root: ================================================================================
2026-01-21 15:33:24,789 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 15:33:25,324 INFO     __main__: Connected to database.
2026-01-21 15:33:25,345 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 15:33:25,709 INFO     __main__: Connected to database.
2026-01-21 15:33:25,712 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 15:34:22,696 INFO     root: ================================================================================
2026-01-21 15:34:22,696 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 15:34:23,275 INFO     __main__: Connected to database.
2026-01-21 15:34:23,295 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 15:34:23,602 INFO     __main__: Connected to database.
2026-01-21 15:34:23,613 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 15:34:50,559 INFO     root: ================================================================================
2026-01-21 15:34:50,559 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 15:34:51,153 INFO     __main__: Connected to database.
2026-01-21 15:34:51,166 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 15:34:51,421 INFO     __main__: Connected to database.
2026-01-21 15:34:51,421 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 15:35:40,883 INFO     root: ================================================================================
2026-01-21 15:35:40,883 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 15:35:41,453 INFO     __main__: Connected to database.
2026-01-21 15:35:41,465 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 15:35:41,820 INFO     __main__: Connected to database.
2026-01-21 15:35:41,820 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 15:36:10,185 INFO     root: ================================================================================
2026-01-21 15:36:10,186 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 15:36:10,690 INFO     __main__: Connected to database.
2026-01-21 15:36:10,699 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 15:36:11,021 INFO     __main__: Connected to database.
2026-01-21 15:36:11,021 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 16:21:03,997 INFO     root: ================================================================================
2026-01-21 16:21:03,997 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 16:21:04,574 INFO     __main__: Connected to database.
2026-01-21 16:21:04,585 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 16:21:04,837 INFO     __main__: Connected to database.
2026-01-21 16:21:04,837 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 16:21:57,979 INFO     __main__: Connected to database.
2026-01-21 16:21:57,982 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 16:21:59,006 INFO     __main__: Connected to database.
2026-01-21 16:21:59,006 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 16:22:00,248 INFO     __main__: Connected to database.
2026-01-21 16:22:00,248 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 16:22:01,580 INFO     __main__: Connected to database.
2026-01-21 16:22:01,581 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 16:22:03,269 INFO     __main__: Connected to database.
2026-01-21 16:22:03,269 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 16:22:20,031 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 16:22:20,114 INFO     __main__: Connected to database.
2026-01-21 16:22:20,114 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 16:22:20,114 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-21 16:22:20,114 INFO     __main__: Retrieved 1 rows.
2026-01-21 16:22:20,114 INFO     __main__: Found 1 project IDs
2026-01-21 16:22:20,114 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-21 16:22:20,239 INFO     __main__: Retrieved 49 rows.
2026-01-21 16:22:20,239 INFO     __main__: Found 49 child rows
2026-01-21 16:22:20,241 INFO     __main__: Normal processing (no transitivity)
2026-01-21 16:22:20,241 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-21 16:22:20,495 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-21 16:22:20,495 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-21 16:22:20,501 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-21 16:22:20,507 INFO     __main__: Custom rule extracted from Generate Mapping tab:
2026-01-21 16:22:20,507 INFO     __main__:   Patterns: 1
2026-01-21 16:22:20,510 INFO     __main__:   Scope: fieldname
2026-01-21 16:22:20,510 INFO     __main__:   Action: Non-PII
2026-01-21 16:22:20,510 INFO     __main__: Custom rules detected from Generate Mapping tab: 1 rule(s)
2026-01-21 16:22:20,581 INFO     __main__: Connected to database.
2026-01-21 16:22:20,581 INFO     pii_core: Loading PII detection rules from database
2026-01-21 16:22:20,581 INFO     pii_database: Using provided database connection for PII rules
2026-01-21 16:22:20,581 INFO     pii_database: Loading PII detection rules from database
2026-01-21 16:22:20,595 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-21 16:22:20,595 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-21 16:22:20,595 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-21 16:22:20,595 INFO     pii_core:   Rule: 1 patterns, Scope=fieldname, Action=Non-PII, Type=None
2026-01-21 16:22:20,595 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-21 16:22:20,595 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-21 16:22:20,595 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-21 16:22:20,595 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-21 16:22:20,595 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-21 16:22:20,595 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-21 16:22:20,595 INFO     pii_core: ================================================================================
2026-01-21 16:22:20,595 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-21 16:22:20,595 INFO     pii_core: ================================================================================
2026-01-21 16:22:20,595 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-21 16:22:20,613 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-21 16:22:20,717 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-21 16:22:20,736 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-21 16:22:20,782 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-21 16:22:20,782 INFO     pii_core: Processing 1 sheet(s)
2026-01-21 16:22:20,782 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-21 16:22:20,782 INFO     pii_core: Phase 1: Rule-based classification
2026-01-21 16:22:20,788 INFO     pii_core: Rule-based: 4 PII, 11 non-PII, 15 ambiguous
2026-01-21 16:22:20,788 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-21 16:22:20,790 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 16:22:25,756 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 16:22:25,762 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 16:22:28,399 INFO     utils.gemini_client: Successfully processed batch with 3 rows
2026-01-21 16:22:28,452 INFO     pii_core: ================================================================================
2026-01-21 16:22:28,452 INFO     pii_core: COMPLETE: 4/30 PII fields found
2026-01-21 16:22:28,464 INFO     pii_core: ================================================================================
2026-01-21 16:22:28,465 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 4/30 PII fields detected
2026-01-21 16:22:34,879 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-21 16:22:34,879 WARNING  __main__: Could not delete CNV24 - ElementEntry.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV24 - ElementEntry.xlsx'
2026-01-21 16:22:34,879 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-21 16:23:59,792 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 16:24:00,008 INFO     __main__: Connected to database.
2026-01-21 16:24:00,008 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 16:24:00,010 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-21 16:24:00,014 INFO     __main__: Retrieved 1 rows.
2026-01-21 16:24:00,014 INFO     __main__: Found 1 project IDs
2026-01-21 16:24:00,014 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-21 16:24:00,058 INFO     __main__: Retrieved 49 rows.
2026-01-21 16:24:00,058 INFO     __main__: Found 49 child rows
2026-01-21 16:24:00,058 INFO     __main__: Normal processing (no transitivity)
2026-01-21 16:24:00,071 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-21 16:24:00,185 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-21 16:24:00,185 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-21 16:24:00,201 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-21 16:24:00,217 INFO     __main__: Custom rule extracted from Generate Mapping tab:
2026-01-21 16:24:00,223 INFO     __main__:   Patterns: 1
2026-01-21 16:24:00,223 INFO     __main__:   Scope: description
2026-01-21 16:24:00,223 INFO     __main__:   Action: PII
2026-01-21 16:24:00,223 INFO     __main__:   PII Type: Custom_PII
2026-01-21 16:24:00,223 INFO     __main__: Custom rules detected from Generate Mapping tab: 1 rule(s)
2026-01-21 16:24:00,443 INFO     __main__: Connected to database.
2026-01-21 16:24:00,443 INFO     pii_core: Loading PII detection rules from database
2026-01-21 16:24:00,443 INFO     pii_database: Using provided database connection for PII rules
2026-01-21 16:24:00,445 INFO     pii_database: Loading PII detection rules from database
2026-01-21 16:24:00,457 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-21 16:24:00,459 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-21 16:24:00,459 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-21 16:24:00,460 INFO     pii_core:   Rule: 1 patterns, Scope=description, Action=PII, Type=Custom_PII
2026-01-21 16:24:00,461 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-21 16:24:00,462 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-21 16:24:00,462 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-21 16:24:00,462 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-21 16:24:00,462 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-21 16:24:00,462 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-21 16:24:00,462 INFO     pii_core: ================================================================================
2026-01-21 16:24:00,462 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-21 16:24:00,462 INFO     pii_core: ================================================================================
2026-01-21 16:24:00,478 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-21 16:24:00,493 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-21 16:24:00,575 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-21 16:24:00,591 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-21 16:24:00,623 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-21 16:24:00,623 INFO     pii_core: Processing 1 sheet(s)
2026-01-21 16:24:00,623 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-21 16:24:00,623 INFO     pii_core: Phase 1: Rule-based classification
2026-01-21 16:24:00,639 INFO     pii_core: Rule-based: 7 PII, 8 non-PII, 15 ambiguous
2026-01-21 16:24:00,639 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-21 16:24:00,639 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 16:24:06,021 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 16:24:06,021 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 16:24:09,172 INFO     utils.gemini_client: Successfully processed batch with 3 rows
2026-01-21 16:24:09,230 INFO     pii_core: ================================================================================
2026-01-21 16:24:09,230 INFO     pii_core: COMPLETE: 7/30 PII fields found
2026-01-21 16:24:09,230 INFO     pii_core: ================================================================================
2026-01-21 16:24:09,240 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 7/30 PII fields detected
2026-01-21 16:24:24,237 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-21 16:24:24,237 WARNING  __main__: Could not delete CNV24 - ElementEntry.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV24 - ElementEntry.xlsx'
2026-01-21 16:24:24,237 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-21 16:25:04,340 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 16:25:04,448 INFO     __main__: Connected to database.
2026-01-21 16:25:04,448 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 16:25:04,452 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-21 16:25:04,452 INFO     __main__: Retrieved 1 rows.
2026-01-21 16:25:04,452 INFO     __main__: Found 1 project IDs
2026-01-21 16:25:04,452 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-21 16:25:04,487 INFO     __main__: Retrieved 49 rows.
2026-01-21 16:25:04,487 INFO     __main__: Found 49 child rows
2026-01-21 16:25:04,488 INFO     __main__: Normal processing (no transitivity)
2026-01-21 16:25:04,488 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-21 16:25:04,531 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-21 16:25:04,532 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-21 16:25:04,533 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-21 16:25:04,536 INFO     __main__: Custom rule extracted from Generate Mapping tab:
2026-01-21 16:25:04,536 INFO     __main__:   Patterns: 1
2026-01-21 16:25:04,536 INFO     __main__:   Scope: description
2026-01-21 16:25:04,536 INFO     __main__:   Action: PII
2026-01-21 16:25:04,537 INFO     __main__:   PII Type: Custom_PII
2026-01-21 16:25:04,537 INFO     __main__: Custom rules detected from Generate Mapping tab: 1 rule(s)
2026-01-21 16:25:04,646 INFO     __main__: Connected to database.
2026-01-21 16:25:04,646 INFO     pii_core: Loading PII detection rules from database
2026-01-21 16:25:04,646 INFO     pii_database: Using provided database connection for PII rules
2026-01-21 16:25:04,646 INFO     pii_database: Loading PII detection rules from database
2026-01-21 16:25:04,656 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-21 16:25:04,656 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-21 16:25:04,656 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-21 16:25:04,656 INFO     pii_core:   Rule: 1 patterns, Scope=description, Action=PII, Type=Custom_PII
2026-01-21 16:25:04,663 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-21 16:25:04,663 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-21 16:25:04,665 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-21 16:25:04,665 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-21 16:25:04,668 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-21 16:25:04,668 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-21 16:25:04,668 INFO     pii_core: ================================================================================
2026-01-21 16:25:04,668 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-21 16:25:04,668 INFO     pii_core: ================================================================================
2026-01-21 16:25:04,672 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-21 16:25:04,679 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-21 16:25:04,775 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-21 16:25:04,888 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-21 16:25:04,943 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-21 16:25:04,943 INFO     pii_core: Processing 1 sheet(s)
2026-01-21 16:25:04,943 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-21 16:25:04,943 INFO     pii_core: Phase 1: Rule-based classification
2026-01-21 16:25:04,957 INFO     pii_core: Rule-based: 7 PII, 8 non-PII, 15 ambiguous
2026-01-21 16:25:04,957 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-21 16:25:04,959 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 16:25:13,728 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 16:25:13,728 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 16:25:20,284 INFO     utils.gemini_client: Successfully processed batch with 3 rows
2026-01-21 16:25:20,331 INFO     pii_core: ================================================================================
2026-01-21 16:25:20,346 INFO     pii_core: COMPLETE: 7/30 PII fields found
2026-01-21 16:25:20,346 INFO     pii_core: ================================================================================
2026-01-21 16:25:20,346 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 7/30 PII fields detected
2026-01-21 16:25:22,970 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-21 16:25:22,970 WARNING  __main__: Could not delete CNV24 - ElementEntry.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV24 - ElementEntry.xlsx'
2026-01-21 16:25:22,970 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-21 16:27:48,521 INFO     root: ================================================================================
2026-01-21 16:27:48,521 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 16:27:49,040 INFO     __main__: Connected to database.
2026-01-21 16:27:49,055 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 16:27:49,276 INFO     __main__: Connected to database.
2026-01-21 16:27:49,276 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 16:27:51,601 INFO     __main__: Connected to database.
2026-01-21 16:27:51,601 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 16:27:52,765 INFO     __main__: Connected to database.
2026-01-21 16:27:52,765 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 16:27:54,083 INFO     __main__: Connected to database.
2026-01-21 16:27:54,083 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 16:27:55,126 INFO     __main__: Connected to database.
2026-01-21 16:27:55,129 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 16:27:56,693 INFO     __main__: Connected to database.
2026-01-21 16:27:56,693 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 16:28:09,379 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 16:28:09,569 INFO     __main__: Connected to database.
2026-01-21 16:28:09,569 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 16:28:09,569 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-21 16:28:09,574 INFO     __main__: Retrieved 1 rows.
2026-01-21 16:28:09,574 INFO     __main__: Found 1 project IDs
2026-01-21 16:28:09,574 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-21 16:28:09,606 INFO     __main__: Retrieved 49 rows.
2026-01-21 16:28:09,615 INFO     __main__: Found 49 child rows
2026-01-21 16:28:09,615 INFO     __main__: Normal processing (no transitivity)
2026-01-21 16:28:09,615 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-21 16:28:09,739 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-21 16:28:09,739 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-21 16:28:09,739 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-21 16:28:09,739 INFO     __main__: Custom rule extracted from Generate Mapping tab:
2026-01-21 16:28:09,739 INFO     __main__:   Patterns: 1
2026-01-21 16:28:09,739 INFO     __main__:   Scope: description
2026-01-21 16:28:09,739 INFO     __main__:   Action: PII
2026-01-21 16:28:09,739 INFO     __main__:   PII Type: Custom_PII
2026-01-21 16:28:09,739 INFO     __main__: Custom rules detected from Generate Mapping tab: 1 rule(s)
2026-01-21 16:28:09,808 INFO     __main__: Connected to database.
2026-01-21 16:28:09,808 INFO     pii_core: Loading PII detection rules from database
2026-01-21 16:28:09,808 INFO     pii_database: Using provided database connection for PII rules
2026-01-21 16:28:09,808 INFO     pii_database: Loading PII detection rules from database
2026-01-21 16:28:09,813 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-21 16:28:09,819 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-21 16:28:09,819 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-21 16:28:09,819 INFO     pii_core:   Rule: 1 patterns, Scope=description, Action=PII, Type=Custom_PII
2026-01-21 16:28:09,819 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-21 16:28:09,819 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-21 16:28:09,819 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-21 16:28:09,819 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-21 16:28:09,819 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-21 16:28:09,819 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-21 16:28:09,819 INFO     pii_core: ================================================================================
2026-01-21 16:28:09,819 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-21 16:28:09,819 INFO     pii_core: ================================================================================
2026-01-21 16:28:09,819 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-21 16:28:09,834 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-21 16:28:10,093 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-21 16:28:10,109 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-21 16:28:10,156 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-21 16:28:10,156 INFO     pii_core: Processing 1 sheet(s)
2026-01-21 16:28:10,156 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-21 16:28:10,157 INFO     pii_core: Phase 1: Rule-based classification
2026-01-21 16:28:10,159 INFO     pii_core: Rule-based: 14 PII, 2 non-PII, 14 ambiguous
2026-01-21 16:28:10,161 INFO     pii_core: Phase 2: Gemini API detection (14 fields)
2026-01-21 16:28:10,161 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 16:28:17,943 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 16:28:17,943 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 16:28:22,834 INFO     utils.gemini_client: Successfully processed batch with 2 rows
2026-01-21 16:28:22,876 INFO     pii_core: ================================================================================
2026-01-21 16:28:22,877 INFO     pii_core: COMPLETE: 14/30 PII fields found
2026-01-21 16:28:22,879 INFO     pii_core: ================================================================================
2026-01-21 16:28:22,880 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 14/30 PII fields detected
2026-01-21 16:28:26,446 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-21 16:28:26,446 WARNING  __main__: Could not delete CNV24 - ElementEntry.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV24 - ElementEntry.xlsx'
2026-01-21 16:28:26,446 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-21 16:32:08,709 INFO     __main__: No custom rules provided, using system rules only
2026-01-21 16:32:08,823 INFO     __main__: Connected to database.
2026-01-21 16:32:08,823 INFO     pii_core: Loading PII detection rules from database
2026-01-21 16:32:08,823 INFO     pii_database: Using provided database connection for PII rules
2026-01-21 16:32:08,823 INFO     pii_database: Loading PII detection rules from database
2026-01-21 16:32:08,830 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-21 16:32:08,839 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-21 16:32:08,839 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-21 16:32:08,840 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-21 16:32:08,840 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-21 16:32:08,841 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-21 16:32:08,841 INFO     pii_core: ================================================================================
2026-01-21 16:32:08,843 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-21 16:32:08,843 INFO     pii_core: ================================================================================
2026-01-21 16:32:08,844 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-21 16:32:08,855 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-21 16:32:08,928 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-21 16:32:08,941 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-21 16:32:08,992 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-21 16:32:08,992 INFO     pii_core: Processing 1 sheet(s)
2026-01-21 16:32:08,992 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-21 16:32:08,994 INFO     pii_core: Phase 1: Rule-based classification
2026-01-21 16:32:08,996 INFO     pii_core: Rule-based: 7 PII, 8 non-PII, 15 ambiguous
2026-01-21 16:32:08,996 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-21 16:32:08,996 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 16:32:14,790 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 16:32:14,790 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 16:32:17,385 INFO     utils.gemini_client: Successfully processed batch with 3 rows
2026-01-21 16:32:17,458 INFO     pii_core: ================================================================================
2026-01-21 16:32:17,458 INFO     pii_core: COMPLETE: 7/30 PII fields found
2026-01-21 16:32:17,458 INFO     pii_core: ================================================================================
2026-01-21 16:32:17,799 INFO     __main__: No custom rules provided, using system rules only
2026-01-21 16:32:17,885 INFO     __main__: Connected to database.
2026-01-21 16:32:17,885 INFO     pii_core: Loading PII detection rules from database
2026-01-21 16:32:17,885 INFO     pii_database: Using provided database connection for PII rules
2026-01-21 16:32:17,885 INFO     pii_database: Loading PII detection rules from database
2026-01-21 16:32:17,908 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-21 16:32:17,908 INFO     pii_core: Loaded 17 PII categories, 209 patterns
2026-01-21 16:32:17,908 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-21 16:32:17,908 INFO     pii_core: PII Detection Orchestrator initialized (HYBRID MODE)
2026-01-21 16:32:17,908 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-21 16:32:17,908 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-21 16:32:17,908 INFO     pii_core: ================================================================================
2026-01-21 16:32:17,917 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-21 16:32:17,917 INFO     pii_core: ================================================================================
2026-01-21 16:32:17,917 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-21 16:32:17,937 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-21 16:32:18,136 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-21 16:32:18,161 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-21 16:32:18,343 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-21 16:32:18,343 INFO     pii_core: Processing 1 sheet(s)
2026-01-21 16:32:18,343 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-21 16:32:18,345 INFO     pii_core: Phase 1: Rule-based classification
2026-01-21 16:32:18,351 INFO     pii_core: Rule-based: 7 PII, 8 non-PII, 15 ambiguous
2026-01-21 16:32:18,353 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-21 16:32:18,355 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 16:32:24,241 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 16:32:24,241 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 16:32:28,785 INFO     utils.gemini_client: Successfully processed batch with 3 rows
2026-01-21 16:32:28,828 INFO     pii_core: ================================================================================
2026-01-21 16:32:28,828 INFO     pii_core: COMPLETE: 7/30 PII fields found
2026-01-21 16:32:28,828 INFO     pii_core: ================================================================================
2026-01-21 20:26:31,160 INFO     root: ================================================================================
2026-01-21 20:26:31,160 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-21 20:26:32,608 INFO     __main__: Connected to database.
2026-01-21 20:26:32,688 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 20:26:33,370 INFO     __main__: Connected to database.
2026-01-21 20:26:33,380 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-21 20:30:17,090 INFO     __main__: Connected to database.
2026-01-21 20:30:17,136 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 20:30:18,347 INFO     __main__: Connected to database.
2026-01-21 20:30:18,356 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 20:30:19,577 INFO     __main__: Connected to database.
2026-01-21 20:30:19,587 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 20:30:21,002 INFO     __main__: Connected to database.
2026-01-21 20:30:21,008 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 20:30:22,216 INFO     __main__: Connected to database.
2026-01-21 20:30:22,224 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 20:30:23,765 INFO     __main__: Connected to database.
2026-01-21 20:30:23,771 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 20:30:26,345 INFO     __main__: Connected to database.
2026-01-21 20:30:26,353 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-21 20:30:49,977 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 20:30:50,153 INFO     __main__: Connected to database.
2026-01-21 20:30:50,154 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 20:30:50,155 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-21 20:30:50,174 INFO     __main__: Retrieved 1 rows.
2026-01-21 20:30:50,174 INFO     __main__: Found 1 project IDs
2026-01-21 20:30:50,175 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-21 20:30:50,341 INFO     __main__: Retrieved 49 rows.
2026-01-21 20:30:50,341 INFO     __main__: Found 49 child rows
2026-01-21 20:30:50,342 INFO     __main__: Normal processing (no transitivity)
2026-01-21 20:30:50,343 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-21 20:30:50,710 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-21 20:30:50,712 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-21 20:30:50,721 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-21 20:30:50,731 INFO     __main__: No custom rules provided in Generate Mapping tab, using system rules only
2026-01-21 20:30:50,875 INFO     __main__: Connected to database.
2026-01-21 20:30:50,876 INFO     pii_core: Loading PII detection rules from database
2026-01-21 20:30:50,876 INFO     pii_database: Using provided database connection for PII rules
2026-01-21 20:30:50,876 INFO     pii_database: Loading PII detection rules from database
2026-01-21 20:30:50,923 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-21 20:30:50,923 INFO     pii_core: Loaded 17 PII categories, 208 patterns
2026-01-21 20:30:50,925 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-21 20:30:50,927 INFO     pii_core: PII Detection Orchestrator initialized
2026-01-21 20:30:50,928 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-21 20:30:50,929 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-21 20:30:50,930 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-21 20:30:50,931 INFO     pii_core: ================================================================================
2026-01-21 20:30:50,933 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-21 20:30:50,934 INFO     pii_core: ================================================================================
2026-01-21 20:30:50,936 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-21 20:30:50,970 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-21 20:30:51,386 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-21 20:30:51,510 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-21 20:30:51,674 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-21 20:30:51,675 INFO     pii_core: Processing 1 sheet(s)
2026-01-21 20:30:51,676 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-21 20:30:51,677 INFO     pii_core: Phase 1: Rule-based classification
2026-01-21 20:30:51,696 INFO     pii_core: Rule-based: 7 PII, 8 non-PII, 15 ambiguous
2026-01-21 20:30:51,697 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-21 20:30:51,703 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 20:30:59,017 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 20:30:59,019 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 20:31:04,379 INFO     utils.gemini_client: Successfully processed batch with 3 rows
2026-01-21 20:31:04,453 INFO     pii_core: ================================================================================
2026-01-21 20:31:04,454 INFO     pii_core: COMPLETE: 7/30 PII fields found
2026-01-21 20:31:04,454 INFO     pii_core: ================================================================================
2026-01-21 20:31:04,455 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 7/30 PII fields detected
2026-01-21 20:31:07,868 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-21 20:31:07,870 WARNING  __main__: Could not delete CNV24 - ElementEntry.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV24 - ElementEntry.xlsx'
2026-01-21 20:31:07,871 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-21 20:32:11,184 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 20:32:11,426 INFO     __main__: Connected to database.
2026-01-21 20:32:11,427 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 20:32:11,427 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-21 20:32:11,434 INFO     __main__: Retrieved 1 rows.
2026-01-21 20:32:11,434 INFO     __main__: Found 1 project IDs
2026-01-21 20:32:11,435 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-21 20:32:11,489 INFO     __main__: Retrieved 49 rows.
2026-01-21 20:32:11,490 INFO     __main__: Found 49 child rows
2026-01-21 20:32:11,490 INFO     __main__: Normal processing (no transitivity)
2026-01-21 20:32:11,492 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-21 20:32:11,751 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-21 20:32:11,752 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-21 20:32:11,760 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-21 20:32:11,789 INFO     __main__: Custom rule extracted from Generate Mapping tab:
2026-01-21 20:32:11,789 INFO     __main__:   Patterns: 2
2026-01-21 20:32:11,791 INFO     __main__:   Scope: fieldname
2026-01-21 20:32:11,793 INFO     __main__:   Action: PII
2026-01-21 20:32:11,793 INFO     __main__:   PII Type: Custom_PII
2026-01-21 20:32:11,794 INFO     __main__: Custom rules detected from Generate Mapping tab: 1 rule(s)
2026-01-21 20:32:12,044 INFO     __main__: Connected to database.
2026-01-21 20:32:12,044 INFO     pii_core: Loading PII detection rules from database
2026-01-21 20:32:12,044 INFO     pii_database: Using provided database connection for PII rules
2026-01-21 20:32:12,047 INFO     pii_database: Loading PII detection rules from database
2026-01-21 20:32:12,072 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-21 20:32:12,073 INFO     pii_core: Loaded 17 PII categories, 208 patterns
2026-01-21 20:32:12,073 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-21 20:32:12,074 INFO     pii_core:   Rule: 2 patterns, Scope=fieldname, Action=PII, Type=Custom_PII
2026-01-21 20:32:12,076 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-21 20:32:12,080 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-21 20:32:12,081 INFO     pii_core: PII Detection Orchestrator initialized
2026-01-21 20:32:12,082 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-21 20:32:12,083 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-21 20:32:12,084 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-21 20:32:12,086 INFO     pii_core: ================================================================================
2026-01-21 20:32:12,087 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-21 20:32:12,089 INFO     pii_core: ================================================================================
2026-01-21 20:32:12,090 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-21 20:32:12,111 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-21 20:32:12,383 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-21 20:32:12,417 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-21 20:32:12,528 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-21 20:32:12,528 INFO     pii_core: Processing 1 sheet(s)
2026-01-21 20:32:12,528 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-21 20:32:12,530 INFO     pii_core: Phase 1: Rule-based classification
2026-01-21 20:32:12,549 INFO     pii_core: Rule-based: 9 PII, 6 non-PII, 15 ambiguous
2026-01-21 20:32:12,549 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-21 20:32:12,554 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 20:32:19,107 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 20:32:19,108 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 20:32:21,995 INFO     utils.gemini_client: Successfully processed batch with 3 rows
2026-01-21 20:32:22,089 INFO     pii_core: ================================================================================
2026-01-21 20:32:22,090 INFO     pii_core: COMPLETE: 9/30 PII fields found
2026-01-21 20:32:22,091 INFO     pii_core: ================================================================================
2026-01-21 20:32:22,092 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 9/30 PII fields detected
2026-01-21 20:32:29,179 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-21 20:32:29,182 WARNING  __main__: Could not delete CNV24 - ElementEntry.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV24 - ElementEntry.xlsx'
2026-01-21 20:32:29,183 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-21 20:43:07,920 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 20:43:08,058 INFO     __main__: Connected to database.
2026-01-21 20:43:08,059 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-21 20:43:08,061 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-21 20:43:08,067 INFO     __main__: Retrieved 1 rows.
2026-01-21 20:43:08,069 INFO     __main__: Found 1 project IDs
2026-01-21 20:43:08,069 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-21 20:43:08,126 INFO     __main__: Retrieved 49 rows.
2026-01-21 20:43:08,127 INFO     __main__: Found 49 child rows
2026-01-21 20:43:08,128 INFO     __main__: Normal processing (no transitivity)
2026-01-21 20:43:08,130 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-21 20:43:08,374 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-21 20:43:08,375 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-21 20:43:08,388 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-21 20:43:08,401 INFO     __main__: Custom rule extracted from Generate Mapping tab:
2026-01-21 20:43:08,402 INFO     __main__:   Patterns: 2
2026-01-21 20:43:08,404 INFO     __main__:   Scope: fieldname
2026-01-21 20:43:08,405 INFO     __main__:   Action: PII
2026-01-21 20:43:08,406 INFO     __main__:   PII Type: Custom_PII
2026-01-21 20:43:08,407 INFO     __main__: Custom rules detected from Generate Mapping tab: 1 rule(s)
2026-01-21 20:43:08,575 INFO     __main__: Connected to database.
2026-01-21 20:43:08,575 INFO     pii_core: Loading PII detection rules from database
2026-01-21 20:43:08,576 INFO     pii_database: Using provided database connection for PII rules
2026-01-21 20:43:08,577 INFO     pii_database: Loading PII detection rules from database
2026-01-21 20:43:08,607 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-21 20:43:08,608 INFO     pii_core: Loaded 17 PII categories, 208 patterns
2026-01-21 20:43:08,609 INFO     pii_core: Custom rules loaded: 1 rule(s)
2026-01-21 20:43:08,611 INFO     pii_core:   Rule: 2 patterns, Scope=fieldname, Action=PII, Type=Custom_PII
2026-01-21 20:43:08,611 INFO     pii_core: Custom rules applied: 1 rule(s)
2026-01-21 20:43:08,613 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-21 20:43:08,614 INFO     pii_core: PII Detection Orchestrator initialized
2026-01-21 20:43:08,615 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-21 20:43:08,618 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-21 20:43:08,619 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-21 20:43:08,622 INFO     pii_core: ================================================================================
2026-01-21 20:43:08,622 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-21 20:43:08,624 INFO     pii_core: ================================================================================
2026-01-21 20:43:08,625 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-21 20:43:08,648 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-21 20:43:08,865 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-21 20:43:09,028 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-21 20:43:09,132 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-21 20:43:09,133 INFO     pii_core: Processing 1 sheet(s)
2026-01-21 20:43:09,133 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-21 20:43:09,134 INFO     pii_core: Phase 1: Rule-based classification
2026-01-21 20:43:09,142 INFO     pii_core: Rule-based: 8 PII, 7 non-PII, 15 ambiguous
2026-01-21 20:43:09,143 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-21 20:43:09,145 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 20:43:14,877 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-21 20:43:14,878 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-21 20:43:19,760 INFO     utils.gemini_client: Successfully processed batch with 3 rows
2026-01-21 20:43:19,831 INFO     pii_core: ================================================================================
2026-01-21 20:43:19,833 INFO     pii_core: COMPLETE: 8/30 PII fields found
2026-01-21 20:43:19,835 INFO     pii_core: ================================================================================
2026-01-21 20:43:19,836 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 8/30 PII fields detected
2026-01-21 20:43:47,981 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-21 20:43:47,982 WARNING  __main__: Could not delete CNV24 - ElementEntry.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV24 - ElementEntry.xlsx'
2026-01-21 20:43:47,983 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-22 12:46:04,619 INFO     root: ================================================================================
2026-01-22 12:46:04,619 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-22 12:46:05,161 INFO     __main__: Connected to database.
2026-01-22 12:46:05,206 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 12:46:05,699 INFO     __main__: Connected to database.
2026-01-22 12:46:05,699 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-22 13:09:25,419 INFO     root: ================================================================================
2026-01-22 13:09:25,419 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-22 13:09:25,939 INFO     __main__: Connected to database.
2026-01-22 13:09:25,954 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:09:26,278 INFO     __main__: Connected to database.
2026-01-22 13:09:26,281 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-22 13:09:36,125 INFO     __main__: Connected to database.
2026-01-22 13:09:36,129 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:09:37,772 INFO     __main__: Connected to database.
2026-01-22 13:09:37,777 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:09:39,254 INFO     __main__: Connected to database.
2026-01-22 13:09:39,263 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:09:40,777 INFO     __main__: Connected to database.
2026-01-22 13:09:40,777 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:09:43,157 INFO     __main__: Connected to database.
2026-01-22 13:09:43,157 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:09:50,479 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 13:09:50,666 INFO     __main__: Connected to database.
2026-01-22 13:09:50,666 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 13:09:50,666 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-22 13:09:50,684 INFO     __main__: Retrieved 1 rows.
2026-01-22 13:09:50,684 INFO     __main__: Found 1 project IDs
2026-01-22 13:09:50,684 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-22 13:09:50,836 INFO     __main__: Retrieved 49 rows.
2026-01-22 13:09:50,836 INFO     __main__: Found 49 child rows
2026-01-22 13:09:50,836 INFO     __main__: Normal processing (no transitivity)
2026-01-22 13:09:50,836 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-22 13:09:51,033 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-22 13:09:51,033 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-22 13:09:51,035 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-22 13:09:51,042 INFO     __main__: No custom rules provided in Generate Mapping tab, using system rules only
2026-01-22 13:09:51,095 INFO     __main__: Connected to database.
2026-01-22 13:09:51,095 INFO     pii_core: Loading PII detection rules from database
2026-01-22 13:09:51,095 INFO     pii_database: Using provided database connection for PII rules
2026-01-22 13:09:51,095 INFO     pii_database: Loading PII detection rules from database
2026-01-22 13:09:51,112 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-22 13:09:51,112 INFO     pii_core: Loaded 17 PII categories, 208 patterns
2026-01-22 13:09:51,112 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-22 13:09:51,112 INFO     pii_core: PII Detection Orchestrator initialized
2026-01-22 13:09:51,112 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-22 13:09:51,112 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-22 13:09:51,112 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-22 13:09:51,112 INFO     pii_core: ================================================================================
2026-01-22 13:09:51,112 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-22 13:09:51,112 INFO     pii_core: ================================================================================
2026-01-22 13:09:51,112 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-22 13:09:51,136 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-22 13:09:51,230 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-22 13:09:51,246 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-22 13:09:51,312 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-22 13:09:51,312 INFO     pii_core: Processing 1 sheet(s)
2026-01-22 13:09:51,312 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-22 13:09:51,312 INFO     pii_core: Phase 1: Rule-based classification
2026-01-22 13:09:51,326 INFO     pii_core: Rule-based: 7 PII, 8 non-PII, 15 ambiguous
2026-01-22 13:09:51,326 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-22 13:09:51,326 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 13:09:58,473 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-22 13:09:58,482 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 13:10:01,231 INFO     utils.gemini_client: Successfully processed batch with 3 rows
2026-01-22 13:10:01,290 INFO     pii_core: ================================================================================
2026-01-22 13:10:01,290 INFO     pii_core: COMPLETE: 7/30 PII fields found
2026-01-22 13:10:01,300 INFO     pii_core: ================================================================================
2026-01-22 13:10:01,301 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 7/30 PII fields detected
2026-01-22 13:16:43,630 INFO     root: ================================================================================
2026-01-22 13:16:43,630 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-22 13:16:44,194 INFO     __main__: Connected to database.
2026-01-22 13:16:44,221 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:16:44,424 INFO     __main__: Connected to database.
2026-01-22 13:16:44,427 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-22 13:16:53,431 INFO     __main__: Connected to database.
2026-01-22 13:16:53,431 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:16:55,082 INFO     __main__: Connected to database.
2026-01-22 13:16:55,097 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:16:56,618 INFO     __main__: Connected to database.
2026-01-22 13:16:56,618 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:16:58,160 INFO     __main__: Connected to database.
2026-01-22 13:16:58,160 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:17:01,044 INFO     __main__: Connected to database.
2026-01-22 13:17:01,044 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:17:06,085 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 13:17:06,197 INFO     __main__: Connected to database.
2026-01-22 13:17:06,197 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 13:17:06,197 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-22 13:17:06,200 INFO     __main__: Retrieved 1 rows.
2026-01-22 13:17:06,200 INFO     __main__: Found 1 project IDs
2026-01-22 13:17:06,200 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-22 13:17:06,248 INFO     __main__: Retrieved 49 rows.
2026-01-22 13:17:06,248 INFO     __main__: Found 49 child rows
2026-01-22 13:17:06,249 INFO     __main__: Normal processing (no transitivity)
2026-01-22 13:17:06,250 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-22 13:17:06,369 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-22 13:17:06,371 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-22 13:17:06,371 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-22 13:17:06,374 INFO     __main__: No custom rules provided in Generate Mapping tab, using system rules only
2026-01-22 13:17:06,449 INFO     __main__: Connected to database.
2026-01-22 13:17:06,449 INFO     pii_core: Loading PII detection rules from database
2026-01-22 13:17:06,449 INFO     pii_database: Using provided database connection for PII rules
2026-01-22 13:17:06,449 INFO     pii_database: Loading PII detection rules from database
2026-01-22 13:17:06,454 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-22 13:17:06,454 INFO     pii_core: Loaded 17 PII categories, 208 patterns
2026-01-22 13:17:06,454 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-22 13:17:06,454 INFO     pii_core: PII Detection Orchestrator initialized
2026-01-22 13:17:06,454 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-22 13:17:06,454 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-22 13:17:06,454 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-22 13:17:06,454 INFO     pii_core: ================================================================================
2026-01-22 13:17:06,454 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-22 13:17:06,454 INFO     pii_core: ================================================================================
2026-01-22 13:17:06,454 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-22 13:17:06,470 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-22 13:17:06,710 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-22 13:17:06,743 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-22 13:17:06,935 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-22 13:17:06,935 INFO     pii_core: Processing 1 sheet(s)
2026-01-22 13:17:06,935 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-22 13:17:06,938 INFO     pii_core: Phase 1: Rule-based classification
2026-01-22 13:17:06,938 INFO     pii_core: Rule-based: 7 PII, 8 non-PII, 15 ambiguous
2026-01-22 13:17:06,938 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-22 13:17:06,954 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 13:17:14,240 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-22 13:17:14,240 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 13:17:14,609 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 45.542650287s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 45
}
]
2026-01-22 13:17:15,618 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-22 13:17:15,967 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 44.183319606s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 44
}
]
2026-01-22 13:17:17,971 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-22 13:17:18,311 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 41.835850827s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 41
}
]
2026-01-22 13:17:18,320 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-22 13:17:18,372 INFO     pii_core: ================================================================================
2026-01-22 13:17:18,373 INFO     pii_core: COMPLETE: 7/30 PII fields found
2026-01-22 13:17:18,373 INFO     pii_core: ================================================================================
2026-01-22 13:17:18,373 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 7/30 PII fields detected
2026-01-22 13:17:32,902 ERROR    __main__: PII detection error: name 'details' is not defined
Traceback (most recent call last):
  File "c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestroV9.py", line 5886, in run
    final_message = details + summary
                    ^^^^^^^
NameError: name 'details' is not defined
2026-01-22 13:18:18,644 INFO     root: ================================================================================
2026-01-22 13:18:18,644 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-22 13:18:19,292 INFO     __main__: Connected to database.
2026-01-22 13:18:19,305 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:18:19,574 INFO     __main__: Connected to database.
2026-01-22 13:18:19,574 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-22 13:18:22,963 INFO     __main__: Connected to database.
2026-01-22 13:18:22,963 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:18:24,886 INFO     __main__: Connected to database.
2026-01-22 13:18:24,886 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:18:26,898 INFO     __main__: Connected to database.
2026-01-22 13:18:26,898 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:18:28,500 INFO     __main__: Connected to database.
2026-01-22 13:18:28,500 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:18:30,891 INFO     __main__: Connected to database.
2026-01-22 13:18:30,891 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:18:38,195 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 13:18:38,292 INFO     __main__: Connected to database.
2026-01-22 13:18:38,292 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 13:18:38,292 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-22 13:18:38,292 INFO     __main__: Retrieved 1 rows.
2026-01-22 13:18:38,292 INFO     __main__: Found 1 project IDs
2026-01-22 13:18:38,292 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-22 13:18:38,335 INFO     __main__: Retrieved 49 rows.
2026-01-22 13:18:38,335 INFO     __main__: Found 49 child rows
2026-01-22 13:18:38,335 INFO     __main__: Normal processing (no transitivity)
2026-01-22 13:18:38,335 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-22 13:18:38,471 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-22 13:18:38,471 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-22 13:18:38,471 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-22 13:18:38,475 INFO     __main__: No custom rules provided in Generate Mapping tab, using system rules only
2026-01-22 13:18:38,590 INFO     __main__: Connected to database.
2026-01-22 13:18:38,590 INFO     pii_core: Loading PII detection rules from database
2026-01-22 13:18:38,590 INFO     pii_database: Using provided database connection for PII rules
2026-01-22 13:18:38,590 INFO     pii_database: Loading PII detection rules from database
2026-01-22 13:18:38,606 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-22 13:18:38,606 INFO     pii_core: Loaded 17 PII categories, 208 patterns
2026-01-22 13:18:38,606 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-22 13:18:38,612 INFO     pii_core: PII Detection Orchestrator initialized
2026-01-22 13:18:38,612 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-22 13:18:38,612 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-22 13:18:38,612 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-22 13:18:38,612 INFO     pii_core: ================================================================================
2026-01-22 13:18:38,615 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-22 13:18:38,615 INFO     pii_core: ================================================================================
2026-01-22 13:18:38,615 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-22 13:18:38,624 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-22 13:18:38,718 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-22 13:18:38,740 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-22 13:18:38,836 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-22 13:18:38,836 INFO     pii_core: Processing 1 sheet(s)
2026-01-22 13:18:38,836 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-22 13:18:38,837 INFO     pii_core: Phase 1: Rule-based classification
2026-01-22 13:18:38,841 INFO     pii_core: Rule-based: 7 PII, 8 non-PII, 15 ambiguous
2026-01-22 13:18:38,841 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-22 13:18:38,841 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 13:18:39,411 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 20.739674948s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 20
}
]
2026-01-22 13:18:40,412 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-22 13:18:40,764 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 19.385869079s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 19
}
]
2026-01-22 13:18:42,771 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-22 13:18:43,106 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 17.031276875s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 17
}
]
2026-01-22 13:18:43,113 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-22 13:18:43,113 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 13:18:43,457 ERROR    utils.gemini_client: API call error (attempt 1): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 16.698184238s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 16
}
]
2026-01-22 13:18:44,470 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 2/3)...
2026-01-22 13:18:44,804 ERROR    utils.gemini_client: API call error (attempt 2): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 15.344279388s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 15
}
]
2026-01-22 13:18:46,809 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 3/3)...
2026-01-22 13:18:47,151 ERROR    utils.gemini_client: API call error (attempt 3): 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 12.987320291s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 12
}
]
2026-01-22 13:18:47,151 WARNING  utils.gemini_client: Creating default results due to API failure
2026-01-22 13:18:47,199 INFO     pii_core: ================================================================================
2026-01-22 13:18:47,199 INFO     pii_core: COMPLETE: 7/30 PII fields found
2026-01-22 13:18:47,199 INFO     pii_core: ================================================================================
2026-01-22 13:18:47,199 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 7/30 PII fields detected
2026-01-22 13:33:07,740 INFO     root: ================================================================================
2026-01-22 13:33:07,740 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-22 13:33:08,237 INFO     __main__: Connected to database.
2026-01-22 13:33:08,248 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:33:08,480 INFO     __main__: Connected to database.
2026-01-22 13:33:08,496 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-22 13:33:11,697 INFO     __main__: Connected to database.
2026-01-22 13:33:11,701 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:33:12,882 INFO     __main__: Connected to database.
2026-01-22 13:33:12,882 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:33:14,238 INFO     __main__: Connected to database.
2026-01-22 13:33:14,242 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:33:15,141 INFO     __main__: Connected to database.
2026-01-22 13:33:15,150 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:33:16,737 INFO     __main__: Connected to database.
2026-01-22 13:33:16,737 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 13:33:22,975 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 13:33:23,160 INFO     __main__: Connected to database.
2026-01-22 13:33:23,161 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 13:33:23,163 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-22 13:33:23,171 INFO     __main__: Retrieved 1 rows.
2026-01-22 13:33:23,171 INFO     __main__: Found 1 project IDs
2026-01-22 13:33:23,171 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-22 13:33:23,226 INFO     __main__: Retrieved 49 rows.
2026-01-22 13:33:23,226 INFO     __main__: Found 49 child rows
2026-01-22 13:33:23,226 INFO     __main__: Normal processing (no transitivity)
2026-01-22 13:33:23,226 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-22 13:33:23,495 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-22 13:33:23,495 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-22 13:33:23,502 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-22 13:33:23,507 INFO     __main__: No custom rules provided in Generate Mapping tab, using system rules only
2026-01-22 13:33:23,634 INFO     __main__: Connected to database.
2026-01-22 13:33:23,634 INFO     pii_core: Loading PII detection rules from database
2026-01-22 13:33:23,636 INFO     pii_database: Using provided database connection for PII rules
2026-01-22 13:33:23,636 INFO     pii_database: Loading PII detection rules from database
2026-01-22 13:33:23,658 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-22 13:33:23,662 INFO     pii_core: Loaded 17 PII categories, 208 patterns
2026-01-22 13:33:23,664 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-22 13:33:23,664 INFO     pii_core: PII Detection Orchestrator initialized
2026-01-22 13:33:23,668 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-22 13:33:23,670 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-22 13:33:23,674 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-22 13:33:23,674 INFO     pii_core: ================================================================================
2026-01-22 13:33:23,676 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-22 13:33:23,676 INFO     pii_core: ================================================================================
2026-01-22 13:33:23,676 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-22 13:33:23,696 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-22 13:33:23,880 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-22 13:33:23,912 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-22 13:33:24,033 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-22 13:33:24,033 INFO     pii_core: Processing 1 sheet(s)
2026-01-22 13:33:24,033 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-22 13:33:24,033 INFO     pii_core: Phase 1: Rule-based classification
2026-01-22 13:33:24,058 INFO     pii_core: Rule-based: 7 PII, 8 non-PII, 15 ambiguous
2026-01-22 13:33:24,058 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-22 13:33:24,062 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 13:33:29,870 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-22 13:33:29,870 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 13:33:33,637 INFO     utils.gemini_client: Successfully processed batch with 3 rows
2026-01-22 13:33:33,699 INFO     pii_core: ================================================================================
2026-01-22 13:33:33,701 INFO     pii_core: COMPLETE: 7/30 PII fields found
2026-01-22 13:33:33,701 INFO     pii_core: ================================================================================
2026-01-22 13:33:33,703 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 7/30 PII fields detected
2026-01-22 13:34:28,392 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-22 13:34:28,392 WARNING  __main__: Could not delete CNV24 - ElementEntry.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV24 - ElementEntry.xlsx'
2026-01-22 13:34:28,392 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-22 14:46:31,612 INFO     root: ================================================================================
2026-01-22 14:46:31,612 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-22 14:46:32,155 INFO     __main__: Connected to database.
2026-01-22 14:46:32,306 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 14:46:32,689 INFO     __main__: Connected to database.
2026-01-22 14:46:32,689 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-22 14:46:35,534 INFO     __main__: Connected to database.
2026-01-22 14:46:35,540 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 14:46:37,212 INFO     __main__: Connected to database.
2026-01-22 14:46:37,212 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 14:46:38,894 INFO     __main__: Connected to database.
2026-01-22 14:46:38,897 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 14:46:40,348 INFO     __main__: Connected to database.
2026-01-22 14:46:40,352 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 14:46:41,690 INFO     __main__: Connected to database.
2026-01-22 14:46:41,690 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 14:46:47,571 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 14:46:47,657 INFO     __main__: Connected to database.
2026-01-22 14:46:47,657 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 14:46:47,657 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-22 14:46:47,657 INFO     __main__: Retrieved 1 rows.
2026-01-22 14:46:47,657 INFO     __main__: Found 1 project IDs
2026-01-22 14:46:47,657 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-22 14:46:47,765 INFO     __main__: Retrieved 49 rows.
2026-01-22 14:46:47,765 INFO     __main__: Found 49 child rows
2026-01-22 14:46:47,766 INFO     __main__: Normal processing (no transitivity)
2026-01-22 14:46:47,766 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-22 14:46:47,895 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-22 14:46:47,895 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-22 14:46:47,895 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-22 14:46:47,902 INFO     __main__: No custom rules provided in Generate Mapping tab, using system rules only
2026-01-22 14:46:47,981 INFO     __main__: Connected to database.
2026-01-22 14:46:47,981 INFO     pii_core: Loading PII detection rules from database
2026-01-22 14:46:47,981 INFO     pii_database: Using provided database connection for PII rules
2026-01-22 14:46:47,981 INFO     pii_database: Loading PII detection rules from database
2026-01-22 14:46:47,997 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-22 14:46:47,997 INFO     pii_core: Loaded 17 PII categories, 208 patterns
2026-01-22 14:46:47,997 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-22 14:46:48,010 INFO     pii_core: PII Detection Orchestrator initialized
2026-01-22 14:46:48,010 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-22 14:46:48,010 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-22 14:46:48,010 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-22 14:46:48,010 INFO     pii_core: ================================================================================
2026-01-22 14:46:48,013 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-22 14:46:48,013 INFO     pii_core: ================================================================================
2026-01-22 14:46:48,013 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-22 14:46:48,013 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-22 14:46:48,146 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-22 14:46:48,184 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-22 14:46:48,396 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-22 14:46:48,397 INFO     pii_core: Processing 1 sheet(s)
2026-01-22 14:46:48,397 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-22 14:46:48,399 INFO     pii_core: Phase 1: Rule-based classification
2026-01-22 14:46:48,418 INFO     pii_core: Rule-based: 7 PII, 8 non-PII, 15 ambiguous
2026-01-22 14:46:48,418 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-22 14:46:48,420 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 14:46:54,106 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-22 14:46:54,112 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 14:46:58,539 INFO     utils.gemini_client: Successfully processed batch with 3 rows
2026-01-22 14:46:58,580 INFO     pii_core: ================================================================================
2026-01-22 14:46:58,582 INFO     pii_core: COMPLETE: 7/30 PII fields found
2026-01-22 14:46:58,582 INFO     pii_core: ================================================================================
2026-01-22 14:46:58,582 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 7/30 PII fields detected
2026-01-22 14:53:49,863 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-22 14:53:49,863 WARNING  __main__: Could not delete CNV24 - ElementEntry.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV24 - ElementEntry.xlsx'
2026-01-22 14:53:49,868 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-22 14:55:57,288 INFO     root: ================================================================================
2026-01-22 14:55:57,288 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-22 14:55:57,844 INFO     __main__: Connected to database.
2026-01-22 14:55:57,853 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 14:55:58,163 INFO     __main__: Connected to database.
2026-01-22 14:55:58,163 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-22 14:56:04,572 INFO     __main__: Connected to database.
2026-01-22 14:56:04,581 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 14:56:05,976 INFO     __main__: Connected to database.
2026-01-22 14:56:05,992 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 14:56:07,405 INFO     __main__: Connected to database.
2026-01-22 14:56:07,408 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 14:56:08,747 INFO     __main__: Connected to database.
2026-01-22 14:56:08,747 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 14:56:12,655 INFO     __main__: Connected to database.
2026-01-22 14:56:12,659 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 14:56:19,112 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 14:56:19,219 INFO     __main__: Connected to database.
2026-01-22 14:56:19,221 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 14:56:19,223 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-22 14:56:19,226 INFO     __main__: Retrieved 1 rows.
2026-01-22 14:56:19,226 INFO     __main__: Found 1 project IDs
2026-01-22 14:56:19,226 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-22 14:56:19,251 INFO     __main__: Retrieved 49 rows.
2026-01-22 14:56:19,251 INFO     __main__: Found 49 child rows
2026-01-22 14:56:19,251 INFO     __main__: Normal processing (no transitivity)
2026-01-22 14:56:19,251 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-22 14:56:19,362 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-22 14:56:19,362 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-22 14:56:19,362 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-22 14:56:19,373 INFO     __main__: No custom rules provided in Generate Mapping tab, using system rules only
2026-01-22 14:56:19,471 INFO     __main__: Connected to database.
2026-01-22 14:56:19,471 INFO     pii_core: Loading PII detection rules from database
2026-01-22 14:56:19,471 INFO     pii_database: Using provided database connection for PII rules
2026-01-22 14:56:19,471 INFO     pii_database: Loading PII detection rules from database
2026-01-22 14:56:19,494 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-22 14:56:19,495 INFO     pii_core: Loaded 17 PII categories, 208 patterns
2026-01-22 14:56:19,496 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-22 14:56:19,498 INFO     pii_core: PII Detection Orchestrator initialized
2026-01-22 14:56:19,498 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-22 14:56:19,500 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-22 14:56:19,500 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-22 14:56:19,501 INFO     pii_core: ================================================================================
2026-01-22 14:56:19,502 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-22 14:56:19,503 INFO     pii_core: ================================================================================
2026-01-22 14:56:19,506 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-22 14:56:19,526 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-22 14:56:19,741 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-22 14:56:19,760 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-22 14:56:19,791 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-22 14:56:19,791 INFO     pii_core: Processing 1 sheet(s)
2026-01-22 14:56:19,791 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-22 14:56:19,791 INFO     pii_core: Phase 1: Rule-based classification
2026-01-22 14:56:19,811 INFO     pii_core: Rule-based: 7 PII, 8 non-PII, 15 ambiguous
2026-01-22 14:56:19,811 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-22 14:56:19,812 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 14:56:25,986 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-22 14:56:25,986 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 14:56:29,680 INFO     utils.gemini_client: Successfully processed batch with 3 rows
2026-01-22 14:56:29,745 INFO     pii_core: ================================================================================
2026-01-22 14:56:29,745 INFO     pii_core: COMPLETE: 7/30 PII fields found
2026-01-22 14:56:29,745 INFO     pii_core: ================================================================================
2026-01-22 14:56:29,745 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 7/30 PII fields detected
2026-01-22 15:00:02,679 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-22 15:00:02,681 WARNING  __main__: Could not delete CNV24 - ElementEntry.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV24 - ElementEntry.xlsx'
2026-01-22 15:00:02,681 INFO     __main__: PII detection complete: 1 successful, 0 failed
2026-01-22 15:16:43,776 INFO     root: ================================================================================
2026-01-22 15:16:43,776 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-22 15:16:44,935 INFO     __main__: Connected to database.
2026-01-22 15:16:44,950 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:16:45,425 INFO     __main__: Connected to database.
2026-01-22 15:16:45,430 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-22 15:16:57,011 INFO     __main__: Connected to database.
2026-01-22 15:16:57,011 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:17:00,597 INFO     __main__: Connected to database.
2026-01-22 15:17:00,597 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:17:03,073 INFO     __main__: Connected to database.
2026-01-22 15:17:03,076 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:17:04,362 INFO     __main__: Connected to database.
2026-01-22 15:17:04,370 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:17:07,738 INFO     __main__: Connected to database.
2026-01-22 15:17:07,743 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:17:16,682 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 15:17:16,827 INFO     __main__: Connected to database.
2026-01-22 15:17:16,827 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 15:17:16,828 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-22 15:17:16,833 INFO     __main__: Retrieved 1 rows.
2026-01-22 15:17:16,834 INFO     __main__: Found 1 project IDs
2026-01-22 15:17:16,835 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-22 15:17:16,896 INFO     __main__: Retrieved 49 rows.
2026-01-22 15:17:16,896 INFO     __main__: Found 49 child rows
2026-01-22 15:17:16,897 INFO     __main__: Normal processing (no transitivity)
2026-01-22 15:17:16,897 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-22 15:17:17,154 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-22 15:17:17,154 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-22 15:17:17,170 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-22 15:17:17,186 INFO     __main__: No custom rules provided in Generate Mapping tab, using system rules only
2026-01-22 15:17:17,387 INFO     __main__: Connected to database.
2026-01-22 15:17:17,387 INFO     pii_core: Loading PII detection rules from database
2026-01-22 15:17:17,387 INFO     pii_database: Using provided database connection for PII rules
2026-01-22 15:17:17,387 INFO     pii_database: Loading PII detection rules from database
2026-01-22 15:17:17,416 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-22 15:17:17,416 INFO     pii_core: Loaded 17 PII categories, 208 patterns
2026-01-22 15:17:17,419 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-22 15:17:17,419 INFO     pii_core: PII Detection Orchestrator initialized
2026-01-22 15:17:17,419 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-22 15:17:17,419 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-22 15:17:17,419 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-22 15:17:17,419 INFO     pii_core: ================================================================================
2026-01-22 15:17:17,419 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-22 15:17:17,419 INFO     pii_core: ================================================================================
2026-01-22 15:17:17,419 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-22 15:17:17,434 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-22 15:17:17,614 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-22 15:17:17,650 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-22 15:17:17,734 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-22 15:17:17,736 INFO     pii_core: Processing 1 sheet(s)
2026-01-22 15:17:17,736 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-22 15:17:17,736 INFO     pii_core: Phase 1: Rule-based classification
2026-01-22 15:17:17,741 INFO     pii_core: Rule-based: 7 PII, 8 non-PII, 15 ambiguous
2026-01-22 15:17:17,741 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-22 15:17:17,748 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 15:17:24,838 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-22 15:17:24,838 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 15:17:30,389 INFO     utils.gemini_client: Successfully processed batch with 3 rows
2026-01-22 15:17:30,450 INFO     pii_core: ================================================================================
2026-01-22 15:17:30,450 INFO     pii_core: COMPLETE: 7/30 PII fields found
2026-01-22 15:17:30,450 INFO     pii_core: ================================================================================
2026-01-22 15:17:30,450 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 7/30 PII fields detected
2026-01-22 15:34:53,102 INFO     root: ================================================================================
2026-01-22 15:34:53,102 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-22 15:34:54,237 INFO     __main__: Connected to database.
2026-01-22 15:34:54,278 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:34:54,868 INFO     __main__: Connected to database.
2026-01-22 15:34:54,868 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-22 15:34:58,814 INFO     __main__: Connected to database.
2026-01-22 15:34:58,820 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:35:00,338 INFO     __main__: Connected to database.
2026-01-22 15:35:00,350 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:35:01,799 INFO     __main__: Connected to database.
2026-01-22 15:35:01,803 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:35:03,016 INFO     __main__: Connected to database.
2026-01-22 15:35:03,028 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:35:04,643 INFO     __main__: Connected to database.
2026-01-22 15:35:04,643 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:35:10,126 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 15:35:10,251 INFO     __main__: Connected to database.
2026-01-22 15:35:10,251 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 15:35:10,251 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-22 15:35:10,251 INFO     __main__: Retrieved 1 rows.
2026-01-22 15:35:10,251 INFO     __main__: Found 1 project IDs
2026-01-22 15:35:10,251 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-22 15:35:10,333 INFO     __main__: Retrieved 49 rows.
2026-01-22 15:35:10,333 INFO     __main__: Found 49 child rows
2026-01-22 15:35:10,333 INFO     __main__: Normal processing (no transitivity)
2026-01-22 15:35:10,344 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-22 15:35:10,542 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-22 15:35:10,542 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-22 15:35:10,545 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-22 15:35:10,555 INFO     __main__: No custom rules provided in Generate Mapping tab, using system rules only
2026-01-22 15:35:10,683 INFO     __main__: Connected to database.
2026-01-22 15:35:10,683 INFO     pii_core: Loading PII detection rules from database
2026-01-22 15:35:10,683 INFO     pii_database: Using provided database connection for PII rules
2026-01-22 15:35:10,691 INFO     pii_database: Loading PII detection rules from database
2026-01-22 15:35:10,691 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-22 15:35:10,691 INFO     pii_core: Loaded 17 PII categories, 208 patterns
2026-01-22 15:35:10,691 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-22 15:35:10,707 INFO     pii_core: PII Detection Orchestrator initialized
2026-01-22 15:35:10,707 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-22 15:35:10,707 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-22 15:35:10,707 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-22 15:35:10,707 INFO     pii_core: ================================================================================
2026-01-22 15:35:10,707 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-22 15:35:10,707 INFO     pii_core: ================================================================================
2026-01-22 15:35:10,707 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-22 15:35:10,723 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-22 15:35:10,865 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-22 15:35:10,897 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-22 15:35:10,976 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-22 15:35:10,976 INFO     pii_core: Processing 1 sheet(s)
2026-01-22 15:35:10,976 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-22 15:35:10,976 INFO     pii_core: Phase 1: Rule-based classification
2026-01-22 15:35:10,986 INFO     pii_core: Rule-based: 7 PII, 8 non-PII, 15 ambiguous
2026-01-22 15:35:10,987 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-22 15:35:10,987 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 15:35:18,802 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-22 15:35:18,802 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 15:35:21,910 INFO     utils.gemini_client: Successfully processed batch with 3 rows
2026-01-22 15:35:21,979 INFO     pii_core: ================================================================================
2026-01-22 15:35:21,979 INFO     pii_core: COMPLETE: 7/30 PII fields found
2026-01-22 15:35:21,979 INFO     pii_core: ================================================================================
2026-01-22 15:35:21,979 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 7/30 PII fields detected
2026-01-22 15:42:56,036 INFO     root: ================================================================================
2026-01-22 15:42:56,037 INFO     root: Logging initialized — writing to c:\Users\L10319\Desktop\MapMaestro\MapMaestro-develop\MapMaestroV8\MapMaestro.log
2026-01-22 15:42:57,154 INFO     __main__: Connected to database.
2026-01-22 15:42:57,173 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:42:57,538 INFO     __main__: Connected to database.
2026-01-22 15:42:57,538 INFO     __main__: Fetched 226 rows from parenttable.
2026-01-22 15:43:24,332 INFO     __main__: Connected to database.
2026-01-22 15:43:24,348 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:43:25,798 INFO     __main__: Connected to database.
2026-01-22 15:43:25,806 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:43:27,006 INFO     __main__: Connected to database.
2026-01-22 15:43:27,018 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:43:28,340 INFO     __main__: Connected to database.
2026-01-22 15:43:28,354 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:43:30,141 INFO     __main__: Connected to database.
2026-01-22 15:43:30,145 INFO     __main__: Fetched 34 Workday-Oracle mapping rows from map_maestro.workdayoraclemap
2026-01-22 15:43:35,851 INFO     __main__: Filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 15:43:36,064 INFO     __main__: Connected to database.
2026-01-22 15:43:36,064 INFO     __main__: Building projectid query with filters: {'legacysystem': ['Lawson'], 'targetsystem': ['Oracle Cloud'], 'projectname': ['Denver Public Schools'], 'domainname': ['Payroll'], 'subdomainname': ['Element Entry'], 'filename': []}
2026-01-22 15:43:36,064 INFO     __main__: ProjectID Query: SELECT DISTINCT projectid FROM map_maestro.parentprojectdetails WHERE legacysystem IN (%s) AND targetsystem IN (%s) AND projectname IN (%s) AND domainname IN (%s) AND subdomainname IN (%s) Params: ['Lawson', 'Oracle Cloud', 'Denver Public Schools', 'Payroll', 'Element Entry']
2026-01-22 15:43:36,070 INFO     __main__: Retrieved 1 rows.
2026-01-22 15:43:36,070 INFO     __main__: Found 1 project IDs
2026-01-22 15:43:36,077 INFO     __main__: childattributemappingdetails Query: SELECT c.*, p.filename, p.targetsystem, p.legacysystem, p.projectname, p.domainname, p.subdomainname FROM map_maestro.childattributemappingdetails c JOIN map_maestro.parentprojectdetails p ON c.projectid = p.projectid WHERE c.projectid IN (%s) Params: [4]
2026-01-22 15:43:36,150 INFO     __main__: Retrieved 49 rows.
2026-01-22 15:43:36,152 INFO     __main__: Found 49 child rows
2026-01-22 15:43:36,152 INFO     __main__: Normal processing (no transitivity)
2026-01-22 15:43:36,152 INFO     __main__: PII Field Detection: Step 1 - Generating mapping spec files
2026-01-22 15:43:36,369 INFO     __main__: Exported summarized Excel file: CNV24 - ElementEntry.xlsx
2026-01-22 15:43:36,369 INFO     __main__: Generated mapping file: CNV24 - ElementEntry.xlsx
2026-01-22 15:43:36,374 INFO     __main__: PII Field Detection: Step 2 - Running PII detection on 1 files
2026-01-22 15:43:36,379 INFO     __main__: No custom rules provided in Generate Mapping tab, using system rules only
2026-01-22 15:43:36,480 INFO     __main__: Connected to database.
2026-01-22 15:43:36,480 INFO     pii_core: Loading PII detection rules from database
2026-01-22 15:43:36,480 INFO     pii_database: Using provided database connection for PII rules
2026-01-22 15:43:36,480 INFO     pii_database: Loading PII detection rules from database
2026-01-22 15:43:36,489 INFO     pii_database: Loaded 17 PII categories, 43 non-PII patterns
2026-01-22 15:43:36,489 INFO     pii_core: Loaded 17 PII categories, 208 patterns
2026-01-22 15:43:36,489 INFO     utils.gemini_client: Gemini PII Detector initialized with model: gemini-2.5-flash
2026-01-22 15:43:36,489 INFO     pii_core: PII Detection Orchestrator initialized
2026-01-22 15:43:36,489 INFO     pii_core: - Rule-based detector: Ready (using provided DB connection)
2026-01-22 15:43:36,489 INFO     pii_core: - AI detector: Gemini, batch size: 12
2026-01-22 15:43:36,489 INFO     __main__: Processing file 1/1: CNV24 - ElementEntry.xlsx
2026-01-22 15:43:36,489 INFO     pii_core: ================================================================================
2026-01-22 15:43:36,489 INFO     pii_core: MULTI-SHEET PII DETECTION
2026-01-22 15:43:36,489 INFO     pii_core: ================================================================================
2026-01-22 15:43:36,489 INFO     pii_core: Reading Excel file: 'CNV24 - ElementEntry.xlsx'
2026-01-22 15:43:36,506 INFO     pii_core: Excel file has 3 sheet(s)
2026-01-22 15:43:36,637 WARNING  pii_core: Sheet 'Summary' skipped - no field name column found
2026-01-22 15:43:36,665 WARNING  pii_core: Sheet 'ElementEntry' skipped - no field name column found
2026-01-22 15:43:36,745 INFO     pii_core: Sheet 'ElementEntryValue' validated (header row: 6, 30 data rows)
2026-01-22 15:43:36,745 INFO     pii_core: Processing 1 sheet(s)
2026-01-22 15:43:36,745 INFO     pii_core: Processing sheet 1/1: 'ElementEntryValue'
2026-01-22 15:43:36,745 INFO     pii_core: Phase 1: Rule-based classification
2026-01-22 15:43:36,761 INFO     pii_core: Rule-based: 7 PII, 8 non-PII, 15 ambiguous
2026-01-22 15:43:36,761 INFO     pii_core: Phase 2: Gemini API detection (15 fields)
2026-01-22 15:43:36,761 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 15:43:45,472 INFO     utils.gemini_client: Successfully processed batch with 12 rows
2026-01-22 15:43:45,472 INFO     utils.gemini_client: Sending batch to Gemini API (attempt 1/3)...
2026-01-22 15:43:48,547 INFO     utils.gemini_client: Successfully processed batch with 3 rows
2026-01-22 15:43:48,612 INFO     pii_core: ================================================================================
2026-01-22 15:43:48,612 INFO     pii_core: COMPLETE: 7/30 PII fields found
2026-01-22 15:43:48,612 INFO     pii_core: ================================================================================
2026-01-22 15:43:48,612 INFO     __main__: Completed CNV24 - ElementEntry.xlsx: 7/30 PII fields detected
2026-01-22 15:56:21,459 INFO     __main__: Cleaning up: Deleting mapping files, keeping only PII results
2026-01-22 15:56:21,479 WARNING  __main__: Could not delete CNV24 - ElementEntry.xlsx: [WinError 32] The process cannot access the file because it is being used by another process: 'CNV24 - ElementEntry.xlsx'
2026-01-22 15:56:21,479 INFO     __main__: PII detection complete: 1 successful, 0 failed
